(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28a4ec0d"],{"18e9":function(e,t,a){"use strict";a("917e")},"190c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{staticClass:"max-height"},[a("el-col",{staticClass:"max-height",attrs:{span:5}},[a("div",{staticClass:"max-height left-side"},[a("div",{staticClass:"operate-box nowrap flex justify-start padding-right-10"},[a("div",[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"sys:code:update",expression:"'sys:code:update'"}],attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.btnClick("add")}}},[e._v(" 添加 ")]),a("el-button",{directives:[{name:"has",rawName:"v-has",value:"sys:code:delete",expression:"'sys:code:delete'"}],attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.btnClick("delete")}}},[e._v(" 删除 ")]),a("el-input",{staticStyle:{width:"180px","margin-left":"10px"},attrs:{placeholder:"输入关键字进行过滤",clearable:""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1)]),a("div",{staticClass:"tree-title"},[e._v("字典树")]),a("div",{staticClass:"overflow-auto"},[a("basic-tree",{directives:[{name:"show",rawName:"v-show",value:e.treeData&&e.treeData.length>0,expression:"treeData && treeData.length > 0"}],attrs:{data:e.treeData,defaultExpandedKeys:e.defaultExpandedKeys,filterText:e.filterText},on:{click:e.treeNodeClick,expandedChange:e.expandedChange}})],1)])]),a("el-col",{staticClass:"max-height",attrs:{span:19}},[a("div",{staticClass:"max-height flex-column"},[a("el-card",{staticClass:"box-card max-height"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(e.title.textMap[e.title.status]))])]),a("div",{staticClass:"form-class"},[a("el-form",{ref:"form",attrs:{model:e.model,rules:e.rules,"label-width":"6rem","auto-complete":"off","label-position":"right"}},[a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-radio-group",{on:{change:e.typeRadioChange},model:{value:e.model.type,callback:function(t){e.$set(e.model,"type",t)},expression:"model.type"}},e._l(e.select.type,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(" "+e._s(t.label||t.name)+" ")])})),1)],1),a("el-form-item",{attrs:{label:"父节点名",prop:"parentName"}},[a("el-input",{attrs:{maxlength:"50",type:"text",placeholder:"请选择父节点",disabled:"",readonly:""},model:{value:e.model.parentName,callback:function(t){e.$set(e.model,"parentName",t)},expression:"model.parentName"}})],1),a("el-form-item",{attrs:{label:"字典标识",prop:"mark"}},[a("el-input",{attrs:{maxlength:"50",type:"text",placeholder:"码值唯一标识, 例如，SEX、SEX_1、SEX_2",clearable:""},model:{value:e.model.mark,callback:function(t){e.$set(e.model,"mark",t)},expression:"model.mark"}})],1),"2"==e.model.type?a("el-form-item",{attrs:{label:"码值",prop:"valueId"}},[a("el-input",{attrs:{maxlength:"50",type:"text",placeholder:"码值 的数字表示，例如：1，2，3、sex",clearable:""},model:{value:e.model.valueId,callback:function(t){e.$set(e.model,"valueId",t)},expression:"model.valueId"}})],1):e._e(),a("el-form-item",{attrs:{label:"码值名",prop:"name"}},[a("el-input",{attrs:{maxlength:"50",type:"text",placeholder:"码值的中文表示,例如：是、否",clearable:""},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),a("el-form-item",{attrs:{label:"排序号",prop:"sort"}},[a("el-input-number",{attrs:{min:1,maxlength:"50",type:"text",placeholder:"请输入排序号",clearable:""},model:{value:e.model.sort,callback:function(t){e.$set(e.model,"sort",t)},expression:"model.sort"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"remark"}},[a("el-input",{attrs:{maxlength:"50",autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"请输入描述",clearable:""},model:{value:e.model.remark,callback:function(t){e.$set(e.model,"remark",t)},expression:"model.remark"}})],1)],1)],1),a("div",{directives:[{name:"has",rawName:"v-has",value:"sys:code:update",expression:"'sys:code:update'"}],staticClass:"btn-list flex text-right"},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"primary"},on:{click:e.submit}},[e._v(" 提交 ")]),a("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置")])],1)])],1)])],1)],1)},i=[],r=a("1da1"),l=(a("96cf"),a("b0c0"),a("4de4"),a("d81d"),a("a15b"),a("159b"),a("b64b"),a("7db0"),a("caad"),a("2532"),a("60f9")),s=(a("3f19"),a("0779")),o={name:"",components:{BasicTree:l["default"],DictSelectTag:s["default"]},props:{},data:function(){return{loading:!1,initLoadOver:!1,treeData:[],baseData:[],filterText:"",select:{type:[{value:"1",name:"目录"},{value:"2",name:"字典码"}],open:[{value:"true",name:"是"},{value:"false",name:"否"}]},model:{parentId:"",id:"",type:"",parentName:"",mark:"",valueId:"",name:"",sort:"",open:"",remark:""},rules:{parentName:[{required:!0,trigger:"change",message:"请选择父节点"}],mark:[{required:!0,trigger:"change",message:"请输入字典标识"}],valueId:[{required:!0,trigger:"change",message:"请输入码值"}],name:[{required:!0,trigger:"change",message:"请输入码值名"}],sort:[{required:!1,trigger:"change",message:"请输入排序号"}],remark:[{required:!1,trigger:"change",message:"请输入描述"}]},defaultExpandAll:!1,defaultExpandedKeys:[],codeData:null,typeRadioValue:null,title:{status:"create",textMap:{update:"修改字典",create:"新增字典"}},url:{tree:"/sys/code/codeTree",delete:"/sys/code/delete",save:"/sys/code/save",update:"/sys/code/update"}}},watch:{},computed:{},methods:{expandedChange:function(e){this.defaultExpandedKeys=e},btnClick:function(e){var t={add:{name:"添加",msg:"请选择父节点！"},delete:{name:"删除",msg:"请选择部门节点！"}},a=t[e]["msg"];if(this.codeData)switch(e){case"add":this.title.status="create",this.initForm();break;case"delete":this.delete();default:break}else this.$sweetAlert.warnWithTimer(a)},delete:function(){var e=this,t="确定要删除【"+this.codeData.name+"】,以及子级字典?";this.$confirm(t,"操作提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=e.url.delete,a=e.codeData.id,n=[],i=e.baseData.filter((function(e){return e.parentId==a}));i.length>0&&(n=i.map((function(e){return e.id}))),n.push(a);var r=n.join(","),l={id:r},s="post";e.$api.httpAction(t,l,s).then((function(t){0==t.code?(e.$sweetAlert.successWithTimer(t.msg),e.getTreeData(),e.codeData=null,e.title.status="create",e.initForm()):e.$sweetAlert.errorWithTimer(t.msg)})).catch((function(){e.$sweetAlert.errorWithTimer("error")}))})).catch((function(){}))},initForm:function(){var e=this;Object.keys(this.model).forEach((function(t){return e.model[t]=""})),this.$nextTick((function(){if(e.$refs["form"].resetFields(),e.model.open="true",e.model.type="1",e.codeData)if("create"==e.title.status){var t=JSON.parse(JSON.stringify(e.codeData));e.model.parentId=t.id,e.getParentNameById()}else"update"==e.title.status&&e.setCodeData();null!=e.typeRadioValue&&(e.model.type=e.typeRadioValue)}))},getParentNameById:function(){var e=this,t=JSON.parse(JSON.stringify(this.baseData)),a=t.find((function(t){return t.id==e.model.parentId}));this.model.parentName=a?a.name:"无"},submit:function(){var e=this;this.$refs.form.validate((function(t){if(t){e.loading=!0;var a=Object.assign({},e.model);a.value=a.valueId,delete a.valueId;var n=e.url.save;a.id&&(n=e.url.update);var i="post";e.$api.httpAction(n,a,i).then((function(t){e.loading=!1,200==t.code?(e.$sweetAlert.successWithTimer(t.msg),a.id||(e.defaultExpandedKeys.push(t.data.id),e.typeRadioValue=a.type,e.initForm()),e.getTreeData()):e.$sweetAlert.errorWithTimer(t.msg)}))}}))},reset:function(){this.initForm()},typeRadioChange:function(e){var t=this;this.$nextTick((function(){t.typeRadioValue=e}))},treeNodeClick:function(e){this.codeData=e,this.setCodeData()},setCodeData:function(){var e=this,t=JSON.parse(JSON.stringify(this.codeData));Object.keys(this.model).map((function(a){return e.model[a]=t[a]})),this.title.status="update",this.getParentNameById()},getTreeData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$api.getAction(e.url.tree,{});case 3:a=t.sent,n=a.treeData,n.forEach((function(e){e.valueId=e.value||""})),e.baseData=n,e.treeData=e.setTreeData(n),t.next=12;break;case 10:t.prev=10,t.t0=t["catch"](0);case 12:case"end":return t.stop()}}),t,null,[[0,10]])})))()},resetDeleteCodeTree:function(e){this.baseData=this.baseData.filter((function(t){return!e.includes(t.id)}));var t=JSON.parse(JSON.stringify(this.baseData));this.treeData=this.setTreeData(t)},setTreeData:function(e){var t=e.filter((function(e){return"0"==e.parentId}));this.initLoadOver||(this.defaultExpandedKeys=t.map((function(e){return e.id})),this.initLoadOver=!0),e.map((function(e){return e.label=e.name,e}));var a=function t(a){a.forEach((function(a){var n=e.filter((function(e){return e.parentId==a.id}));a.children=n,n.length?(a.elIcon="folder",t(a.children)):a.elIcon="document"}))};return a(t),t}},created:function(){this.getTreeData(),this.initForm()},mounted:function(){}},d=o,c=(a("e934"),a("2877")),u=Object(c["a"])(d,n,i,!1,null,"0bfb4e90",null);t["default"]=u.exports},"3f19":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("5530"),i=(a("a9e3"),a("caad"),a("d3b7"),a("25f0"),a("7db0"),a("159b"),a("a434"),{data:function(){return{table:{show:!0,data:[],column:[],loading:!1,selection:[],radio:""},page:{pageNum:1,pageSize:Number("20"),total:0}}},created:function(){},methods:{cellClick:function(e,t){var a=t.property,i=t.type,r=["oper"];"selection"===i||r.includes(a)||(this.role=Object(n["a"])(Object(n["a"])({},this.role),{},{data:e,show:!0}))},currentChange:function(e){this.page=Object(n["a"])(Object(n["a"])({},this.page),{},{pageNum:e}),this.queryList()},sizeChange:function(e){this.$store.dispatch("settings/changeSetting",{key:"pageSize",value:e.toString()}),this.page=Object(n["a"])(Object(n["a"])({},this.page),{},{pageSize:e}),this.queryList()},selection:function(e){e.length?this.show=Object(n["a"])(Object(n["a"])({},this.show),{},{batch:!0}):this.show=Object(n["a"])(Object(n["a"])({},this.show),{},{batch:!1}),this.table=Object(n["a"])(Object(n["a"])({},this.table),{},{selection:e})},selectChange:function(e,t){var a=this;e.find((function(e){return a.getDataId(e)===a.getDataId(t)}))?t.children&&t.children.forEach((function(t){a.$refs.foxTable.toggleRowSelection(t,!0),e.push(t),t.children&&a.selectChange(e,t)})):this.toggleRowSelection(e,t)},selectAllChange:function(e){var t=this;e&&e.length===this.table.data.length?e.forEach((function(a){t.selectChange(e,a)})):this.$refs.foxTable.clearSelection(),e.length?this.show=Object(n["a"])(Object(n["a"])({},this.show),{},{batch:!0}):this.show=Object(n["a"])(Object(n["a"])({},this.show),{},{batch:!1}),this.table=Object(n["a"])(Object(n["a"])({},this.table),{},{selection:e})},selectionChangeHandler:function(e){if(e&&e.length>1){var t=e[0].id?"id":"ID";this.selectedUnique(e,t)}e.length?this.show=Object(n["a"])(Object(n["a"])({},this.show),{},{batch:!0}):this.show=Object(n["a"])(Object(n["a"])({},this.show),{},{batch:!1}),this.table=Object(n["a"])(Object(n["a"])({},this.table),{},{selection:e})},toggleRowSelection:function(e,t){var a=this;t.children&&t.children.forEach((function(t){a.$refs.foxTable.toggleRowSelection(t,!1),t.children&&a.toggleRowSelection(e,t)}))},getDataId:function(e){return e["id"]||e["ID"]},selectedUnique:function(e,t){for(var a=0;a<e.length;a++)for(var n=a+1;n<e.length;n++)e[a][t]==e[n][t]&&(e.splice(n,1),n--)}}})},"60f9":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tree",{ref:"tree",attrs:{data:e.data,props:e.defaultProps,"default-expand-all":e.defaultExpandAll,"default-expanded-keys":e.defaultExpandedKeys,"show-checkbox":e.showCheckbox,"check-strictly":e.checkStrictly,"default-checked-keys":e.defaultCheckedKeys,"expand-on-click-node":e.expandOnClickNode,"filter-node-method":e.filterNode,draggable:e.draggable,"allow-drop":e.allowDrop,lazy:e.lazy,load:e.loadNode,accordion:"","node-key":"id","render-content":e.renderContent},on:{"node-drag-start":e.handleDragStart,"node-drag-enter":e.handleDragEnter,"node-drop":e.handleDrop,"node-click":e.handleNodeClick,"node-expand":e.nodeExpand,"node-collapse":e.nodeCollapse,"check-change":e.handleClick}})],1)},i=[],r=(a("4de4"),a("99af"),a("a434"),{name:"",components:{},props:{data:{type:Array,default:[]},defaultExpandAll:{type:Boolean,default:!1},defaultExpandedKeys:{type:Array,default:function(){return[]}},defaultCheckedKeys:{type:Array,default:function(){return[]}},showCheckbox:{type:Boolean,default:!1},expandOnClickNode:{type:Boolean,default:!1},highlightCurrent:{type:Boolean,default:!0},checkStrictly:{type:Boolean,default:!1},singleCheck:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},lazy:{type:Boolean,default:!1},getHalfCheckedKeys:{type:Boolean,default:!1},filterText:{type:String,default:""}},data:function(){return{defaultProps:{children:"children",label:"label"},expandedList:[]}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},computed:{},methods:{renderContent:function(e,t){var a=t.node,n=t.data;t.store;return e("span",[e("i",{class:"el-icon-"+n.elIcon}),e("span",[" ",a.label])])},handleNodeClick:function(e){this.$emit("click",e)},setCheckedKeys:function(e){this.$refs.tree.setCheckedKeys(e)},getCheckedKeys:function(){var e=this.$refs.tree.getCheckedKeys();this.getHalfCheckedKeys&&(e=this.$refs.tree.getCheckedKeys().concat(this.$refs.tree.getHalfCheckedKeys())),this.$emit("keys",e)},nodeExpand:function(e){this.expandedList.push(e.id),this.$emit("expandedChange",this.expandedList)},nodeCollapse:function(e){this.expandedList.splice(this.expandedList.indexOf(e.id),1),this.$emit("expandedChange",this.expandedList)},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},handleClick:function(e,t,a){this.singleCheck&&t&&this.$refs.tree.setCheckedNodes([e]),this.$emit("checkChange",{data:e,checked:t,node:a})},loadNode:function(e,t){this.$emit("loadNode",e,t)},allowDrop:function(e,t,a){if("inner"==a)return!0},handleDragStart:function(e,t){this.$emit("nodeDragStart",{node:e})},handleDragEnter:function(e,t,a){this.$emit("nodeDragEnter",{draggingNode:e,dropNode:t})},handleDrop:function(e,t,a,n){this.$emit("nodeDrop",{draggingNode:e,dropNode:t,dropType:a})}},created:function(){this.expandedList=this.defaultExpandedKeys},mounted:function(){}}),l=r,s=(a("18e9"),a("2877")),o=Object(s["a"])(l,n,i,!1,null,"4dfff174",null);t["default"]=o.exports},7232:function(e,t,a){},"917e":function(e,t,a){},e934:function(e,t,a){"use strict";a("7232")}}]);