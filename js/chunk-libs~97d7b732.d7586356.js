(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-libs~97d7b732"],{"030f":function(n,t,e){(function(n){(function(){"use strict";var t=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},e=function(n){return function(e){return t(e)===n}},o=function(n){return function(t){return typeof t===n}},r=function(n){return function(t){return n===t}},i=e("string"),u=e("object"),a=e("array"),c=o("boolean"),s=r(void 0),f=function(n){return null===n||void 0===n},l=function(n){return!f(n)},d=o("function"),m=o("number"),g=function(n,t){if(a(n)){for(var e=0,o=n.length;e<o;++e)if(!t(n[e]))return!1;return!0}return!1},p=function(){},v=function(n){return function(){return n()}},h=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return n(t.apply(null,e))}},b=function(n,t){return function(e){return n(t(e))}},y=function(n){return function(){return n}},x=function(n){return n};function w(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=t.concat(e);return n.apply(null,r)}}var S=function(n){return function(t){return!n(t)}},k=function(n){return function(){throw new Error(n)}},C=y(!1),O=y(!0),_=tinymce.util.Tools.resolve("tinymce.ThemeManager"),T=function(){return T=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var r in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},T.apply(this,arguments)};function E(n,t){var e={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&t.indexOf(o)<0&&(e[o]=n[o]);if(null!=n&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(n);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(e[o[r]]=n[o[r]])}return e}function D(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var o=Array(n),r=0;for(t=0;t<e;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}var B,A=function(){return M},M=function(){var n=function(n){return n.isNone()},t=function(n){return n()},e=function(n){return n},o={fold:function(n,t){return n()},is:C,isSome:C,isNone:O,getOr:e,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:y(null),getOrUndefined:y(void 0),or:e,orThunk:t,map:A,each:p,bind:A,exists:C,forall:O,filter:A,equals:n,equals_:n,toArray:function(){return[]},toString:y("none()")};return o}(),F=function(n){var t=y(n),e=function(){return r},o=function(t){return t(n)},r={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:O,isNone:C,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return F(t(n))},each:function(t){t(n)},bind:o,exists:o,forall:o,filter:function(t){return t(n)?r:M},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(C,(function(t){return e(n,t)}))}};return r},I=function(n){return null===n||void 0===n?M:F(n)},R={some:F,none:A,from:I},V=Array.prototype.slice,P=Array.prototype.indexOf,H=Array.prototype.push,z=function(n,t){return P.call(n,t)},N=function(n,t){var e=z(n,t);return-1===e?R.none():R.some(e)},L=function(n,t){return z(n,t)>-1},j=function(n,t){for(var e=0,o=n.length;e<o;e++){var r=n[e];if(t(r,e))return!0}return!1},U=function(n,t){for(var e=[],o=0;o<n;o++)e.push(t(o));return e},W=function(n,t){for(var e=[],o=0;o<n.length;o+=t){var r=V.call(n,o,o+t);e.push(r)}return e},G=function(n,t){for(var e=n.length,o=new Array(e),r=0;r<e;r++){var i=n[r];o[r]=t(i,r)}return o},X=function(n,t){for(var e=0,o=n.length;e<o;e++){var r=n[e];t(r,e)}},Y=function(n,t){for(var e=n.length-1;e>=0;e--){var o=n[e];t(o,e)}},q=function(n,t){for(var e=[],o=[],r=0,i=n.length;r<i;r++){var u=n[r],a=t(u,r)?e:o;a.push(u)}return{pass:e,fail:o}},K=function(n,t){for(var e=[],o=0,r=n.length;o<r;o++){var i=n[o];t(i,o)&&e.push(i)}return e},J=function(n,t,e){return Y(n,(function(n){e=t(e,n)})),e},$=function(n,t,e){return X(n,(function(n){e=t(e,n)})),e},Q=function(n,t,e){for(var o=0,r=n.length;o<r;o++){var i=n[o];if(t(i,o))return R.some(i);if(e(i,o))break}return R.none()},Z=function(n,t){return Q(n,t,C)},nn=function(n,t){for(var e=0,o=n.length;e<o;e++){var r=n[e];if(t(r,e))return R.some(e)}return R.none()},tn=function(n){for(var t=[],e=0,o=n.length;e<o;++e){if(!a(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);H.apply(t,n[e])}return t},en=function(n,t){return tn(G(n,t))},on=function(n,t){for(var e=0,o=n.length;e<o;++e){var r=n[e];if(!0!==t(r,e))return!1}return!0},rn=function(n){var t=V.call(n,0);return t.reverse(),t},un=function(n,t){return K(n,(function(n){return!L(t,n)}))},an=function(n,t){for(var e={},o=0,r=n.length;o<r;o++){var i=n[o];e[String(i)]=t(i,o)}return e},cn=function(n,t){var e=V.call(n,0);return e.sort(t),e},sn=function(n,t){return t>=0&&t<n.length?R.some(n[t]):R.none()},fn=function(n){return sn(n,0)},ln=function(n){return sn(n,n.length-1)},dn=d(Array.from)?Array.from:function(n){return V.call(n)},mn=function(n,t){for(var e=0;e<n.length;e++){var o=t(n[e],e);if(o.isSome())return o}return R.none()},gn=function(n){var t=function(t){return n===t},e=function(t){return gn(n)},o=function(t){return gn(n)},r=function(t){return gn(t(n))},i=function(t){return gn(n)},u=function(t){t(n)},a=function(t){return t(n)},c=function(t,e){return e(n)},s=function(t){return t(n)},f=function(t){return t(n)},l=function(){return R.some(n)};return{is:t,isValue:O,isError:C,getOr:y(n),getOrThunk:y(n),getOrDie:y(n),or:e,orThunk:o,fold:c,map:r,mapError:i,each:u,bind:a,exists:s,forall:f,toOptional:l}},pn=function(n){var t=function(n){return n()},e=function(){return k(String(n))()},o=function(n){return n},r=function(n){return n()},i=function(t){return pn(n)},u=function(t){return pn(t(n))},a=function(t){return pn(n)},c=function(t,e){return t(n)};return{is:C,isValue:C,isError:O,getOr:x,getOrThunk:t,getOrDie:e,or:o,orThunk:r,fold:c,map:i,mapError:u,each:p,bind:a,exists:C,forall:O,toOptional:R.none}},vn=function(n,t){return n.fold((function(){return pn(t)}),gn)},hn={value:gn,error:pn,fromOption:vn};(function(n){n[n["Error"]=0]="Error",n[n["Value"]=1]="Value"})(B||(B={}));var bn=function(n,t,e){return n.stype===B.Error?t(n.serror):e(n.svalue)},yn=function(n){var t=[],e=[];return X(n,(function(n){bn(n,(function(n){return e.push(n)}),(function(n){return t.push(n)}))})),{values:t,errors:e}},xn=function(n,t){return n.stype===B.Error?{stype:B.Error,serror:t(n.serror)}:n},wn=function(n,t){return n.stype===B.Value?{stype:B.Value,svalue:t(n.svalue)}:n},Sn=function(n,t){return n.stype===B.Value?t(n.svalue):n},kn=function(n,t){return n.stype===B.Error?t(n.serror):n},Cn=function(n){return{stype:B.Value,svalue:n}},On=function(n){return{stype:B.Error,serror:n}},_n=function(n){return bn(n,hn.error,hn.value)},Tn=function(n){return n.fold(On,Cn)},En={fromResult:Tn,toResult:_n,svalue:Cn,partition:yn,serror:On,bind:Sn,bindError:kn,map:wn,mapError:xn,fold:bn},Dn=Object.keys,Bn=Object.hasOwnProperty,An=function(n,t){for(var e=Dn(n),o=0,r=e.length;o<r;o++){var i=e[o],u=n[i];t(u,i)}},Mn=function(n,t){return Fn(n,(function(n,e){return{k:e,v:t(n,e)}}))},Fn=function(n,t){var e={};return An(n,(function(n,o){var r=t(n,o);e[r.k]=r.v})),e},In=function(n){return function(t,e){n[e]=t}},Rn=function(n,t,e,o){var r={};return An(n,(function(n,r){(t(n,r)?e:o)(n,r)})),r},Vn=function(n,t){var e={};return Rn(n,t,In(e),p),e},Pn=function(n,t){var e=[];return An(n,(function(n,o){e.push(t(n,o))})),e},Hn=function(n,t){for(var e=Dn(n),o=0,r=e.length;o<r;o++){var i=e[o],u=n[i];if(t(u,i,n))return R.some(u)}return R.none()},zn=function(n){return Pn(n,(function(n){return n}))},Nn=function(n,t){return Ln(n,t)?R.from(n[t]):R.none()},Ln=function(n,t){return Bn.call(n,t)},jn=function(n,t){return Ln(n,t)&&void 0!==n[t]&&null!==n[t]},Un=function(n){if(!a(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var t=[],e={};return X(n,(function(o,r){var i=Dn(o);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],c=o[u];if(void 0!==e[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!a(c))throw new Error("case arguments must be an array");t.push(u),e[u]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+i);var a=function(n){var o=Dn(n);if(t.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+o.join(","));var r=on(t,(function(n){return L(o,n)}));if(!r)throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+t.join(", "));return n[u].apply(null,e)};return{fold:function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];if(t.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+t.length);var i=t[r];return i.apply(null,e)},match:a,log:function(n){}}}})),e},Wn={generate:Un},Gn=Object.prototype.hasOwnProperty,Xn=function(n,t){return t},Yn=function(n,t){var e=u(n)&&u(t);return e?Kn(n,t):t},qn=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<t.length;r++){var i=t[r];for(var u in i)Gn.call(i,u)&&(o[u]=n(o[u],i[u]))}return o}},Kn=qn(Yn),Jn=qn(Xn),$n=function(n){var t,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,t=n.apply(null,o)),t}},Qn=Wn.generate([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Zn=function(n){return Qn.defaultedThunk(y(n))},nt=function(n){return Qn.mergeWithThunk(y(n))},tt=Qn.strict,et=Qn.asOption,ot=Qn.defaultedThunk,rt=(Qn.asDefaultedOptionThunk,Qn.mergeWithThunk),it=(Wn.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n){var t=[],e=[];return X(n,(function(n){n.fold((function(n){t.push(n)}),(function(n){e.push(n)}))})),{errors:t,values:e}}),ut=function(n,t){var e={};return An(n,(function(n,o){L(t,o)||(e[o]=n)})),e},at=function(n,t){var e;return e={},e[n]=t,e},ct=function(n){var t={};return X(n,(function(n){t[n.key]=n.value})),t},st=function(n,t){return ut(n,t)},ft=function(n,t){return at(n,t)},lt=function(n){return ct(n)},dt=function(n,t){return 0===n.length?hn.value(t):hn.value(Kn(t,Jn.apply(void 0,n)))},mt=function(n){return hn.error(tn(n))},gt=function(n,t){var e=it(n);return e.errors.length>0?mt(e.errors):dt(e.values,t)},pt=function(n,t){return n.length>0?En.svalue(Kn(t,Jn.apply(void 0,n))):En.svalue(t)},vt=function(n){return h(En.serror,tn)(n)},ht=function(n,t){var e=En.partition(n);return e.errors.length>0?vt(e.errors):pt(e.values,t)},bt=function(n){var t=En.partition(n);return t.errors.length>0?vt(t.errors):En.svalue(t.values)},yt={consolidateObj:ht,consolidateArr:bt},xt=function(n){return u(n)&&Dn(n).length>100?" removed due to size":JSON.stringify(n,null,2)},wt=function(n){var t=n.length>10?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n;return G(t,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))},St=function(n,t){return En.serror([{path:n,getErrorInfo:t}])},kt=function(n,t,e){return St(n,(function(){return'Could not find valid *strict* value for "'+t+'" in '+xt(e)}))},Ct=function(n,t){return St(n,(function(){return'Choice schema did not contain choice key: "'+t+'"'}))},Ot=function(n,t,e){return St(n,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+xt(t)}))},_t=function(n,t){return St(n,(function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"}))},Tt=function(n,t){return St(n,(function(){return t}))},Et=Wn.generate([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Dt=function(n,t,e){return Nn(t,e).fold((function(){return kt(n,e,t)}),En.svalue)},Bt=function(n,t,e){var o=Nn(n,t).fold((function(){return e(n)}),x);return En.svalue(o)},At=function(n,t){return En.svalue(Nn(n,t))},Mt=function(n,t,e){var o=Nn(n,t).map((function(t){return!0===t?e(n):t}));return En.svalue(o)},Ft=function(n,t,e,o){return e.fold((function(e,r,i,u){var a=function(t){var i=u.extract(n.concat([e]),o,t);return En.map(i,(function(n){return at(r,o(n))}))},c=function(t){return t.fold((function(){var n=at(r,o(R.none()));return En.svalue(n)}),(function(t){var i=u.extract(n.concat([e]),o,t);return En.map(i,(function(n){return at(r,o(R.some(n)))}))}))};return function(){return i.fold((function(){return En.bind(Dt(n,t,e),a)}),(function(n){return En.bind(Bt(t,e,n),a)}),(function(){return En.bind(At(t,e),c)}),(function(n){return En.bind(Mt(t,e,n),c)}),(function(n){var o=n(t),r=En.map(Bt(t,e,y({})),(function(n){return Kn(o,n)}));return En.bind(r,a)}))}()}),(function(n,e){var r=e(t);return En.svalue(at(n,o(r)))}))},It=function(n,t,e,o){var r=G(e,(function(e){return Ft(n,t,e,o)}));return yt.consolidateObj(r,{})},Rt=function(n){var t=function(t,e,o){return n().extract(t,e,o)},e=function(){return n().toString()};return{extract:t,toString:e}},Vt=function(n){var t=function(t,e,o){return En.bindError(n(o,e),(function(n){return Tt(t,n)}))},e=function(){return"val"};return{extract:t,toString:e}},Pt=function(n){return Dn(Vn(n,(function(n){return void 0!==n&&null!==n})))},Ht=function(n){var t=zt(n),e=J(n,(function(n,t){return t.fold((function(t){return Kn(n,ft(t,!0))}),y(n))}),{}),o=function(n,o,r){var i=c(r)?[]:Pt(r),u=K(i,(function(n){return!jn(e,n)}));return 0===u.length?t.extract(n,o,r):_t(n,u)};return{extract:o,toString:t.toString}},zt=function(n){var t=function(t,e,o){return It(t,o,n,e)},e=function(){var t=G(n,(function(n){return n.fold((function(n,t,e,o){return n+" -> "+o.toString()}),(function(n,t){return"state("+n+")"}))}));return"obj{\n"+t.join("\n")+"}"};return{extract:t,toString:e}},Nt=function(n){var t=function(t,e,o){var r=G(o,(function(o,r){return n.extract(t.concat(["["+r+"]"]),e,o)}));return yt.consolidateArr(r)},e=function(){return"array("+n.toString()+")"};return{extract:t,toString:e}},Lt=function(n){var t=function(t,e,o){for(var r=[],i=0,u=n;i<u.length;i++){var a=u[i],c=a.extract(t,e,o);if(c.stype===B.Value)return c;r.push(c)}return yt.consolidateArr(r)},e=function(){return"oneOf("+G(n,(function(n){return n.toString()})).join(", ")+")"};return{extract:t,toString:e}},jt=function(n,t){var e=function(t,e){return Nt(Vt(n)).extract(t,x,e)},o=function(n,o,r){var i=Dn(r),u=e(n,i);return En.bind(u,(function(e){var i=G(e,(function(n){return Et.field(n,n,tt(),t)}));return zt(i).extract(n,o,r)}))},r=function(){return"setOf("+t.toString()+")"};return{extract:o,toString:r}},Ut=function(n,t){var e=$n((function(){return t()})),o=function(n,t,o){return e().extract(n,t,o)},r=function(){return e().toString()};return{extract:o,toString:r}},Wt=y(Vt(En.svalue)),Gt=h(Nt,zt),Xt=Et.state,Yt=Et.field,qt=function(n,t,e,o,r){var i=Nn(o,r);return i.fold((function(){return Ot(n,o,r)}),(function(o){return o.extract(n.concat(["branch: "+r]),t,e)}))},Kt=function(n,t){var e=function(e,o,r){var i=Nn(r,n);return i.fold((function(){return Ct(e,n)}),(function(n){return qt(e,o,r,t,n)}))},o=function(){return"chooseOn("+n+"). Possible values: "+Dn(t)};return{extract:e,toString:o}},Jt=Vt(En.svalue),$t=function(n){return Gt(n)},Qt=function(){return Nt(Jt)},Zt=Rt,ne=function(n){return Vt((function(t){return n(t).fold(En.serror,En.svalue)}))},te=function(n,t){return jt((function(t){return En.fromResult(n(t))}),t)},ee=function(n,t,e,o){var r=t.extract([n],e,o);return En.mapError(r,(function(n){return{input:o,errors:n}}))},oe=function(n,t,e){return En.toResult(ee(n,t,x,e))},re=function(n){return n.fold((function(n){throw new Error(ue(n))}),x)},ie=function(n,t,e){return re(oe(n,t,e))},ue=function(n){return"Errors: \n"+wt(n.errors).join("\n")+"\n\nInput object: "+xt(n.input)},ae=function(n,t){return Kt(n,t)},ce=function(n,t){return Kt(n,Mn(t,zt))},se=function(n,t){return Ut(n,t)},fe=y(Jt),le=function(n,t){return Vt((function(e){var o=typeof e;return n(e)?En.svalue(e):En.serror("Expected type: "+t+" but got: "+o)}))},de=le(m,"number"),me=le(i,"string"),ge=le(c,"boolean"),pe=le(d,"function"),ve=function(n){var t=function(n,t){var e=n.next();while(!e.done){if(!t(e.value))return!1;e=n.next()}return!0};if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every((function(t){return ve(n[t])}));case"Map":return t(n.keys(),ve)&&t(n.values(),ve);case"Set":return t(n.keys(),ve);default:return!1}},he=Vt((function(n){return ve(n)?En.svalue(n):En.serror("Expected value to be acceptable for sending via postMessage")})),be=function(n){return ne((function(t){return L(n,t)?hn.value(t):hn.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')}))},ye=function(n){return Yt(n,n,tt(),Wt())},xe=function(n,t){return Yt(n,n,tt(),t)},we=function(n){return xe(n,de)},Se=function(n){return xe(n,me)},ke=function(n,t){return Yt(n,n,tt(),be(t))},Ce=function(n){return xe(n,ge)},Oe=function(n){return xe(n,pe)},_e=function(n,t){return Yt(n,n,et(),Vt((function(e){return En.serror("The field: "+n+" is forbidden. "+t)})))},Te=function(n,t){return Yt(n,n,tt(),zt(t))},Ee=function(n,t){return Yt(n,n,tt(),Gt(t))},De=function(n,t){return Yt(n,n,tt(),Nt(t))},Be=function(n){return Yt(n,n,et(),Wt())},Ae=function(n,t){return Yt(n,n,et(),t)},Me=function(n){return Ae(n,de)},Fe=function(n){return Ae(n,me)},Ie=function(n){return Ae(n,pe)},Re=function(n,t){return Ae(n,Nt(t))},Ve=function(n,t){return Ae(n,zt(t))},Pe=function(n,t){return Ae(n,Ht(t))},He=function(n,t){return Yt(n,n,Zn(t),Wt())},ze=function(n,t,e){return Yt(n,n,Zn(t),e)},Ne=function(n,t){return ze(n,t,de)},Le=function(n,t){return ze(n,t,me)},je=function(n,t,e){return ze(n,t,be(e))},Ue=function(n,t){return ze(n,t,ge)},We=function(n,t){return ze(n,t,pe)},Ge=function(n,t){return ze(n,t,he)},Xe=function(n,t,e){return ze(n,t,Nt(e))},Ye=function(n,t,e){return ze(n,t,zt(e))},qe=function(n,t){return Xt(n,t)},Ke=function(n){var t=n,e=function(){return t},o=function(n){t=n};return{get:e,set:o}},Je=function(n,t){var e=t||document,o=e.createElement("div");if(o.innerHTML=n,!o.hasChildNodes()||o.childNodes.length>1)throw new Error("HTML must have a single root node");return Ze(o.childNodes[0])},$e=function(n,t){var e=t||document,o=e.createElement(n);return Ze(o)},Qe=function(n,t){var e=t||document,o=e.createTextNode(n);return Ze(o)},Ze=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:n}},no=function(n,t,e){return R.from(n.dom.elementFromPoint(t,e)).map(Ze)},to={fromHtml:Je,fromTag:$e,fromText:Qe,fromDom:Ze,fromPoint:no},eo=function(n,t,e,o){var r=n.isiOS()&&!0===/ipad/i.test(e),i=n.isiOS()&&!r,u=n.isiOS()||n.isAndroid(),a=u||o("(pointer:coarse)"),c=r||!i&&u&&o("(min-device-width:768px)"),s=i||u&&!c,f=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),l=!s&&!c&&!f;return{isiPad:y(r),isiPhone:y(i),isTablet:y(c),isPhone:y(s),isTouch:y(a),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:y(f),isDesktop:y(l)}},oo=function(n,t){for(var e=0;e<n.length;e++){var o=n[e];if(o.test(t))return o}},ro=function(n,t){var e=oo(n,t);if(!e)return{major:0,minor:0};var o=function(n){return Number(t.replace(e,"$"+n))};return ao(o(1),o(2))},io=function(n,t){var e=String(t).toLowerCase();return 0===n.length?uo():ro(n,e)},uo=function(){return ao(0,0)},ao=function(n,t){return{major:n,minor:t}},co={nu:ao,detect:io,unknown:uo},so=function(n,t){var e=String(t).toLowerCase();return Z(n,(function(n){return n.search(e)}))},fo=function(n,t){return so(n,t).map((function(n){var e=co.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},lo=function(n,t){return so(n,t).map((function(n){var e=co.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},mo={detectBrowser:fo,detectOs:lo},go=function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t},po=function(n,t){return-1!==n.indexOf(t)},vo=function(n,t){return go(n,t,n.length-t.length)},ho=function(n){return function(t){return t.replace(n,"")}},bo=ho(/^\s+|\s+$/g),yo=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,xo=function(n){return function(t){return po(t,n)}},wo=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return po(n,"edge/")&&po(n,"chrome")&&po(n,"safari")&&po(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,yo],search:function(n){return po(n,"chrome")&&!po(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return po(n,"msie")||po(n,"trident")}},{name:"Opera",versionRegexes:[yo,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:xo("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:xo("firefox")},{name:"Safari",versionRegexes:[yo,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(po(n,"safari")||po(n,"mobile/"))&&po(n,"applewebkit")}}],So=[{name:"Windows",search:xo("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return po(n,"iphone")||po(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:xo("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:xo("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:xo("linux"),versionRegexes:[]},{name:"Solaris",search:xo("sunos"),versionRegexes:[]},{name:"FreeBSD",search:xo("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:xo("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ko={browsers:y(wo),oses:y(So)},Co="Edge",Oo="Chrome",_o="IE",To="Opera",Eo="Firefox",Do="Safari",Bo=function(){return Ao({current:void 0,version:co.unknown()})},Ao=function(n){var t=n.current,e=n.version,o=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:o(Co),isChrome:o(Oo),isIE:o(_o),isOpera:o(To),isFirefox:o(Eo),isSafari:o(Do)}},Mo={unknown:Bo,nu:Ao,edge:y(Co),chrome:y(Oo),ie:y(_o),opera:y(To),firefox:y(Eo),safari:y(Do)},Fo="Windows",Io="iOS",Ro="Android",Vo="Linux",Po="OSX",Ho="Solaris",zo="FreeBSD",No="ChromeOS",Lo=function(){return jo({current:void 0,version:co.unknown()})},jo=function(n){var t=n.current,e=n.version,o=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:o(Fo),isiOS:o(Io),isAndroid:o(Ro),isOSX:o(Po),isLinux:o(Vo),isSolaris:o(Ho),isFreeBSD:o(zo),isChromeOS:o(No)}},Uo={unknown:Lo,nu:jo,windows:y(Fo),ios:y(Io),android:y(Ro),linux:y(Vo),osx:y(Po),solaris:y(Ho),freebsd:y(zo),chromeos:y(No)},Wo=function(n,t){var e=ko.browsers(),o=ko.oses(),r=mo.detectBrowser(e,n).fold(Mo.unknown,Mo.nu),i=mo.detectOs(o,n).fold(Uo.unknown,Uo.nu),u=eo(i,r,n,t);return{browser:r,os:i,deviceType:u}},Go={detect:Wo},Xo=function(n){return window.matchMedia(n).matches},Yo=$n((function(){return Go.detect(navigator.userAgent,Xo)})),qo=function(){return Yo()},Ko=function(n,t,e){return 0!==(n.compareDocumentPosition(t)&e)},Jo=function(n,t){return Ko(n,t,Node.DOCUMENT_POSITION_CONTAINED_BY)},$o=9,Qo=11,Zo=1,nr=3,tr=function(n,t){var e=n.dom;if(e.nodeType!==Zo)return!1;var o=e;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},er=function(n){return n.nodeType!==Zo&&n.nodeType!==$o&&n.nodeType!==Qo||0===n.childElementCount},or=function(n,t){var e=void 0===t?document:t.dom;return er(e)?[]:G(e.querySelectorAll(n),to.fromDom)},rr=function(n,t){var e=void 0===t?document:t.dom;return er(e)?R.none():R.from(e.querySelector(n)).map(to.fromDom)},ir=function(n,t){return n.dom===t.dom},ur=function(n,t){var e=n.dom,o=t.dom;return e!==o&&e.contains(o)},ar=function(n,t){return Jo(n.dom,t.dom)},cr=function(n,t){return qo().browser.isIE()?ar(n,t):ur(n,t)},sr=function(n){return d(n)?n:C},fr=function(n,t,e){var o=n.dom,r=sr(e);while(o.parentNode){o=o.parentNode;var i=to.fromDom(o),u=t(i);if(u.isSome())return u;if(r(i))break}return R.none()},lr=function(n,t,e){var o=t(n),r=sr(e);return o.orThunk((function(){return r(n)?R.none():fr(n,t,r)}))},dr=function(n,t){return ir(n.element,t.event.target)},mr=function(n){if(!jn(n,"can")&&!jn(n,"abort")&&!jn(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return ie("Extracting event.handler",Ht([He("can",O),He("abort",C),He("run",p)]),n)},gr=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return $(n,(function(n,o){return n&&t(o).apply(void 0,e)}),!0)}},pr=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return $(n,(function(n,o){return n||t(o).apply(void 0,e)}),!1)}},vr=function(n){return d(n)?{can:O,abort:C,run:n}:n},hr=function(n){var t=gr(n,(function(n){return n.can})),e=pr(n,(function(n){return n.abort})),o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];X(n,(function(n){n.run.apply(void 0,t)}))};return mr({can:t,abort:e,run:o})},br=y,yr=br("touchstart"),xr=br("touchmove"),wr=br("touchend"),Sr=br("touchcancel"),kr=br("mousedown"),Cr=br("mousemove"),Or=br("mouseout"),_r=br("mouseup"),Tr=br("mouseover"),Er=br("focusin"),Dr=br("focusout"),Br=br("keydown"),Ar=br("keyup"),Mr=br("input"),Fr=br("change"),Ir=br("click"),Rr=br("transitionend"),Vr=br("selectstart"),Pr=function(n){return y("alloy."+n)},Hr={tap:Pr("tap")},zr=Pr("focus"),Nr=Pr("blur.post"),Lr=Pr("paste.post"),jr=Pr("receive"),Ur=Pr("execute"),Wr=Pr("focus.item"),Gr=Hr.tap,Xr=Pr("longpress"),Yr=Pr("sandbox.close"),qr=Pr("typeahead.cancel"),Kr=Pr("system.init"),Jr=Pr("system.touchmove"),$r=Pr("system.touchend"),Qr=Pr("system.scroll"),Zr=Pr("system.resize"),ni=Pr("system.attached"),ti=Pr("system.detached"),ei=Pr("system.dismissRequested"),oi=Pr("system.repositionRequested"),ri=Pr("focusmanager.shifted"),ii=Pr("slotcontainer.visibility"),ui=Pr("change.tab"),ai=Pr("dismiss.tab"),ci=Pr("highlight"),si=Pr("dehighlight"),fi=function(n,t){gi(n,n.element,t,{})},li=function(n,t,e){gi(n,n.element,t,e)},di=function(n){fi(n,Ur())},mi=function(n,t,e){gi(n,t,e,{})},gi=function(n,t,e,o){var r=T({target:t},o);n.getSystem().triggerEvent(e,t,r)},pi=function(n,t,e,o){n.getSystem().triggerEvent(e,t,o.event)},vi=function(n){return lt(n)},hi=function(n,t){return{key:n,value:mr({abort:t})}},bi=function(n,t){return{key:n,value:mr({can:t})}},yi=function(n){return{key:n,value:mr({run:function(n,t){t.event.prevent()}})}},xi=function(n,t){return{key:n,value:mr({run:t})}},wi=function(n,t,e){return{key:n,value:mr({run:function(n,o){t.apply(void 0,[n,o].concat(e))}})}},Si=function(n){return function(t){return xi(n,t)}},ki=function(n){return function(t){return{key:n,value:mr({run:function(n,e){dr(n,e)&&t(n,e)}})}}},Ci=function(n,t){return xi(n,(function(e,o){e.getSystem().getByUid(t).each((function(t){pi(t,t.element,n,o)}))}))},Oi=function(n,t,e){var o=t.partUids[e];return Ci(n,o)},_i=function(n,t){return xi(n,(function(n,e){var o=e.event,r=n.getSystem().getByDom(o.target).fold((function(){var t=lr(o.target,(function(t){return n.getSystem().getByDom(t).toOptional()}),C);return t.getOr(n)}),(function(n){return n}));t(n,r,e)}))},Ti=function(n){return xi(n,(function(n,t){t.cut()}))},Ei=function(n){return xi(n,(function(n,t){t.stop()}))},Di=function(n,t){return ki(n)(t)},Bi=ki(ni()),Ai=ki(ti()),Mi=ki(Kr()),Fi=Si(Ur()),Ii=("undefined"!==typeof window?window:Function("return this;")(),function(n){var t=n.dom.nodeName;return t.toLowerCase()}),Ri=function(n){return n.dom.nodeType},Vi=function(n){return function(t){return Ri(t)===n}},Pi=Vi(Zo),Hi=Vi(nr),zi=Vi($o),Ni=Vi(Qo),Li=function(n){return to.fromDom(n.dom.ownerDocument)},ji=function(n){return zi(n)?n:Li(n)},Ui=function(n){return to.fromDom(ji(n).dom.documentElement)},Wi=function(n){return to.fromDom(ji(n).dom.defaultView)},Gi=function(n){return R.from(n.dom.parentNode).map(to.fromDom)},Xi=function(n){return Gi(n)},Yi=function(n){return R.from(n.dom.offsetParent).map(to.fromDom)},qi=function(n){return R.from(n.dom.nextSibling).map(to.fromDom)},Ki=function(n){return G(n.dom.childNodes,to.fromDom)},Ji=function(n,t){var e=n.dom.childNodes;return R.from(e[t]).map(to.fromDom)},$i=function(n){return Ji(n,0)},Qi=function(n){return Ni(n)&&l(n.dom.host)},Zi=d(Element.prototype.attachShadow)&&d(Node.prototype.getRootNode),nu=y(Zi),tu=Zi?function(n){return to.fromDom(n.dom.getRootNode())}:ji,eu=function(n){return Qi(n)?n:to.fromDom(ji(n).dom.body)},ou=function(n){return ru(n).isSome()},ru=function(n){var t=tu(n);return Qi(t)?R.some(t):R.none()},iu=function(n){return to.fromDom(n.dom.host)},uu=function(n){if(nu()&&l(n.target)){var t=to.fromDom(n.target);if(Pi(t)&&au(t)&&n.composed&&n.composedPath){var e=n.composedPath();if(e)return fn(e)}}return R.from(n.target)},au=function(n){return l(n.dom.shadowRoot)},cu=function(n,t){var e=Gi(n);e.each((function(e){e.dom.insertBefore(t.dom,n.dom)}))},su=function(n,t){var e=qi(n);e.fold((function(){var e=Gi(n);e.each((function(n){lu(n,t)}))}),(function(n){cu(n,t)}))},fu=function(n,t){var e=$i(n);e.fold((function(){lu(n,t)}),(function(e){n.dom.insertBefore(t.dom,e.dom)}))},lu=function(n,t){n.dom.appendChild(t.dom)},du=function(n,t,e){Ji(n,e).fold((function(){lu(n,t)}),(function(n){cu(n,t)}))},mu=function(n,t){X(t,(function(t){cu(n,t)}))},gu=function(n,t){X(t,(function(t){lu(n,t)}))},pu=function(n){n.dom.textContent="",X(Ki(n),(function(n){vu(n)}))},vu=function(n){var t=n.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},hu=function(n){var t=Ki(n);t.length>0&&mu(n,t),vu(n)},bu=function(n,t){var e=t||document,o=e.createElement("div");return o.innerHTML=n,Ki(to.fromDom(o))},yu=function(n){return n.dom.innerHTML},xu=function(n,t){var e=Li(n),o=e.dom,r=to.fromDom(o.createDocumentFragment()),i=bu(t,o);gu(r,i),pu(n),lu(n,r)},wu=function(n){var t=to.fromTag("div"),e=to.fromDom(n.dom.cloneNode(!0));return lu(t,e),yu(t)},Su=function(n,t,e){if(!(i(e)||c(e)||m(e)))throw new Error("Attribute value was not simple");n.setAttribute(t,e+"")},ku=function(n,t,e){Su(n.dom,t,e)},Cu=function(n,t){var e=n.dom;An(t,(function(n,t){Su(e,t,n)}))},Ou=function(n,t){var e=n.dom.getAttribute(t);return null===e?void 0:e},_u=function(n,t){return R.from(Ou(n,t))},Tu=function(n,t){var e=n.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},Eu=function(n,t){n.dom.removeAttribute(t)},Du=function(n,t){return to.fromDom(n.dom.cloneNode(t))},Bu=function(n){return Du(n,!1)},Au=function(n){if(Qi(n))return"#shadow-root";var t=Bu(n);return wu(t)},Mu=function(n){return Au(n)},Fu=function(n,t,e){return ir(t,n.element)&&!ir(t,e)},Iu=vi([bi(zr(),(function(n,t){var e=t.event,o=e.originator,r=e.target;return!Fu(n,o,r)}))]),Ru=Object.freeze({__proto__:null,events:Iu}),Vu=0,Pu=function(n){var t=new Date,e=t.getTime(),o=Math.floor(1e9*Math.random());return Vu++,n+"_"+o+Vu+String(e)},Hu=y("alloy-id-"),zu=y("data-alloy-id"),Nu=Hu(),Lu=zu(),ju=function(n,t){var e=Pu(Nu+n);return Uu(t,e),e},Uu=function(n,t){Object.defineProperty(n.dom,Lu,{value:t,writable:!0})},Wu=function(n){var t=Pi(n)?n.dom[Lu]:null;return R.from(t)},Gu=function(n){return Pu(n)},Xu=x,Yu=function(n){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+Mu(n().element)+" is not in context.":""))}};return{debugInfo:y("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:C}},qu=Yu(),Ku=function(n,t,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:Ju(u.slice(0,1).concat(u.slice(3)))}},n},Ju=function(n){return G(n,(function(n){return vo(n,"/*")?n.substring(0,n.length-"/*".length):n}))},$u=function(n,t){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:Ju(i)}},n},Qu=function(n,t){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Ju(i.slice(1))}},n},Zu=Pu("alloy-premade"),na=function(n){return ft(Zu,n)},ta=function(n){return Nn(n,Zu)},ea=function(n){return Qu((function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return n.apply(void 0,D([t.getApis(),t],e))}),n)},oa={init:function(){return ra({readState:function(){return"No State required"}})}},ra=function(n){return n},ia=function(n,t){var e=G(t,(function(n){return Ve(n.name(),[ye("config"),He("state",oa)])})),o=oe("component.behaviours",zt(e),n.behaviours).fold((function(t){throw new Error(ue(t)+"\nComplete spec:\n"+JSON.stringify(n,null,2))}),(function(n){return n}));return{list:t,data:Mn(o,(function(n){var t=n.map((function(n){return{config:n.config,state:n.state.init(n.config)}}));return function(){return t}}))}},ua=function(n){return n.list},aa=function(n){return n.data},ca=function(n,t){var e={};return An(n,(function(n,o){An(n,(function(n,r){var i=Nn(e,r).getOr([]);e[r]=i.concat([t(o,n)])}))})),e},sa=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},fa=function(n,t){return T(T({},n),{attributes:T(T({},n.attributes),t.attributes),styles:T(T({},n.styles),t.styles),classes:n.classes.concat(t.classes)})},la=function(n,t,e,o){var r=T({},t);X(e,(function(t){r[t.name()]=t.exhibit(n,o)}));var i=ca(r,(function(n,t){return{name:n,modification:t}})),u=function(n){return J(n,(function(n,t){return T(T({},t.modification),n)}),{})},a=J(i.classes,(function(n,t){return t.modification.concat(n)}),[]),c=u(i.attributes),s=u(i.styles);return sa({classes:a,attributes:c,styles:s})},da=function(n,t,e,o){try{var r=cn(e,(function(e,r){var i=e[t],u=r[t],a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0}));return hn.value(r)}catch(i){return hn.error([i])}},ma=function(n,t){return{handler:n,purpose:t}},ga=function(n,t){return{cHandler:n,purpose:t}},pa=function(n,t){return ga(w.apply(void 0,[n.handler].concat(t)),n.purpose)},va=function(n){return n.cHandler},ha=function(n,t){return{name:n,handler:t}},ba=function(n,t){var e={};return X(n,(function(n){e[n.name()]=n.handlers(t)})),e},ya=function(n,t,e){var o=T(T({},e),ba(t,n));return ca(o,ha)},xa=function(n,t,e,o){var r=ya(n,e,o);return Ca(r,t)},wa=function(n){var t=vr(n);return function(n,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[n,e].concat(o);t.abort.apply(void 0,i)?e.stop():t.can.apply(void 0,i)&&t.run.apply(void 0,i)}},Sa=function(n,t){return hn.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(G(t,(function(n){return n.name})),null,2)])},ka=function(n,t,e){var o=t[e];return o?da("Event: "+e,"name",n,o).map((function(n){var t=G(n,(function(n){return n.handler}));return hr(t)})):Sa(e,n)},Ca=function(n,t){var e=Pn(n,(function(n,e){var o=1===n.length?hn.value(n[0].handler):ka(n,t,e);return o.map((function(o){var r=wa(o),i=n.length>1?K(t[e],(function(t){return j(n,(function(n){return n.name===t}))})).join(" > "):n[0].name;return ft(e,ma(r,i))}))}));return gt(e,{})},Oa="alloy.base.behaviour",_a=function(n){var t;return oe("custom.definition",zt([Yt("dom","dom",tt(),zt([ye("tag"),He("styles",{}),He("classes",[]),He("attributes",{}),Be("value"),Be("innerHtml")])),ye("components"),ye("uid"),He("events",{}),He("apis",{}),Yt("eventOrder","eventOrder",nt((t={},t[Ur()]=["disabling",Oa,"toggling","typeaheadevents"],t[zr()]=[Oa,"focusing","keying"],t[Kr()]=[Oa,"disabling","toggling","representing"],t[Mr()]=[Oa,"representing","streaming","invalidating"],t[ti()]=[Oa,"representing","item-events","tooltipping"],t[kr()]=["focusing",Oa,"item-type-events"],t[yr()]=["focusing",Oa,"item-type-events"],t[Tr()]=["item-type-events","tooltipping"],t[jr()]=["receiving","reflecting","tooltipping"],t)),fe()),Be("domModification")]),n)},Ta=function(n){return T(T({},n.dom),{uid:n.uid,domChildren:G(n.components,(function(n){return n.element}))})},Ea=function(n){return n.domModification.fold((function(){return sa({})}),sa)},Da=function(n){return n.events},Ba=function(n,t){var e=Ou(n,t);return void 0===e||""===e?[]:e.split(" ")},Aa=function(n,t,e){var o=Ba(n,t),r=o.concat([e]);return ku(n,t,r.join(" ")),!0},Ma=function(n,t,e){var o=K(Ba(n,t),(function(n){return n!==e}));return o.length>0?ku(n,t,o.join(" ")):Eu(n,t),!1},Fa=function(n){return void 0!==n.dom.classList},Ia=function(n){return Ba(n,"class")},Ra=function(n,t){return Aa(n,"class",t)},Va=function(n,t){return Ma(n,"class",t)},Pa=function(n,t){Fa(n)?n.dom.classList.add(t):Ra(n,t)},Ha=function(n){var t=Fa(n)?n.dom.classList:Ia(n);0===t.length&&Eu(n,"class")},za=function(n,t){if(Fa(n)){var e=n.dom.classList;e.remove(t)}else Va(n,t);Ha(n)},Na=function(n,t){return Fa(n)&&n.dom.classList.contains(t)},La=function(n,t){X(t,(function(t){Pa(n,t)}))},ja=function(n,t){X(t,(function(t){za(n,t)}))},Ua=function(n){return void 0!==n.style&&d(n.style.getPropertyValue)},Wa=function(n){var t=Hi(n)?n.dom.parentNode:n.dom;if(void 0===t||null===t||null===t.ownerDocument)return!1;var e=t.ownerDocument;return ru(to.fromDom(t)).fold((function(){return e.body.contains(t)}),b(Wa,iu))},Ga=function(){return Xa(to.fromDom(document))},Xa=function(n){var t=n.dom.body;if(null===t||void 0===t)throw new Error("Body is not available yet");return to.fromDom(t)},Ya=function(n,t,e){if(!i(e))throw new Error("CSS value must be a string: "+e);Ua(n)&&n.style.setProperty(t,e)},qa=function(n,t){Ua(n)&&n.style.removeProperty(t)},Ka=function(n,t,e){var o=n.dom;Ya(o,t,e)},Ja=function(n,t){var e=n.dom;An(t,(function(n,t){Ya(e,t,n)}))},$a=function(n,t){var e=n.dom;An(t,(function(n,t){n.fold((function(){qa(e,t)}),(function(n){Ya(e,t,n)}))}))},Qa=function(n,t){var e=n.dom,o=window.getComputedStyle(e),r=o.getPropertyValue(t);return""!==r||Wa(n)?r:Za(e,t)},Za=function(n,t){return Ua(n)?n.style.getPropertyValue(t):""},nc=function(n,t){var e=n.dom,o=Za(e,t);return R.from(o).filter((function(n){return n.length>0}))},tc=function(n){var t={},e=n.dom;if(Ua(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);t[r]=e.style[r]}return t},ec=function(n,t,e){var o=to.fromTag(n);Ka(o,t,e);var r=nc(o,t);return r.isSome()},oc=function(n,t){var e=n.dom;qa(e,t),_u(n,"style").map(bo).is("")&&Eu(n,"style")},rc=function(n){return n.dom.offsetWidth},ic=function(n){return n.dom.value},uc=function(n,t){if(void 0===t)throw new Error("Value.set was undefined");n.dom.value=t},ac=function(n){var t=to.fromTag(n.tag);Cu(t,n.attributes),La(t,n.classes),Ja(t,n.styles),n.innerHtml.each((function(n){return xu(t,n)}));var e=n.domChildren;return gu(t,e),n.value.each((function(n){uc(t,n)})),n.uid,Uu(t,n.uid),t},cc=function(n){var t=Nn(n,"behaviours").getOr({}),e=K(Dn(t),(function(n){return void 0!==t[n]}));return G(e,(function(n){return t[n].me}))},sc=function(n,t){return ia(n,t)},fc=function(n){var t=cc(n);return sc(n,t)},lc=function(n,t,e){var o=Ta(n),r=Ea(n),i={"alloy.base.modification":r},u=t.length>0?la(e,i,t,o):r;return fa(o,u)},dc=function(n,t,e){var o={"alloy.base.behaviour":Da(n)};return xa(e,n.eventOrder,t,o).getOrDie()},mc=function(n){var t=function(){return y},e=Ke(qu),o=re(_a(n)),r=fc(n),i=ua(r),u=aa(r),a=lc(o,i,u),c=ac(a),s=dc(o,i,u),f=Ke(o.components),l=function(n){e.set(n)},m=function(){e.set(Yu(t))},g=function(){var n=Ki(c),t=en(n,(function(n){return e.get().getByDom(n).fold((function(){return[]}),(function(n){return[n]}))}));f.set(t)},p=function(t){var e=u,o=d(e[t.name()])?e[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(n,null,2))};return o()},v=function(n){return d(u[n.name()])},h=function(){return o.apis},b=function(n){return u[n]().map((function(n){return n.state.readState()})).getOr("not enabled")},y={getSystem:e.get,config:p,hasConfigured:v,spec:n,readState:b,getApis:h,connect:l,disconnect:m,element:c,syncComponents:g,components:f.get,events:s};return y},gc=function(n){var t=Nn(n,"components").getOr([]);return G(t,yc)},pc=function(n){var t=Xu(n),e=t.events,o=E(t,["events"]),r=gc(o),i=T(T({},o),{events:T(T({},Ru),e),components:r});return hn.value(mc(i))},vc=function(n){var t=to.fromText(n);return hc({element:t})},hc=function(n){var t=ie("external.component",Ht([ye("element"),Be("uid")]),n),e=Ke(Yu()),o=function(n){e.set(n)},r=function(){e.set(Yu((function(){return i})))};t.uid.each((function(n){Uu(t.element,n)}));var i={getSystem:e.get,config:R.none,hasConfigured:C,connect:o,disconnect:r,getApis:function(){return{}},element:t.element,spec:n,readState:y("No state"),syncComponents:p,components:y([]),events:{}};return na(i)},bc=Gu,yc=function(n){return ta(n).fold((function(){var t=n.hasOwnProperty("uid")?n:T({uid:bc("")},n);return pc(t).getOrDie()}),(function(n){return n}))},xc=na,wc=function(n,t){var e=function(t,e){if(!m(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var o=t.dom;Ua(o)&&(o.style[n]=e+"px")},o=function(e){var o=t(e);if(o<=0||null===o){var r=Qa(e,n);return parseFloat(r)||0}return o},r=o,i=function(n,t){return $(t,(function(t,e){var o=Qa(n,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?t:t+r}),0)},u=function(n,t,e){var o=i(n,e),r=t>o?t-o:0;return r};return{set:e,get:o,getOuter:r,aggregate:i,max:u}},Sc=wc("height",(function(n){var t=n.dom;return Wa(n)?t.getBoundingClientRect().height:t.offsetHeight})),kc=function(n){return Sc.get(n)},Cc=function(n){return Sc.getOuter(n)},Oc=function(n,t){var e=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],o=Sc.max(n,t,e);Ka(n,"max-height",o+"px")},_c=function(n,t){var e=function(e,o){return _c(n+e,t+o)};return{left:n,top:t,translate:e}},Tc=_c,Ec=function(n){var t=n.getBoundingClientRect();return Tc(t.left,t.top)},Dc=function(n,t){return void 0!==n?n:void 0!==t?t:0},Bc=function(n){var t=n.dom.ownerDocument,e=t.body,o=t.defaultView,r=t.documentElement;if(e===n.dom)return Tc(e.offsetLeft,e.offsetTop);var i=Dc(null===o||void 0===o?void 0:o.pageYOffset,r.scrollTop),u=Dc(null===o||void 0===o?void 0:o.pageXOffset,r.scrollLeft),a=Dc(r.clientTop,e.clientTop),c=Dc(r.clientLeft,e.clientLeft);return Ac(n).translate(u-c,i-a)},Ac=function(n){var t=n.dom,e=t.ownerDocument,o=e.body;return o===t?Tc(o.offsetLeft,o.offsetTop):Wa(n)?Ec(t):Tc(0,0)},Mc=wc("width",(function(n){return n.dom.offsetWidth})),Fc=function(n,t){return Mc.set(n,t)},Ic=function(n){return Mc.get(n)},Rc=function(n){return Mc.getOuter(n)},Vc=function(n,t){var e=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],o=Mc.max(n,t,e);Ka(n,"max-width",o+"px")},Pc=function(n,t,e,o,r,i,u){return{target:n,x:t,y:e,stop:o,prevent:r,kill:i,raw:u}},Hc=function(n){var t=to.fromDom(uu(n).getOr(n.target)),e=function(){return n.stopPropagation()},o=function(){return n.preventDefault()},r=h(o,e);return Pc(t,n.clientX,n.clientY,e,o,r,n)},zc=function(n,t){return function(e){n(e)&&t(Hc(e))}},Nc=function(n,t,e,o,r){var i=zc(e,o);return n.dom.addEventListener(t,i,r),{unbind:w(Uc,n,t,i,r)}},Lc=function(n,t,e,o){return Nc(n,t,e,o,!1)},jc=function(n,t,e,o){return Nc(n,t,e,o,!0)},Uc=function(n,t,e,o){n.dom.removeEventListener(t,e,o)},Wc=function(n){var t=void 0!==n?n.dom:document,e=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop;return Tc(e,o)},Gc=function(n,t,e){var o=void 0!==e?e.dom:document,r=o.defaultView;r&&r.scrollTo(n,t)},Xc=function(n){var t=void 0===n?window:n;return R.from(t["visualViewport"])},Yc=function(n,t,e,o){return{x:n,y:t,width:e,height:o,right:n+e,bottom:t+o}},qc=function(n){var t=void 0===n?window:n,e=t.document,o=Wc(to.fromDom(e));return Xc(t).fold((function(){var n=t.document.documentElement,e=n.clientWidth,r=n.clientHeight;return Yc(o.left,o.top,e,r)}),(function(n){return Yc(Math.max(n.pageLeft,o.left),Math.max(n.pageTop,o.top),n.width,n.height)}))},Kc=function(n,t){var e=n.view(t);return e.fold(y([]),(function(t){var e=n.owner(t),o=Kc(n,e);return[t].concat(o)}))},Jc=function(n,t){var e=t.owner(n),o=Kc(t,e);return R.some(o)},$c=function(n){var t,e=n.dom===document?R.none():R.from(null===(t=n.dom.defaultView)||void 0===t?void 0:t.frameElement);return e.map(to.fromDom)},Qc=function(n){return Li(n)},Zc=Object.freeze({__proto__:null,view:$c,owner:Qc}),ns=function(n){var t=to.fromDom(document),e=Wc(t),o=Jc(n,Zc);return o.fold(w(Bc,n),(function(t){var o=Ac(n),r=J(t,(function(n,t){var e=Ac(t);return{left:n.left+e.left,top:n.top+e.top}}),{left:0,top:0});return Tc(r.left+o.left+e.left,r.top+o.top+e.top)}))},ts=function(n,t,e){return{point:n,width:t,height:e}},es=function(n,t,e,o){return{x:n,y:t,width:e,height:o}},os=function(n,t,e,o){return{x:n,y:t,width:e,height:o,right:n+e,bottom:t+o}},rs=function(n){var t=Bc(n),e=Rc(n),o=Cc(n);return os(t.left,t.top,e,o)},is=function(n){var t=ns(n),e=Rc(n),o=Cc(n);return os(t.left,t.top,e,o)},us=function(){return qc(window)};function as(n,t,e,o,r){return n(e,o)?R.some(e):d(r)&&r(e)?R.none():t(e,o,r)}var cs,ss=function(n,t,e){var o=n.dom,r=d(e)?e:C;while(o.parentNode){o=o.parentNode;var i=to.fromDom(o);if(t(i))return R.some(i);if(r(i))break}return R.none()},fs=function(n,t,e){var o=function(n,t){return t(n)};return as(o,ss,n,t,e)},ls=function(n,t){var e=function(n){for(var o=0;o<n.childNodes.length;o++){var r=to.fromDom(n.childNodes[o]);if(t(r))return R.some(r);var i=e(n.childNodes[o]);if(i.isSome())return i}return R.none()};return e(n.dom)},ds=function(n,t,e){return fs(n,t,e).isSome()},ms=function(n,t,e){return ss(n,(function(n){return tr(n,t)}),e)},gs=function(n,t){return rr(t,n)},ps=function(n,t,e){var o=function(n,t){return tr(n,t)};return as(o,ms,n,t,e)},vs=function(n){var t=fs(n,(function(n){if(!Pi(n))return!1;var t=Ou(n,"id");return void 0!==t&&t.indexOf("aria-owns")>-1}));return t.bind((function(n){var t=Ou(n,"id"),e=tu(n);return gs(e,'[aria-owns="'+t+'"]')}))},hs=function(){var n=Pu("aria-owns"),t=function(t){ku(t,"aria-owns",n)},e=function(n){Eu(n,"aria-owns")};return{id:n,link:t,unlink:e}},bs=function(n,t){return vs(t).exists((function(t){return ys(n,t)}))},ys=function(n,t){return ds(t,(function(t){return ir(t,n.element)}),C)||bs(n,t)},xs="unknown";(function(n){n[n["STOP"]=0]="STOP",n[n["NORMAL"]=1]="NORMAL",n[n["LOGGING"]=2]="LOGGING"})(cs||(cs={}));var ws,Ss=Ke({}),ks=function(n,t){var e=[];(new Date).getTime();return{logEventCut:function(n,t,o){e.push({outcome:"cut",target:t,purpose:o})},logEventStopped:function(n,t,o){e.push({outcome:"stopped",target:t,purpose:o})},logNoParent:function(n,t,o){e.push({outcome:"no-parent",target:t,purpose:o})},logEventNoHandlers:function(n,t){e.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(n,t,o){e.push({outcome:"response",purpose:o,target:t})},write:function(){(new Date).getTime();L(["mousemove","mouseover","mouseout",Kr()],n)}}},Cs=function(n,t,e){var o=Nn(Ss.get(),n).orThunk((function(){var t=Dn(Ss.get());return mn(t,(function(t){return n.indexOf(t)>-1?R.some(Ss.get()[t]):R.none()}))})).getOr(cs.NORMAL);switch(o){case cs.NORMAL:return e(Ds());case cs.LOGGING:var r=ks(n,t),i=e(r);return r.write(),i;case cs.STOP:return!0}},Os=["alloy/data/Fields","alloy/debugging/Debugging"],_s=function(){var n=new Error;if(void 0!==n.stack){var t=n.stack.split("\n");return Z(t,(function(n){return n.indexOf("alloy")>0&&!j(Os,(function(t){return n.indexOf(t)>-1}))})).getOr(xs)}return xs},Ts={logEventCut:p,logEventStopped:p,logNoParent:p,logEventNoHandlers:p,logEventResponse:p,write:p},Es=function(n,t,e){return Cs(n,t,e)},Ds=y(Ts),Bs=y([ye("menu"),ye("selectedMenu")]),As=y([ye("item"),ye("selectedItem")]),Ms=(y(zt(As().concat(Bs()))),y(zt(As()))),Fs=Te("initSize",[ye("numColumns"),ye("numRows")]),Is=function(){return xe("markers",Ms())},Rs=function(){return Te("markers",[ye("backgroundMenu")].concat(Bs()).concat(As()))},Vs=function(n){return Te("markers",G(n,ye))},Ps=function(n,t,e){_s();return Yt(t,t,e,ne((function(n){return hn.value((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(void 0,t)}))})))},Hs=function(n){return Ps("onHandler",n,Zn(p))},zs=function(n){return Ps("onKeyboardHandler",n,Zn(R.none))},Ns=function(n){return Ps("onHandler",n,tt())},Ls=function(n){return Ps("onKeyboardHandler",n,tt())},js=function(n,t){return qe(n,y(t))},Us=function(n){return qe(n,x)},Ws=y(Fs),Gs=function(n,t,e,o,r,i){return{x:n,y:t,bubble:e,direction:o,boundsRestriction:r,label:i}},Xs=Wn.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Ys=function(n,t,e,o,r,i,u,a,c){return n.fold(t,e,o,r,i,u,a,c)},qs=function(n,t,e,o){return n.fold(t,t,o,o,t,o,e,e)},Ks=function(n,t,e,o){return n.fold(t,o,t,o,e,e,t,o)},Js=Xs.southeast,$s=Xs.southwest,Qs=Xs.northeast,Zs=Xs.northwest,nf=Xs.south,tf=Xs.north,ef=Xs.east,of=Xs.west,rf=function(n,t){switch(t){case 1:return n.x;case 0:return n.x+n.width;case 2:return n.y;case 3:return n.y+n.height}},uf=function(n,t){return an(["left","right","top","bottom"],(function(e){return Nn(t,e).map((function(t){return rf(n,t)}))}))},af=function(n,t,e){var o=function(n,o){var r="top"===n||"bottom"===n?e.top:e.left;return Nn(t,n).bind(x).bind((function(t){return"left"===n||"top"===n?t>=o?R.some(t):R.none():t<=o?R.some(t):R.none()})).map((function(n){return n+r})).getOr(o)},r=o("left",n.x),i=o("top",n.y),u=o("right",n.right),a=o("bottom",n.bottom);return os(r,i,u-r,a-i)},cf=function(n){return n.x},sf=function(n,t){return n.x+n.width/2-t.width/2},ff=function(n,t){return n.x+n.width-t.width},lf=function(n,t){return n.y-t.height},df=function(n){return n.y+n.height},mf=function(n,t){return n.y+n.height/2-t.height/2},gf=function(n){return n.x+n.width},pf=function(n,t){return n.x-t.width},vf=function(n,t,e){return Gs(cf(n),df(n),e.southeast(),Js(),uf(n,{left:1,top:3}),"layout-se")},hf=function(n,t,e){return Gs(ff(n,t),df(n),e.southwest(),$s(),uf(n,{right:0,top:3}),"layout-sw")},bf=function(n,t,e){return Gs(cf(n),lf(n,t),e.northeast(),Qs(),uf(n,{left:1,bottom:2}),"layout-ne")},yf=function(n,t,e){return Gs(ff(n,t),lf(n,t),e.northwest(),Zs(),uf(n,{right:0,bottom:2}),"layout-nw")},xf=function(n,t,e){return Gs(sf(n,t),lf(n,t),e.north(),tf(),uf(n,{bottom:2}),"layout-n")},wf=function(n,t,e){return Gs(sf(n,t),df(n),e.south(),nf(),uf(n,{top:3}),"layout-s")},Sf=function(n,t,e){return Gs(gf(n),mf(n,t),e.east(),ef(),uf(n,{left:0}),"layout-e")},kf=function(n,t,e){return Gs(pf(n,t),mf(n,t),e.west(),of(),uf(n,{right:1}),"layout-w")},Cf=function(){return[vf,hf,bf,yf,wf,xf,Sf,kf]},Of=function(){return[hf,vf,yf,bf,wf,xf,Sf,kf]},_f=function(){return[bf,yf,vf,hf,xf,wf]},Tf=function(){return[yf,bf,hf,vf,xf,wf]},Ef=function(){return[vf,hf,bf,yf,wf,xf]},Df=function(){return[hf,vf,yf,bf,wf,xf]},Bf=function(n,t){return t.universal?n:K(n,(function(n){return L(t.channels,n)}))},Af=function(n){return vi([xi(jr(),(function(t,e){var o=n.channels,r=Dn(o),i=e,u=Bf(r,i);X(u,(function(n){var e=o[n],r=e.schema,u=ie("channel["+n+"] data\nReceiver: "+Mu(t.element),r,i.data);e.onReceive(t,u)}))}))])},Mf=Object.freeze({__proto__:null,events:Af}),Ff=[xe("channels",te(hn.value,Ht([Ns("onReceive"),He("schema",fe())])))],If=function(n,t,e){return Fi((function(o){e(o,n,t)}))},Rf=function(n,t,e){return Mi((function(o,r){e(o,n,t)}))},Vf=function(n,t,e,o,r,i){var u=Ht(n),a=Ve(t,[Pe("config",n)]);return Nf(u,a,t,e,o,r,i)},Pf=function(n,t,e,o,r,i){var u=n,a=Ve(t,[Ae("config",n)]);return Nf(u,a,t,e,o,r,i)},Hf=function(n,t,e){var o=function(o){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var u=[o].concat(r);return o.config({name:y(n)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+e)}),(function(n){var e=Array.prototype.slice.call(u,1);return t.apply(void 0,[o,n.config,n.state].concat(e))}))};return Ku(o,e,t)},zf=function(n){return{key:n,value:void 0}},Nf=function(n,t,e,o,r,i,u){var a=function(n){return jn(n,e)?n[e]():R.none()},c=Mn(r,(function(n,t){return Hf(e,n,t)})),s=Mn(i,(function(n,t){return $u(n,t)})),f=T(T(T({},s),c),{revoke:w(zf,e),config:function(t){var o=ie(e+"-config",n,t);return{key:e,value:{config:o,me:f,configAsRaw:$n((function(){return ie(e+"-config",n,t)})),initialConfig:t,state:u}}},schema:y(t),exhibit:function(n,t){return a(n).bind((function(n){return Nn(o,"exhibit").map((function(e){return e(t,n.config,n.state)}))})).getOr(sa({}))},name:y(e),handlers:function(n){return a(n).map((function(n){var t=Nn(o,"events").getOr((function(){return{}}));return t(n.config,n.state)})).getOr({})}});return f},Lf=function(n){return lt(n)},jf=Ht([ye("fields"),ye("name"),He("active",{}),He("apis",{}),He("state",oa),He("extra",{})]),Uf=function(n){var t=ie("Creating behaviour: "+n.name,jf,n);return Vf(t.fields,t.name,t.active,t.apis,t.extra,t.state)},Wf=Ht([ye("branchKey"),ye("branches"),ye("name"),He("active",{}),He("apis",{}),He("state",oa),He("extra",{})]),Gf=function(n){var t=ie("Creating behaviour: "+n.name,Wf,n);return Pf(ce(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},Xf=y(void 0),Yf=Uf({fields:Ff,name:"receiving",active:Mf}),qf=function(n,t){return sa({classes:[],styles:t.useFixed()?{}:{position:"relative"}})},Kf=Object.freeze({__proto__:null,exhibit:qf}),Jf=function(){return to.fromDom(document)},$f=function(n){return n.dom.focus()},Qf=function(n){return n.dom.blur()},Zf=function(n){var t=tu(n).dom;return n.dom===t.activeElement},nl=function(n){return void 0===n&&(n=Jf()),R.from(n.dom.activeElement).map(to.fromDom)},tl=function(n){return nl(tu(n)).filter((function(t){return n.dom.contains(t.dom)}))},el=function(n,t){var e=tu(t),o=nl(e).bind((function(n){var e=function(t){return ir(n,t)};return e(t)?R.some(t):ls(t,e)})),r=n(t);return o.each((function(n){nl(e).filter((function(t){return ir(t,n)})).fold((function(){$f(n)}),p)})),r},ol=function(n,t,e,o,r){return{position:n,left:t,top:e,right:o,bottom:r}},rl=function(n,t){var e=function(n){return n+"px"};$a(n,{position:R.some(t.position),left:t.left.map(e),top:t.top.map(e),right:t.right.map(e),bottom:t.bottom.map(e)})},il=Wn.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),ul=function(n,t,e,o,r,i){var u=t.x-e,a=t.y-o,c=t.width,s=t.height,f=r-(u+c),l=i-(a+s),d=R.some(u),m=R.some(a),g=R.some(f),p=R.some(l),v=R.none();return Ys(t.direction,(function(){return ol(n,d,m,v,v)}),(function(){return ol(n,v,m,g,v)}),(function(){return ol(n,d,v,v,p)}),(function(){return ol(n,v,v,g,p)}),(function(){return ol(n,d,m,v,v)}),(function(){return ol(n,d,v,v,p)}),(function(){return ol(n,d,m,v,v)}),(function(){return ol(n,v,m,g,v)}))},al=function(n,t){return n.fold((function(){return ol("absolute",R.some(t.x),R.some(t.y),R.none(),R.none())}),(function(n,e,o,r){return ul("absolute",t,n,e,o,r)}),(function(n,e,o,r){return ul("fixed",t,n,e,o,r)}))},cl=function(n,t){var e=w(ns,t),o=n.fold(e,e,(function(){var n=Wc();return ns(t).translate(-n.left,-n.top)})),r=Rc(t),i=Cc(t);return os(o.left,o.top,r,i)},sl=function(n,t){return t.fold((function(){return n.fold(us,us,os)}),(function(t){return n.fold(t,t,(function(){var e=t(),o=fl(n,e.x,e.y);return os(o.left,o.top,e.width,e.height)}))}))},fl=function(n,t,e){var o=Tc(t,e),r=function(){var n=Wc();return o.translate(-n.left,-n.top)};return n.fold(y(o),y(o),r)},ll=function(n,t,e,o){return n.fold(t,e,o)},dl=(il.none,il.relative),ml=il.fixed,gl=function(n,t){return{anchorBox:n,origin:t}},pl=function(n,t){return gl(n,t)},vl=function(n,t,e,o){var r=n+t;return r>o?e:r<e?o:r},hl=function(n,t,e){return Math.min(Math.max(n,t),e)},bl=Wn.generate([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),yl=function(n,t,e,o,r){var i=r.x,u=r.y,a=r.width,c=r.height,s=n>=i,f=t>=u,l=s&&f,d=n+e<=i+a,m=t+o<=u+c,g=d&&m,p=Math.abs(Math.min(e,s?i+a-n:i-(n+e))),v=Math.abs(Math.min(o,f?u+c-t:u-(t+o))),h=Math.max(r.x,r.right-e),b=Math.max(r.y,r.bottom-o),y=hl(n,r.x,h),x=hl(t,r.y,b);return{originInBounds:l,sizeInBounds:g,limitX:y,limitY:x,deltaW:p,deltaH:v}},xl=function(n,t,e,o){var r=n.x,i=n.y,u=n.bubble.offset,a=u.left,c=u.top,s=af(o,n.boundsRestriction,u),f=s.y,l=s.bottom,d=s.x,m=s.right,g=r+a,p=i+c,v=yl(g,p,t,e,s),h=v.originInBounds,b=v.sizeInBounds,x=v.limitX,w=v.limitY,S=v.deltaW,k=v.deltaH,C=y(w+k-f),O=y(l-w),_=qs(n.direction,O,O,C),T=y(x+S-d),E=y(m-x),D=Ks(n.direction,E,E,T),B={x:x,y:w,width:S,height:k,maxHeight:_,maxWidth:D,direction:n.direction,classes:{on:n.bubble.classesOn,off:n.bubble.classesOff},label:n.label,candidateYforTest:p};return h&&b?bl.fit(B):bl.nofit(B,S,k)},wl=function(n,t,e,o,r){var i=e.width,u=e.height,a=function(n,a,c,s){var f=n(t,e,o),l=xl(f,i,u,r);return l.fold(bl.fit,(function(n,t,e){var o=e>s||t>c;return o?bl.nofit(n,t,e):bl.nofit(a,c,s)}))},c=$(n,(function(n,t){var e=w(a,t);return n.fold(bl.fit,e)}),bl.nofit({x:t.x,y:t.y,width:e.width,height:e.height,maxHeight:e.height,maxWidth:e.width,direction:Js(),classes:{on:[],off:[]},label:"none",candidateYforTest:t.y},-1,-1));return c.fold(x,x)},Sl=function(n){return{width:Rc(n),height:Cc(n)}},kl=function(n,t,e,o){oc(t,"max-height"),oc(t,"max-width");var r=Sl(t);return wl(o.preference,n,r,e,o.bounds)},Cl=function(n,t){var e=t.classes;ja(n,e.off),La(n,e.on)},Ol=function(n,t,e){var o=e.maxHeightFunction;o(n,t.maxHeight)},_l=function(n,t,e){var o=e.maxWidthFunction;o(n,t.maxWidth)},Tl=function(n,t,e){rl(n,al(e.origin,t))},El=function(n,t){Oc(n,Math.floor(t))},Dl=y((function(n,t){El(n,t),Ja(n,{"overflow-x":"hidden","overflow-y":"auto"})})),Bl=y((function(n,t){El(n,t)})),Al=function(n,t,e){return void 0===n[t]?e:n[t]},Ml=function(n,t,e,o,r,i){var u=Al(i,"maxHeightFunction",Dl()),a=Al(i,"maxWidthFunction",p),c=n.anchorBox,s=n.origin,f={bounds:sl(s,r),origin:s,preference:o,maxHeightFunction:u,maxWidthFunction:a};Fl(c,t,e,f)},Fl=function(n,t,e,o){var r=kl(n,t,e,o);Tl(t,r,o),Cl(t,r),Ol(t,r,o),_l(t,r,o)},Il=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Rl=function(n,t,e){var o=function(n){return Nn(e,n).getOr([])},r=function(n,t,e){var r=un(Il,e);return{offset:Tc(n,t),classesOn:en(e,o),classesOff:en(r,o)}};return{southeast:function(){return r(-n,t,["top","alignLeft"])},southwest:function(){return r(n,t,["top","alignRight"])},south:function(){return r(-n/2,t,["top","alignCentre"])},northeast:function(){return r(-n,-t,["bottom","alignLeft"])},northwest:function(){return r(n,-t,["bottom","alignRight"])},north:function(){return r(-n/2,-t,["bottom","alignCentre"])},east:function(){return r(n,-t/2,["valignCentre","left"])},west:function(){return r(-n,-t/2,["valignCentre","right"])},innerNorthwest:function(){return r(-n,t,["top","alignRight"])},innerNortheast:function(){return r(n,t,["top","alignLeft"])},innerNorth:function(){return r(-n/2,t,["top","alignCentre"])},innerSouthwest:function(){return r(-n,-t,["bottom","alignRight"])},innerSoutheast:function(){return r(n,-t,["bottom","alignLeft"])},innerSouth:function(){return r(-n/2,-t,["bottom","alignCentre"])},innerWest:function(){return r(n,-t/2,["valignCentre","right"])},innerEast:function(){return r(-n,-t/2,["valignCentre","left"])}}},Vl=function(){return Rl(0,0,{})},Pl=function(n){return n},Hl=function(n,t){return function(e){return"rtl"===zl(e)?t:n}},zl=function(n){return"rtl"===Qa(n,"direction")?"rtl":"ltr"};(function(n){n["TopToBottom"]="toptobottom",n["BottomToTop"]="bottomtotop"})(ws||(ws={}));var Nl,Ll="data-alloy-vertical-dir",jl=function(n){return ds(n,(function(n){return Pi(n)&&Ou(n,"data-alloy-vertical-dir")===ws.BottomToTop}))},Ul=function(){return Ve("layouts",[ye("onLtr"),ye("onRtl"),Be("onBottomLtr"),Be("onBottomRtl")])},Wl=function(n,t,e,o,r,i,u){var a=u.map(jl).getOr(!1),c=t.layouts.map((function(t){return t.onLtr(n)})),s=t.layouts.map((function(t){return t.onRtl(n)})),f=a?t.layouts.bind((function(t){return t.onBottomLtr.map((function(t){return t(n)}))})).or(c).getOr(r):c.getOr(e),l=a?t.layouts.bind((function(t){return t.onBottomRtl.map((function(t){return t(n)}))})).or(s).getOr(i):s.getOr(o),d=Hl(f,l);return d(n)},Gl=function(n,t,e){var o=t.hotspot,r=cl(e,o.element),i=Wl(n.element,t,Ef(),Df(),_f(),Tf(),R.some(t.hotspot.element));return R.some(Pl({anchorBox:r,bubble:t.bubble.getOr(Vl()),overrides:t.overrides,layouts:i,placer:R.none()}))},Xl=[ye("hotspot"),Be("bubble"),He("overrides",{}),Ul(),js("placement",Gl)],Yl=function(n,t,e){var o=fl(e,t.x,t.y),r=os(o.left,o.top,t.width,t.height),i=Wl(n.element,t,Cf(),Of(),Cf(),Of(),R.none());return R.some(Pl({anchorBox:r,bubble:t.bubble,overrides:t.overrides,layouts:i,placer:R.none()}))},ql=[ye("x"),ye("y"),He("height",0),He("width",0),He("bubble",Vl()),He("overrides",{}),Ul(),js("placement",Yl)],Kl=Wn.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Jl=function(n){return n.fold(x,(function(n,t,e){return n.translate(-t,-e)}))},$l=function(n){return n.fold(x,x)},Ql=function(n){return $(n,(function(n,t){return n.translate(t.left,t.top)}),Tc(0,0))},Zl=function(n){var t=G(n,Jl);return Ql(t)},nd=function(n){var t=G(n,$l);return Ql(t)},td=Kl.screen,ed=Kl.absolute,od=function(n,t,e){var o=Wi(e.root).dom,r=function(t){var e=Li(t),o=Li(n.element);return ir(e,o)};return R.from(o.frameElement).map(to.fromDom).filter(r).map(Bc)},rd=function(n,t,e){var o=Li(n.element),r=Wc(o),i=od(n,t,e).getOr(r);return ed(i,r.left,r.top)},id=function(n,t,e,o){var r=n,i=t,u=e,a=o;n<0&&(r=0,u=e+n),t<0&&(i=0,a=o+t);var c=td(Tc(r,i));return R.some(ts(c,u,a))},ud=function(n,t,e,o,r){return n.map((function(n){var i=[t,n.point],u=ll(o,(function(){return nd(i)}),(function(){return nd(i)}),(function(){return Zl(i)})),a=es(u.left,u.top,n.width,n.height),c=e.showAbove?_f():Ef(),s=e.showAbove?Tf():Df(),f=Wl(r,e,c,s,c,s,R.none());return Pl({anchorBox:a,bubble:e.bubble.getOr(Vl()),overrides:e.overrides,layouts:f,placer:R.none()})}))},ad=function(n,t,e){var o=rd(n,e,t);return t.node.filter(Wa).bind((function(r){var i=r.dom.getBoundingClientRect(),u=id(i.left,i.top,i.width,i.height),a=t.node.getOr(n.element);return ud(u,o,t,e,a)}))},cd=[ye("node"),ye("root"),Be("bubble"),Ul(),He("overrides",{}),He("showAbove",!1),js("placement",ad)],sd="\ufeff",fd=" ",ld=function(n,t,e,o){return{start:n,soffset:t,finish:e,foffset:o}},dd={create:ld},md=Wn.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),gd=function(n,t,e,o){return n.fold(t,e,o)},pd=function(n){return n.fold(x,x,x)},vd=md.before,hd=md.on,bd=md.after,yd={before:vd,on:hd,after:bd,cata:gd,getStart:pd},xd=Wn.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),wd=function(n){return xd.exact(n.start,n.soffset,n.finish,n.foffset)},Sd=function(n){return n.match({domRange:function(n){return to.fromDom(n.startContainer)},relative:function(n,t){return yd.getStart(n)},exact:function(n,t,e,o){return n}})},kd=xd.domRange,Cd=xd.relative,Od=xd.exact,_d=function(n){var t=Sd(n);return Wi(t)},Td=dd.create,Ed={domRange:kd,relative:Cd,exact:Od,exactFromRange:wd,getWin:_d,range:Td},Dd=function(n,t){t.fold((function(t){n.setStartBefore(t.dom)}),(function(t,e){n.setStart(t.dom,e)}),(function(t){n.setStartAfter(t.dom)}))},Bd=function(n,t){t.fold((function(t){n.setEndBefore(t.dom)}),(function(t,e){n.setEnd(t.dom,e)}),(function(t){n.setEndAfter(t.dom)}))},Ad=function(n,t,e){var o=n.document.createRange();return Dd(o,t),Bd(o,e),o},Md=function(n,t,e,o,r){var i=n.document.createRange();return i.setStart(t.dom,e),i.setEnd(o.dom,r),i},Fd=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},Id=function(n){var t=n.getClientRects(),e=t.length>0?t[0]:n.getBoundingClientRect();return e.width>0||e.height>0?R.some(e).map(Fd):R.none()},Rd=Wn.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Vd=function(n,t,e){return t(to.fromDom(e.startContainer),e.startOffset,to.fromDom(e.endContainer),e.endOffset)},Pd=function(n,t){return t.match({domRange:function(n){return{ltr:y(n),rtl:R.none}},relative:function(t,e){return{ltr:$n((function(){return Ad(n,t,e)})),rtl:$n((function(){return R.some(Ad(n,e,t))}))}},exact:function(t,e,o,r){return{ltr:$n((function(){return Md(n,t,e,o,r)})),rtl:$n((function(){return R.some(Md(n,o,r,t,e))}))}}})},Hd=function(n,t){var e=t.ltr();if(e.collapsed){var o=t.rtl().filter((function(n){return!1===n.collapsed}));return o.map((function(n){return Rd.rtl(to.fromDom(n.endContainer),n.endOffset,to.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return Vd(n,Rd.ltr,e)}))}return Vd(n,Rd.ltr,e)},zd=function(n,t){var e=Pd(n,t);return Hd(n,e)},Nd=function(n,t){var e=zd(n,t);return e.match({ltr:function(t,e,o,r){var i=n.document.createRange();return i.setStart(t.dom,e),i.setEnd(o.dom,r),i},rtl:function(t,e,o,r){var i=n.document.createRange();return i.setStart(o.dom,r),i.setEnd(t.dom,e),i}})},Ld=(Rd.ltr,Rd.rtl,function(n,t){var e=function(e){if(!n(e))throw new Error("Can only get "+t+" value of a "+t+" node");return o(e).getOr("")},o=function(t){return n(t)?R.from(t.dom.nodeValue):R.none()},r=function(e,o){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node");e.dom.nodeValue=o};return{get:e,getOption:o,set:r}}),jd=Ld(Hi,"text"),Ud=function(n){return jd.get(n)},Wd=function(n){return jd.getOption(n)},Gd=function(n){return"img"===Ii(n)?1:Wd(n).fold((function(){return Ki(n).length}),(function(n){return n.length}))},Xd=function(n){return Wd(n).filter((function(n){return 0!==n.trim().length||n.indexOf(fd)>-1})).isSome()},Yd=["img","br"],qd=function(n){var t=Xd(n);return t||L(Yd,Ii(n))},Kd=function(n){return Jd(n,qd)},Jd=function(n,t){var e=function(n){for(var o=Ki(n),r=o.length-1;r>=0;r--){var i=o[r];if(t(i))return R.some(i);var u=e(i);if(u.isSome())return u}return R.none()};return e(n)},$d=function(n,t){return or(t,n)},Qd=function(n,t,e,o){var r=Li(n),i=r.dom.createRange();return i.setStart(n.dom,t),i.setEnd(e.dom,o),i},Zd=function(n,t,e,o){var r=Qd(n,t,e,o),i=ir(n,e)&&t===o;return r.collapsed&&!i},nm=function(n){return R.from(n.getSelection())},tm=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return R.some(dd.create(to.fromDom(t.startContainer),t.startOffset,to.fromDom(e.endContainer),e.endOffset))}return R.none()},em=function(n){if(null===n.anchorNode||null===n.focusNode)return tm(n);var t=to.fromDom(n.anchorNode),e=to.fromDom(n.focusNode);return Zd(t,n.anchorOffset,e,n.focusOffset)?R.some(dd.create(t,n.anchorOffset,e,n.focusOffset)):tm(n)},om=function(n){return nm(n).filter((function(n){return n.rangeCount>0})).bind(em)},rm=function(n,t){var e=Nd(n,t);return Id(e)},im=function(n,t){return{element:n,offset:t}},um=function(n,t){var e=Ki(n);if(0===e.length)return im(n,t);if(t<e.length)return im(e[t],0);var o=e[e.length-1],r=Hi(o)?Ud(o).length:Ki(o).length;return im(o,r)},am=function(n,t){return Hi(n)?im(n,t):um(n,t)},cm=function(n,t){var e=t.getSelection.getOrThunk((function(){return function(){return om(n)}}));return e().map((function(n){var t=am(n.start,n.soffset),e=am(n.finish,n.foffset);return Ed.range(t.element,t.offset,e.element,e.offset)}))},sm=function(n,t,e){var o=Wi(t.root).dom,r=rd(n,e,t),i=cm(o,t).bind((function(n){var t=rm(o,Ed.exactFromRange(n)).orThunk((function(){var t=to.fromText(sd);return cu(n.start,t),rm(o,Ed.exact(t,0,t,1)).map((function(n){return vu(t),n}))}));return t.bind((function(n){return id(n.left,n.top,n.width,n.height)}))})),u=cm(o,t).bind((function(n){return Pi(n.start)?R.some(n.start):Xi(n.start)})),a=u.getOr(n.element);return ud(i,r,t,e,a)},fm=[Be("getSelection"),ye("root"),Be("bubble"),Ul(),He("overrides",{}),He("showAbove",!1),js("placement",sm)],lm=function(n){return n.x+n.width},dm=function(n,t){return n.x-t.width},mm=function(n,t){return n.y-t.height+n.height},gm=function(n){return n.y},pm=function(n,t,e){return Gs(lm(n),gm(n),e.southeast(),Js(),uf(n,{left:0,top:2}),"link-layout-se")},vm=function(n,t,e){return Gs(dm(n,t),gm(n),e.southwest(),$s(),uf(n,{right:1,top:2}),"link-layout-sw")},hm=function(n,t,e){return Gs(lm(n),mm(n,t),e.northeast(),Qs(),uf(n,{left:0,bottom:3}),"link-layout-ne")},bm=function(n,t,e){return Gs(dm(n,t),mm(n,t),e.northwest(),Zs(),uf(n,{right:1,bottom:3}),"link-layout-nw")},ym=function(){return[pm,vm,hm,bm]},xm=function(){return[vm,pm,bm,hm]},wm=function(n,t,e){var o=cl(e,t.item.element),r=Wl(n.element,t,ym(),xm(),ym(),xm(),R.none());return R.some(Pl({anchorBox:o,bubble:Vl(),overrides:t.overrides,layouts:r,placer:R.none()}))},Sm=[ye("item"),Ul(),He("overrides",{}),js("placement",wm)],km=ce("anchor",{selection:fm,node:cd,hotspot:Xl,submenu:Sm,makeshift:ql}),Cm=function(){var n=document.documentElement;return ml(0,0,n.clientWidth,n.clientHeight)},Om=function(n){var t=Bc(n.element),e=n.element.dom.getBoundingClientRect();return dl(t.left,t.top,e.width,e.height)},_m=function(n,t,e,o,r){var i=pl(e.anchorBox,t);Ml(i,r.element,e.bubble,e.layouts,o,e.overrides)},Tm=function(n,t,e,o,r){Em(n,t,e,o,r,R.none())},Em=function(n,t,e,o,r,i){var u=i.map(rs);return Dm(n,t,e,o,r,u)},Dm=function(n,t,e,o,r,i){var u=ie("positioning anchor.info",km,o);el((function(){Ka(r.element,"position","fixed");var e=nc(r.element,"visibility");Ka(r.element,"visibility","hidden");var o=t.useFixed()?Cm():Om(n),a=u.placement,c=i.map(y).or(t.getBounds);a(n,u,o).each((function(t){var e=t.placer.getOr(_m);e(n,o,t,c,r)})),e.fold((function(){oc(r.element,"visibility")}),(function(n){Ka(r.element,"visibility",n)})),nc(r.element,"left").isNone()&&nc(r.element,"top").isNone()&&nc(r.element,"right").isNone()&&nc(r.element,"bottom").isNone()&&nc(r.element,"position").is("fixed")&&oc(r.element,"position")}),r.element)},Bm=function(n,t,e){return t.useFixed()?"fixed":"absolute"},Am=Object.freeze({__proto__:null,position:Tm,positionWithin:Em,positionWithinBounds:Dm,getMode:Bm}),Mm=[He("useFixed",C),Be("getBounds")],Fm=Uf({fields:Mm,name:"positioning",active:Kf,apis:Am}),Im=function(n){fi(n,ti());var t=n.components();X(t,Im)},Rm=function(n){var t=n.components();X(t,Rm),fi(n,ni())},Vm=function(n,t){lu(n.element,t.element)},Pm=function(n){X(n.components(),(function(n){return vu(n.element)})),pu(n.element),n.syncComponents()},Hm=function(n,t){var e=n.components();Pm(n);var o=un(e,t);X(o,(function(t){Im(t),n.getSystem().removeFromWorld(t)})),X(t,(function(t){t.getSystem().isConnected()?Vm(n,t):(n.getSystem().addToWorld(t),Vm(n,t),Wa(n.element)&&Rm(t)),n.syncComponents()}))},zm=function(n,t){Nm(n,t,lu)},Nm=function(n,t,e){n.getSystem().addToWorld(t),e(n.element,t.element),Wa(n.element)&&Rm(t),n.syncComponents()},Lm=function(n){Im(n),vu(n.element),n.getSystem().removeFromWorld(n)},jm=function(n){var t=Gi(n.element).bind((function(t){return n.getSystem().getByDom(t).toOptional()}));Lm(n),t.each((function(n){n.syncComponents()}))},Um=function(n){var t=n.components();X(t,Lm),pu(n.element),n.syncComponents()},Wm=function(n,t){Xm(n,t,lu)},Gm=function(n,t){Xm(n,t,su)},Xm=function(n,t,e){e(n,t.element);var o=Ki(t.element);X(o,(function(n){t.getByDom(n).each(Rm)}))},Ym=function(n){var t=Ki(n.element);X(t,(function(t){n.getByDom(t).each(Im)})),vu(n.element)},qm=function(n,t,e,o){e.get().each((function(t){Um(n)}));var r=t.getAttachPoint(n);zm(r,n);var i=n.getSystem().build(o);return zm(n,i),e.set(i),i},Km=function(n,t,e,o){var r=qm(n,t,e,o);return t.onOpen(n,r),r},Jm=function(n,t,e,o){return e.get().map((function(){return qm(n,t,e,o)}))},$m=function(n,t,e,o,r){rg(n,t),Km(n,t,e,o),r(),ug(n,t)},Qm=function(n,t,e){e.get().each((function(o){Um(n),jm(n),t.onClose(n,o),e.clear()}))},Zm=function(n,t,e){return e.isOpen()},ng=function(n,t,e,o){return Zm(n,t,e)&&e.get().exists((function(e){return t.isPartOf(n,e,o)}))},tg=function(n,t,e){return e.get()},eg=function(n,t,e,o){nc(n.element,t).fold((function(){Eu(n.element,e)}),(function(t){ku(n.element,e,t)})),Ka(n.element,t,o)},og=function(n,t,e){_u(n.element,e).fold((function(){return oc(n.element,t)}),(function(e){return Ka(n.element,t,e)}))},rg=function(n,t,e){var o=t.getAttachPoint(n);Ka(n.element,"position",Fm.getMode(o)),eg(n,"visibility",t.cloakVisibilityAttr,"hidden")},ig=function(n){return j(["top","left","right","bottom"],(function(t){return nc(n,t).isSome()}))},ug=function(n,t,e){ig(n.element)||oc(n.element,"position"),og(n,"visibility",t.cloakVisibilityAttr)},ag=Object.freeze({__proto__:null,cloak:rg,decloak:ug,open:Km,openWhileCloaked:$m,close:Qm,isOpen:Zm,isPartOf:ng,getState:tg,setContent:Jm}),cg=function(n,t){return vi([xi(Yr(),(function(e,o){Qm(e,n,t)}))])},sg=Object.freeze({__proto__:null,events:cg}),fg=[Hs("onOpen"),Hs("onClose"),ye("isPartOf"),ye("getAttachPoint"),He("cloakVisibilityAttr","data-precloak-visibility")],lg=function(){var n=Ke(R.none()),t=y("not-implemented"),e=function(){return n.get().isSome()},o=function(t){n.set(R.some(t))},r=function(){return n.get()},i=function(){n.set(R.none())};return ra({readState:t,isOpen:e,clear:i,set:o,get:r})},dg=Object.freeze({__proto__:null,init:lg}),mg=Uf({fields:fg,name:"sandboxing",active:sg,apis:ag,state:dg}),gg=y("dismiss.popups"),pg=y("reposition.popups"),vg=y("mouse.released"),hg=Ht([He("isExtraPart",C),Ve("fireEventInstead",[He("event",ei())])]),bg=function(n){var t,e=ie("Dismissal",hg,n);return t={},t[gg()]={schema:Ht([ye("target")]),onReceive:function(n,t){if(mg.isOpen(n)){var o=mg.isPartOf(n,t.target)||e.isExtraPart(n,t.target);o||e.fireEventInstead.fold((function(){return mg.close(n)}),(function(t){return fi(n,t.event)}))}}},t},yg=Ht([Ve("fireEventInstead",[He("event",oi())]),Oe("doReposition")]),xg=function(n){var t,e=ie("Reposition",yg,n);return t={},t[pg()]={onReceive:function(n){mg.isOpen(n)&&e.fireEventInstead.fold((function(){return e.doReposition(n)}),(function(t){return fi(n,t.event)}))}},t},wg=function(n,t,e){t.store.manager.onLoad(n,t,e)},Sg=function(n,t,e){t.store.manager.onUnload(n,t,e)},kg=function(n,t,e,o){t.store.manager.setValue(n,t,e,o)},Cg=function(n,t,e){return t.store.manager.getValue(n,t,e)},Og=function(n,t,e){return e},_g=Object.freeze({__proto__:null,onLoad:wg,onUnload:Sg,setValue:kg,getValue:Cg,getState:Og}),Tg=function(n,t){var e=n.resetOnDom?[Bi((function(e,o){wg(e,n,t)})),Ai((function(e,o){Sg(e,n,t)}))]:[Rf(n,t,wg)];return vi(e)},Eg=Object.freeze({__proto__:null,events:Tg}),Dg=function(){var n=Ke(null),t=function(){return{mode:"memory",value:n.get()}},e=function(){return null===n.get()},o=function(){n.set(null)};return ra({set:n.set,get:n.get,isNotSet:e,clear:o,readState:t})},Bg=function(){var n=p;return ra({readState:n})},Ag=function(){var n=Ke({}),t=Ke({}),e=function(){return{mode:"dataset",dataByValue:n.get(),dataByText:t.get()}},o=function(){n.set({}),t.set({})},r=function(e){return Nn(n.get(),e).orThunk((function(){return Nn(t.get(),e)}))},i=function(e){var o=n.get(),r=t.get(),i={},u={};X(e,(function(n){i[n.value]=n,Nn(n,"meta").each((function(t){Nn(t,"text").each((function(t){u[t]=n}))}))})),n.set(T(T({},o),i)),t.set(T(T({},r),u))};return ra({readState:e,lookup:r,update:i,clear:o})},Mg=function(n){return n.store.manager.state(n)},Fg=Object.freeze({__proto__:null,memory:Dg,dataset:Ag,manual:Bg,init:Mg}),Ig=function(n,t,e,o){var r=t.store;e.update([o]),r.setValue(n,o),t.onSetValue(n,o)},Rg=function(n,t,e){var o=t.store,r=o.getDataKey(n);return e.lookup(r).fold((function(){return o.getFallbackEntry(r)}),(function(n){return n}))},Vg=function(n,t,e){var o=t.store;o.initialValue.each((function(o){Ig(n,t,e,o)}))},Pg=function(n,t,e){e.clear()},Hg=[Be("initialValue"),ye("getFallbackEntry"),ye("getDataKey"),ye("setValue"),js("manager",{setValue:Ig,getValue:Rg,onLoad:Vg,onUnload:Pg,state:Ag})],zg=function(n,t,e){return t.store.getValue(n)},Ng=function(n,t,e,o){t.store.setValue(n,o),t.onSetValue(n,o)},Lg=function(n,t,e){t.store.initialValue.each((function(e){t.store.setValue(n,e)}))},jg=[ye("getValue"),He("setValue",p),Be("initialValue"),js("manager",{setValue:Ng,getValue:zg,onLoad:Lg,onUnload:p,state:oa.init})],Ug=function(n,t,e,o){e.set(o),t.onSetValue(n,o)},Wg=function(n,t,e){return e.get()},Gg=function(n,t,e){t.store.initialValue.each((function(n){e.isNotSet()&&e.set(n)}))},Xg=function(n,t,e){e.clear()},Yg=[Be("initialValue"),js("manager",{setValue:Ug,getValue:Wg,onLoad:Gg,onUnload:Xg,state:Dg})],qg=[ze("store",{mode:"memory"},ce("mode",{memory:Yg,manual:jg,dataset:Hg})),Hs("onSetValue"),He("resetOnDom",!1)],Kg=Uf({fields:qg,name:"representing",active:Eg,apis:_g,extra:{setValueFrom:function(n,t){var e=Kg.getValue(t);Kg.setValue(n,e)}},state:Fg}),Jg=function(n,t){return Ye(n,{},G(t,(function(t){return _e(t.name(),"Cannot configure "+t.name()+" for "+n)})).concat([qe("dump",x)]))},$g=function(n){return n.dump},Qg=function(n,t){return T(T({},n.dump),Lf(t))},Zg={field:Jg,augment:Qg,get:$g},np="placeholder",tp=Wn.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),ep=function(n){return Ln(n,"uiType")},op=function(n,t,e,o){return n.exists((function(n){return n!==e.owner}))?tp.single(!0,y(e)):Nn(o,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+Dn(o)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(n){return n.replace()}))},rp=function(n,t,e,o){return ep(e)&&e.uiType===np?op(n,t,e,o):tp.single(!1,y(e))},ip=function(n,t,e,o){var r=rp(n,t,e,o);return r.fold((function(r,i){var u=ep(e)?i(t,e.config,e.validated):i(t),a=Nn(u,"components").getOr([]),c=en(a,(function(e){return ip(n,t,e,o)}));return[T(T({},u),{components:c})]}),(function(n,o){if(ep(e)){var r=o(t,e.config,e.validated),i=e.validated.preprocess.getOr(x);return i(r)}return o(t)}))},up=function(n,t,e,o){return en(e,(function(e){return ip(n,t,e,o)}))},ap=function(n,t){var e=!1,o=function(){return e},r=function(){if(e)throw new Error("Trying to use the same placeholder more than once: "+n);return e=!0,t},i=function(){return t.fold((function(n,t){return n}),(function(n,t){return n}))};return{name:y(n),required:i,used:o,replace:r}},cp=function(n,t,e,o){var r=Mn(o,(function(n,t){return ap(t,n)})),i=up(n,t,e,r);return An(r,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),i},sp=tp.single,fp=tp.multiple,lp=y(np),dp=Wn.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),mp=He("factory",{sketch:x}),gp=He("schema",[]),pp=ye("name"),vp=Yt("pname","pname",ot((function(n){return"<alloy."+Pu(n.name)+">"})),fe()),hp=qe("schema",(function(){return[Be("preprocess")]})),bp=He("defaults",y({})),yp=He("overrides",y({})),xp=zt([mp,gp,pp,vp,bp,yp]),wp=zt([mp,gp,pp,bp,yp]),Sp=zt([mp,gp,pp,vp,bp,yp]),kp=zt([mp,hp,pp,ye("unit"),vp,bp,yp]),Cp=function(n){return n.fold(R.some,R.none,R.some,R.some)},Op=function(n){var t=function(n){return n.name};return n.fold(t,t,t,t)},_p=function(n){return n.fold(x,x,x,x)},Tp=function(n,t){return function(e){var o=ie("Converting part type",t,e);return n(o)}},Ep=Tp(dp.required,xp),Dp=Tp(dp.external,wp),Bp=Tp(dp.optional,Sp),Ap=Tp(dp.group,kp),Mp=y("entirety"),Fp=Object.freeze({__proto__:null,required:Ep,external:Dp,optional:Bp,group:Ap,asNamedPart:Cp,name:Op,asCommon:_p,original:Mp}),Ip=function(n,t,e,o){return Kn(t.defaults(n,e,o),e,{uid:n.partUids[t.name]},t.overrides(n,e,o))},Rp=function(n,t,e){var o={},r={};return X(e,(function(n){n.fold((function(n){o[n.pname]=sp(!0,(function(t,e,o){return n.factory.sketch(Ip(t,n,e,o))}))}),(function(n){var e=t.parts[n.name];r[n.name]=y(n.factory.sketch(Ip(t,n,e[Mp()]),e))}),(function(n){o[n.pname]=sp(!1,(function(t,e,o){return n.factory.sketch(Ip(t,n,e,o))}))}),(function(n){o[n.pname]=fp(!0,(function(t,e,o){var r=t[n.name];return G(r,(function(e){return n.factory.sketch(Kn(n.defaults(t,e,o),e,n.overrides(t,e)))}))}))}))})),{internals:y(o),externals:y(r)}},Vp=function(n,t){var e={};return X(t,(function(t){Cp(t).each((function(t){var o=Pp(n,t.pname);e[t.name]=function(e){var r=ie("Part: "+t.name+" in "+n,zt(t.schema),e);return T(T({},o),{config:e,validated:r})}}))})),e},Pp=function(n,t){return{uiType:lp(),owner:n,name:t}},Hp=function(n,t,e){return{uiType:lp(),owner:n,name:t,config:e,validated:{}}},zp=function(n){return en(n,(function(n){return n.fold(R.none,R.some,R.none,R.none).map((function(n){return Te(n.name,n.schema.concat([Us(Mp())]))})).toArray()}))},Np=function(n){return G(n,Op)},Lp=function(n,t,e){return Rp(n,t,e)},jp=function(n,t,e){return cp(R.some(n),t,t.components,e)},Up=function(n,t,e){var o=t.partUids[e];return n.getSystem().getByUid(o).toOptional()},Wp=function(n,t,e){return Up(n,t,e).getOrDie("Could not find part: "+e)},Gp=function(n,t,e){var o={},r=t.partUids,i=n.getSystem();return X(e,(function(n){o[n]=y(i.getByUid(r[n]))})),o},Xp=function(n,t){var e=n.getSystem();return Mn(t.partUids,(function(n,t){return y(e.getByUid(n))}))},Yp=function(n){return Dn(n.partUids)},qp=function(n,t,e){var o={},r=t.partUids,i=n.getSystem();return X(e,(function(n){o[n]=y(i.getByUid(r[n]).getOrDie())})),o},Kp=function(n,t){var e=Np(t);return lt(G(e,(function(t){return{key:t,value:n+"-"+t}})))},Jp=function(n){return Yt("partUids","partUids",rt((function(t){return Kp(t.uid,n)})),fe())},$p=Object.freeze({__proto__:null,generate:Vp,generateOne:Hp,schemas:zp,names:Np,substitutes:Lp,components:jp,defaultUids:Kp,defaultUidsSchema:Jp,getAllParts:Xp,getAllPartNames:Yp,getPart:Up,getPartOrDie:Wp,getParts:Gp,getPartsOrDie:qp}),Qp=function(n,t){var e=n.length>0?[Te("parts",n)]:[];return e.concat([ye("uid"),He("dom",{}),He("components",[]),Us("originalSpec"),He("debug.sketcher",{})]).concat(t)},Zp=function(n,t,e,o,r){var i=Qp(o,r);return ie(n+" [SpecSchema]",Ht(i.concat(t)),e)},nv=function(n,t,e,o){var r=ov(o),i=Zp(n,t,r,[],[]);return e(i,r)},tv=function(n,t,e,o,r){var i=ov(r),u=zp(e),a=Jp(e),c=Zp(n,t,i,u,[a]),s=Lp(n,c,e),f=jp(n,c,s.internals());return o(c,f,i,s.externals())},ev=function(n){return Ln(n,"uid")},ov=function(n){return ev(n)?n:T(T({},n),{uid:Gu("uid")})},rv=function(n){return void 0!==n.uid},iv=Ht([ye("name"),ye("factory"),ye("configFields"),He("apis",{}),He("extraApis",{})]),uv=Ht([ye("name"),ye("factory"),ye("configFields"),ye("partFields"),He("apis",{}),He("extraApis",{})]),av=function(n){var t=ie("Sketcher for "+n.name,iv,n),e=function(n){return nv(t.name,t.configFields,t.factory,n)},o=Mn(t.apis,ea),r=Mn(t.extraApis,(function(n,t){return $u(n,t)}));return T(T({name:t.name,configFields:t.configFields,sketch:e},o),r)},cv=function(n){var t=ie("Sketcher for "+n.name,uv,n),e=function(n){return tv(t.name,t.configFields,t.partFields,t.factory,n)},o=Vp(t.name,t.partFields),r=Mn(t.apis,ea),i=Mn(t.extraApis,(function(n,t){return $u(n,t)}));return T(T({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:e,parts:o},r),i)},sv=function(n){for(var t=[],e=function(n){t.push(n)},o=0;o<n.length;o++)n[o].each(e);return t},fv=function(n){for(var t=[],e=0;e<n.length;e++){var o=n[e];if(!o.isSome())return R.none();t.push(o.getOrDie())}return R.some(t)},lv=function(n,t,e){return n.isSome()&&t.isSome()?R.some(e(n.getOrDie(),t.getOrDie())):R.none()},dv=function(n,t,e,o){return n.isSome()&&t.isSome()&&e.isSome()?R.some(o(n.getOrDie(),t.getOrDie(),e.getOrDie())):R.none()},mv=function(n,t){return void 0!==n&&null!==n?R.some(t(n)):R.none()},gv=function(n,t){return n?R.some(t):R.none()},pv=function(n){return"input"===Ii(n)&&"radio"!==Ou(n,"type")||"textarea"===Ii(n)},vv=function(n,t,e){return t.find(n)},hv=Object.freeze({__proto__:null,getCurrent:vv}),bv=[ye("find")],yv=Uf({fields:bv,name:"composing",apis:hv}),xv=function(n,t,e,o){var r=$d(n.element,"."+t.highlightClass);X(r,(function(e){j(o,(function(n){return n.element===e}))||(za(e,t.highlightClass),n.getSystem().getByDom(e).each((function(e){t.onDehighlight(n,e),fi(e,si())})))}))},wv=function(n,t,e){return xv(n,t,e,[])},Sv=function(n,t,e,o){Ev(n,t,e,o)&&(za(o.element,t.highlightClass),t.onDehighlight(n,o),fi(o,si()))},kv=function(n,t,e,o){xv(n,t,e,[o]),Ev(n,t,e,o)||(Pa(o.element,t.highlightClass),t.onHighlight(n,o),fi(o,ci()))},Cv=function(n,t,e){Av(n,t).each((function(o){kv(n,t,e,o)}))},Ov=function(n,t,e){Mv(n,t).each((function(o){kv(n,t,e,o)}))},_v=function(n,t,e,o){Bv(n,t,e,o).fold((function(n){throw n}),(function(o){kv(n,t,e,o)}))},Tv=function(n,t,e,o){var r=Vv(n,t),i=Z(r,o);i.each((function(o){kv(n,t,e,o)}))},Ev=function(n,t,e,o){return Na(o.element,t.highlightClass)},Dv=function(n,t,e){return gs(n.element,"."+t.highlightClass).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Bv=function(n,t,e,o){var r=$d(n.element,"."+t.itemClass);return R.from(r[o]).fold((function(){return hn.error(new Error("No element found with index "+o))}),n.getSystem().getByDom)},Av=function(n,t,e){return gs(n.element,"."+t.itemClass).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Mv=function(n,t,e){var o=$d(n.element,"."+t.itemClass),r=o.length>0?R.some(o[o.length-1]):R.none();return r.bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Fv=function(n,t,e,o){var r=$d(n.element,"."+t.itemClass),i=nn(r,(function(n){return Na(n,t.highlightClass)}));return i.bind((function(t){var e=vl(t,o,0,r.length-1);return n.getSystem().getByDom(r[e]).toOptional()}))},Iv=function(n,t,e){return Fv(n,t,e,-1)},Rv=function(n,t,e){return Fv(n,t,e,1)},Vv=function(n,t,e){var o=$d(n.element,"."+t.itemClass);return sv(G(o,(function(t){return n.getSystem().getByDom(t).toOptional()})))},Pv=Object.freeze({__proto__:null,dehighlightAll:wv,dehighlight:Sv,highlight:kv,highlightFirst:Cv,highlightLast:Ov,highlightAt:_v,highlightBy:Tv,isHighlighted:Ev,getHighlighted:Dv,getFirst:Av,getLast:Mv,getPrevious:Iv,getNext:Rv,getCandidates:Vv}),Hv=[ye("highlightClass"),ye("itemClass"),Hs("onHighlight"),Hs("onDehighlight")],zv=Uf({fields:Hv,name:"highlighting",apis:Pv}),Nv=[8],Lv=[9],jv=[13],Uv=[27],Wv=[32],Gv=[37],Xv=[38],Yv=[39],qv=[40],Kv=function(n,t,e){var o=rn(n.slice(0,t)),r=rn(n.slice(t+1));return Z(o.concat(r),e)},Jv=function(n,t,e){var o=rn(n.slice(0,t));return Z(o,e)},$v=function(n,t,e){var o=n.slice(0,t),r=n.slice(t+1);return Z(r.concat(o),e)},Qv=function(n,t,e){var o=n.slice(t+1);return Z(o,e)},Zv=function(n){return function(t){var e=t.raw;return L(n,e.which)}},nh=function(n){return function(t){return on(n,(function(n){return n(t)}))}},th=function(n){var t=n.raw;return!0===t.shiftKey},eh=function(n){var t=n.raw;return!0===t.ctrlKey},oh=S(th),rh=function(n,t){return{matches:n,classification:t}},ih=function(n,t){var e=Z(n,(function(n){return n.matches(t)}));return e.map((function(n){return n.classification}))},uh=function(n,t,e){var o=t.exists((function(n){return e.exists((function(t){return ir(t,n)}))}));o||li(n,ri(),{prevFocus:t,newFocus:e})},ah=function(){var n=function(n){return tl(n.element)},t=function(t,e){var o=n(t);t.getSystem().triggerFocus(e,t.element);var r=n(t);uh(t,o,r)};return{get:n,set:t}},ch=function(){var n=function(n){return zv.getHighlighted(n).map((function(n){return n.element}))},t=function(t,e){var o=n(t);t.getSystem().getByDom(e).fold(p,(function(n){zv.highlight(t,n)}));var r=n(t);uh(t,o,r)};return{get:n,set:t}};(function(n){n["OnFocusMode"]="onFocus",n["OnEnterOrSpaceMode"]="onEnterOrSpace",n["OnApiMode"]="onApi"})(Nl||(Nl={}));var sh=function(n,t,e,o,r){var i=function(){return n.concat([He("focusManager",ah()),ze("focusInside","onFocus",ne((function(n){return L(["onFocus","onEnterOrSpace","onApi"],n)?hn.value(n):hn.error("Invalid value for focusInside")}))),js("handler",c),js("state",t),js("sendFocusIn",r)])},u=function(n,t,e,o,r){var i=e(n,t,o,r);return ih(i,t.event).bind((function(e){return e(n,t,o,r)}))},a=function(n,t){var i=n.focusInside!==Nl.OnFocusMode?R.none():r(n).map((function(e){return xi(zr(),(function(o,r){e(o,n,t),r.stop()}))})),a=function(e,o){var i=Zv(Wv.concat(jv))(o.event);n.focusInside===Nl.OnEnterOrSpaceMode&&i&&dr(e,o)&&r(n).each((function(r){r(e,n,t),o.stop()}))},c=[xi(Br(),(function(o,r){u(o,r,e,n,t).fold((function(){a(o,r)}),(function(n){r.stop()}))})),xi(Ar(),(function(e,r){u(e,r,o,n,t).each((function(n){r.stop()}))}))];return vi(i.toArray().concat(c))},c={schema:i,processKey:u,toEvents:a};return c},fh=function(n){var t=[Be("onEscape"),Be("onEnter"),He("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),He("firstTabstop",0),He("useTabstopAt",O),Be("visibilitySelector")].concat([n]),e=function(n,t){var e=n.visibilitySelector.bind((function(n){return ps(t,n)})).getOr(t);return kc(e)>0},o=function(n,t){var o=$d(n.element,t.selector),r=K(o,(function(n){return e(t,n)}));return R.from(r[t.firstTabstop])},r=function(n,t){return t.focusManager.get(n).bind((function(n){return ps(n,t.selector)}))},i=function(n,t){return e(n,t)&&n.useTabstopAt(t)},u=function(n,t,e){o(n,t).each((function(e){t.focusManager.set(n,e)}))},a=function(n,t,e,o,r){return r(t,e,(function(n){return i(o,n)})).fold((function(){return o.cyclic?R.some(!0):R.none()}),(function(t){return o.focusManager.set(n,t),R.some(!0)}))},c=function(n,t,e,o){var i=$d(n.element,e.selector);return r(n,e).bind((function(t){var r=nn(i,w(ir,t));return r.bind((function(t){return a(n,i,t,e,o)}))}))},s=function(n,t,e){var o=e.cyclic?Kv:Jv;return c(n,t,e,o)},f=function(n,t,e){var o=e.cyclic?$v:Qv;return c(n,t,e,o)},l=function(n,t,e){return e.onEnter.bind((function(e){return e(n,t)}))},d=function(n,t,e){return e.onEscape.bind((function(e){return e(n,t)}))},m=y([rh(nh([th,Zv(Lv)]),s),rh(Zv(Lv),f),rh(Zv(Uv),d),rh(nh([oh,Zv(jv)]),l)]),g=y([]);return sh(t,oa.init,m,g,(function(){return R.some(u)}))},lh=fh(qe("cyclic",C)),dh=fh(qe("cyclic",O)),mh=function(n,t,e){return mi(n,e,Ur()),R.some(!0)},gh=function(n,t,e){var o=pv(e)&&Zv(Wv)(t.event);return o?R.none():mh(n,t,e)},ph=function(n,t){return R.some(!0)},vh=[He("execute",gh),He("useSpace",!1),He("useEnter",!0),He("useControlEnter",!1),He("useDown",!1)],hh=function(n,t,e){return e.execute(n,t,n.element)},bh=function(n,t,e,o){var r=e.useSpace&&!pv(n.element)?Wv:[],i=e.useEnter?jv:[],u=e.useDown?qv:[],a=r.concat(i).concat(u);return[rh(Zv(a),hh)].concat(e.useControlEnter?[rh(nh([eh,Zv(jv)]),hh)]:[])},yh=function(n,t,e,o){return e.useSpace&&!pv(n.element)?[rh(Zv(Wv),ph)]:[]},xh=sh(vh,oa.init,bh,yh,(function(){return R.none()})),wh=function(){var n=Ke(R.none()),t=function(t,e){n.set(R.some({numRows:t,numColumns:e}))},e=function(){return n.get().map((function(n){return n.numRows}))},o=function(){return n.get().map((function(n){return n.numColumns}))};return ra({readState:function(){return n.get().map((function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:t,getNumRows:e,getNumColumns:o})},Sh=function(n){return n.state(n)},kh=Object.freeze({__proto__:null,flatgrid:wh,init:Sh}),Ch=function(n){return function(t,e,o,r){var i=n(t.element);return Eh(i,t,e,o,r)}},Oh=function(n,t){var e=Hl(n,t);return Ch(e)},_h=function(n,t){var e=Hl(t,n);return Ch(e)},Th=function(n){return function(t,e,o,r){return Eh(n,t,e,o,r)}},Eh=function(n,t,e,o,r){var i=o.focusManager.get(t).bind((function(e){return n(t.element,e,o,r)}));return i.map((function(n){return o.focusManager.set(t,n),!0}))},Dh=Th,Bh=Th,Ah=Th,Mh=function(n){return n.offsetWidth<=0&&n.offsetHeight<=0},Fh=function(n){return!Mh(n.dom)},Ih=function(n,t){return nn(n,t).map((function(t){return{index:t,candidates:n}}))},Rh=function(n,t,e){var o=function(n){return ir(n,t)},r=$d(n,e),i=K(r,Fh);return Ih(i,o)},Vh=function(n,t){return nn(n,(function(n){return ir(t,n)}))},Ph=function(n,t,e,o){var r=Math.floor(t/e),i=t%e;return o(r,i).bind((function(t){var o=t.row*e+t.column;return o>=0&&o<n.length?R.some(n[o]):R.none()}))},Hh=function(n,t,e,o,r){return Ph(n,t,o,(function(t,i){var u=t===e-1,a=u?n.length-t*o:o,c=vl(i,r,0,a-1);return R.some({row:t,column:c})}))},zh=function(n,t,e,o,r){return Ph(n,t,o,(function(t,i){var u=vl(t,r,0,e-1),a=u===e-1,c=a?n.length-u*o:o,s=hl(i,0,c-1);return R.some({row:u,column:s})}))},Nh=function(n,t,e,o){return Hh(n,t,e,o,1)},Lh=function(n,t,e,o){return Hh(n,t,e,o,-1)},jh=function(n,t,e,o){return zh(n,t,e,o,-1)},Uh=function(n,t,e,o){return zh(n,t,e,o,1)},Wh=[ye("selector"),He("execute",gh),zs("onEscape"),He("captureTab",!1),Ws()],Gh=function(n,t,e){gs(n.element,t.selector).each((function(e){t.focusManager.set(n,e)}))},Xh=function(n,t){return t.focusManager.get(n).bind((function(n){return ps(n,t.selector)}))},Yh=function(n,t,e,o){return Xh(n,e).bind((function(o){return e.execute(n,t,o)}))},qh=function(n){return function(t,e,o,r){return Rh(t,e,o.selector).bind((function(t){return n(t.candidates,t.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},Kh=function(n,t,e){return e.captureTab?R.some(!0):R.none()},Jh=function(n,t,e){return e.onEscape(n,t)},$h=qh(Lh),Qh=qh(Nh),Zh=qh(jh),nb=qh(Uh),tb=y([rh(Zv(Gv),Oh($h,Qh)),rh(Zv(Yv),_h($h,Qh)),rh(Zv(Xv),Dh(Zh)),rh(Zv(qv),Bh(nb)),rh(nh([th,Zv(Lv)]),Kh),rh(nh([oh,Zv(Lv)]),Kh),rh(Zv(Uv),Jh),rh(Zv(Wv.concat(jv)),Yh)]),eb=y([rh(Zv(Wv),ph)]),ob=sh(Wh,wh,tb,eb,(function(){return R.some(Gh)})),rb=function(n,t,e,o){var r=function(n){return"button"===Ii(n)&&"disabled"===Ou(n,"disabled")},i=function(n,t,e){var u=vl(t,o,0,e.length-1);return u===n?R.none():r(e[u])?i(n,u,e):R.from(e[u])};return Rh(n,e,t).bind((function(n){var t=n.index,e=n.candidates;return i(t,t,e)}))},ib=[ye("selector"),He("getInitial",R.none),He("execute",gh),zs("onEscape"),He("executeOnMove",!1),He("allowVertical",!0)],ub=function(n,t){return t.focusManager.get(n).bind((function(n){return ps(n,t.selector)}))},ab=function(n,t,e){return ub(n,e).bind((function(o){return e.execute(n,t,o)}))},cb=function(n,t,e){t.getInitial(n).orThunk((function(){return gs(n.element,t.selector)})).each((function(e){t.focusManager.set(n,e)}))},sb=function(n,t,e){return rb(n,e.selector,t,-1)},fb=function(n,t,e){return rb(n,e.selector,t,1)},lb=function(n){return function(t,e,o,r){return n(t,e,o,r).bind((function(){return o.executeOnMove?ab(t,e,o):R.some(!0)}))}},db=function(n,t,e){return e.onEscape(n,t)},mb=function(n,t,e,o){var r=Gv.concat(e.allowVertical?Xv:[]),i=Yv.concat(e.allowVertical?qv:[]);return[rh(Zv(r),lb(Oh(sb,fb))),rh(Zv(i),lb(_h(sb,fb))),rh(Zv(jv),ab),rh(Zv(Wv),ab),rh(Zv(Uv),db)]},gb=y([rh(Zv(Wv),ph)]),pb=sh(ib,oa.init,mb,gb,(function(){return R.some(cb)})),vb=function(n,t,e){return R.from(n[t]).bind((function(n){return R.from(n[e]).map((function(n){return{rowIndex:t,columnIndex:e,cell:n}}))}))},hb=function(n,t,e,o){var r=n[t],i=r.length,u=vl(e,o,0,i-1);return vb(n,t,u)},bb=function(n,t,e,o){var r=vl(e,o,0,n.length-1),i=n[r].length,u=hl(t,0,i-1);return vb(n,r,u)},yb=function(n,t,e,o){var r=n[t],i=r.length,u=hl(e+o,0,i-1);return vb(n,t,u)},xb=function(n,t,e,o){var r=hl(e+o,0,n.length-1),i=n[r].length,u=hl(t,0,i-1);return vb(n,r,u)},wb=function(n,t,e){return hb(n,t,e,1)},Sb=function(n,t,e){return hb(n,t,e,-1)},kb=function(n,t,e){return bb(n,e,t,-1)},Cb=function(n,t,e){return bb(n,e,t,1)},Ob=function(n,t,e){return yb(n,t,e,-1)},_b=function(n,t,e){return yb(n,t,e,1)},Tb=function(n,t,e){return xb(n,e,t,-1)},Eb=function(n,t,e){return xb(n,e,t,1)},Db=[Te("selectors",[ye("row"),ye("cell")]),He("cycles",!0),He("previousSelector",R.none),He("execute",gh)],Bb=function(n,t,e){var o=t.previousSelector(n).orThunk((function(){var e=t.selectors;return gs(n.element,e.cell)}));o.each((function(e){t.focusManager.set(n,e)}))},Ab=function(n,t,e){return tl(n.element).bind((function(o){return e.execute(n,t,o)}))},Mb=function(n,t){return G(n,(function(n){return $d(n,t.selectors.cell)}))},Fb=function(n,t){return function(e,o,r){var i=r.cycles?n:t;return ps(o,r.selectors.row).bind((function(n){var t=$d(n,r.selectors.cell);return Vh(t,o).bind((function(t){var o=$d(e,r.selectors.row);return Vh(o,n).bind((function(n){var e=Mb(o,r);return i(e,n,t).map((function(n){return n.cell}))}))}))}))}},Ib=Fb(Sb,Ob),Rb=Fb(wb,_b),Vb=Fb(kb,Tb),Pb=Fb(Cb,Eb),Hb=y([rh(Zv(Gv),Oh(Ib,Rb)),rh(Zv(Yv),_h(Ib,Rb)),rh(Zv(Xv),Dh(Vb)),rh(Zv(qv),Bh(Pb)),rh(Zv(Wv.concat(jv)),Ab)]),zb=y([rh(Zv(Wv),ph)]),Nb=sh(Db,oa.init,Hb,zb,(function(){return R.some(Bb)})),Lb=[ye("selector"),He("execute",gh),He("moveOnTab",!1)],jb=function(n,t,e){return e.focusManager.get(n).bind((function(o){return e.execute(n,t,o)}))},Ub=function(n,t,e){gs(n.element,t.selector).each((function(e){t.focusManager.set(n,e)}))},Wb=function(n,t,e){return rb(n,e.selector,t,-1)},Gb=function(n,t,e){return rb(n,e.selector,t,1)},Xb=function(n,t,e,o){return e.moveOnTab?Ah(Wb)(n,t,e,o):R.none()},Yb=function(n,t,e,o){return e.moveOnTab?Ah(Gb)(n,t,e,o):R.none()},qb=y([rh(Zv(Xv),Ah(Wb)),rh(Zv(qv),Ah(Gb)),rh(nh([th,Zv(Lv)]),Xb),rh(nh([oh,Zv(Lv)]),Yb),rh(Zv(jv),jb),rh(Zv(Wv),jb)]),Kb=y([rh(Zv(Wv),ph)]),Jb=sh(Lb,oa.init,qb,Kb,(function(){return R.some(Ub)})),$b=[zs("onSpace"),zs("onEnter"),zs("onShiftEnter"),zs("onLeft"),zs("onRight"),zs("onTab"),zs("onShiftTab"),zs("onUp"),zs("onDown"),zs("onEscape"),He("stopSpaceKeyup",!1),Be("focusIn")],Qb=function(n,t,e){return[rh(Zv(Wv),e.onSpace),rh(nh([oh,Zv(jv)]),e.onEnter),rh(nh([th,Zv(jv)]),e.onShiftEnter),rh(nh([th,Zv(Lv)]),e.onShiftTab),rh(nh([oh,Zv(Lv)]),e.onTab),rh(Zv(Xv),e.onUp),rh(Zv(qv),e.onDown),rh(Zv(Gv),e.onLeft),rh(Zv(Yv),e.onRight),rh(Zv(Wv),e.onSpace),rh(Zv(Uv),e.onEscape)]},Zb=function(n,t,e){return e.stopSpaceKeyup?[rh(Zv(Wv),ph)]:[]},ny=sh($b,oa.init,Qb,Zb,(function(n){return n.focusIn})),ty=lh.schema(),ey=dh.schema(),oy=pb.schema(),ry=ob.schema(),iy=Nb.schema(),uy=xh.schema(),ay=Jb.schema(),cy=ny.schema(),sy=Object.freeze({__proto__:null,acyclic:ty,cyclic:ey,flow:oy,flatgrid:ry,matrix:iy,execution:uy,menu:ay,special:cy}),fy=function(n){return jn(n,"setGridSize")},ly=Gf({branchKey:"mode",branches:sy,name:"keying",active:{events:function(n,t){var e=n.handler;return e.toEvents(n,t)}},apis:{focusIn:function(n,t,e){t.sendFocusIn(t).fold((function(){n.getSystem().triggerFocus(n.element,n.element)}),(function(o){o(n,t,e)}))},setGridSize:function(n,t,e,o,r){fy(e)&&e.setGridSize(o,r)}},state:kh}),dy=function(n,t,e,o){el((function(){var t=G(o,n.getSystem().build);Hm(n,t)}),n.element)},my=function(n,t,e,o){var r=n.getSystem().build(o);Nm(n,r,e)},gy=function(n,t,e,o){my(n,t,lu,o)},py=function(n,t,e,o){my(n,t,fu,o)},vy=function(n,t,e,o){var r=hy(n),i=Z(r,(function(n){return ir(o.element,n.element)}));i.each(jm)},hy=function(n,t){return n.components()},by=function(n,t,e,o,r){var i=hy(n);return R.from(i[o]).map((function(i){return vy(n,t,e,i),r.each((function(e){my(n,t,(function(n,t){du(n,t,o)}),e)})),i}))},yy=function(n,t,e,o,r){var i=hy(n);return nn(i,o).bind((function(o){return by(n,t,e,o,r)}))},xy=Object.freeze({__proto__:null,append:gy,prepend:py,remove:vy,replaceAt:by,replaceBy:yy,set:dy,contents:hy}),wy=Uf({fields:[],name:"replacing",apis:xy}),Sy=function(n,t){var e=vi(t);return Uf({fields:[ye("enabled")],name:n,active:{events:y(e)}})},ky=function(n,t){var e=Sy(n,t);return{key:n,value:{config:{},me:e,configAsRaw:y({}),initialConfig:{},state:oa}}},Cy=function(n,t){t.ignore||($f(n.element),t.onFocus(n))},Oy=function(n,t){t.ignore||Qf(n.element)},_y=function(n){return Zf(n.element)},Ty=Object.freeze({__proto__:null,focus:Cy,blur:Oy,isFocused:_y}),Ey=function(n,t){var e=t.ignore?{}:{attributes:{tabindex:"-1"}};return sa(e)},Dy=function(n){return vi([xi(zr(),(function(t,e){Cy(t,n),e.stop()}))].concat(n.stopMousedown?[xi(kr(),(function(n,t){t.event.prevent()}))]:[]))},By=Object.freeze({__proto__:null,exhibit:Ey,events:Dy}),Ay=[Hs("onFocus"),He("stopMousedown",!1),He("ignore",!1)],My=Uf({fields:Ay,name:"focusing",active:By,apis:Ty}),Fy=function(n){var t=function(){var t=Ke(n),e=function(){return t.get()},o=function(n){return t.set(n)},r=function(){return t.set(n)},i=function(){return t.get()};return{get:e,set:o,clear:r,readState:i}};return{init:t}},Iy=function(n,t,e){var o=t.aria;o.update(n,o,e.get())},Ry=function(n,t,e){t.toggleClass.each((function(t){e.get()?Pa(n.element,t):za(n.element,t)}))},Vy=function(n,t,e){zy(n,t,e,!e.get())},Py=function(n,t,e){e.set(!0),Ry(n,t,e),Iy(n,t,e)},Hy=function(n,t,e){e.set(!1),Ry(n,t,e),Iy(n,t,e)},zy=function(n,t,e,o){var r=o?Py:Hy;r(n,t,e)},Ny=function(n,t,e){return e.get()},Ly=function(n,t,e){zy(n,t,e,t.selected)},jy=Object.freeze({__proto__:null,onLoad:Ly,toggle:Vy,isOn:Ny,on:Py,off:Hy,set:zy}),Uy=function(){return sa({})},Wy=function(n,t){var e=If(n,t,Vy),o=Rf(n,t,Ly);return vi(tn([n.toggleOnExecute?[e]:[],[o]]))},Gy=Object.freeze({__proto__:null,exhibit:Uy,events:Wy}),Xy=function(n,t,e){ku(n.element,"aria-pressed",e),t.syncWithExpanded&&Ky(n,t,e)},Yy=function(n,t,e){ku(n.element,"aria-selected",e)},qy=function(n,t,e){ku(n.element,"aria-checked",e)},Ky=function(n,t,e){ku(n.element,"aria-expanded",e)},Jy=[He("selected",!1),Be("toggleClass"),He("toggleOnExecute",!0),ze("aria",{mode:"none"},ce("mode",{pressed:[He("syncWithExpanded",!1),js("update",Xy)],checked:[js("update",qy)],expanded:[js("update",Ky)],selected:[js("update",Yy)],none:[js("update",p)]}))],$y=Uf({fields:Jy,name:"toggling",active:Gy,apis:jy,state:Fy(!1)}),Qy=function(){var n=function(n,t){t.stop(),di(n)};return[xi(Ir(),n),xi(Gr(),n),Ti(yr()),Ti(kr())]},Zy=function(n){var t=function(n){return Fi((function(t,e){n(t),e.stop()}))};return vi(tn([n.map(t).toArray(),Qy()]))},nx="alloy.item-hover",tx="alloy.item-focus",ex=function(n){(tl(n.element).isNone()||My.isFocused(n))&&(My.isFocused(n)||My.focus(n),li(n,nx,{item:n}))},ox=function(n){li(n,tx,{item:n})},rx=y(nx),ix=y(tx),ux=function(n){return{dom:n.dom,domModification:T(T({},n.domModification),{attributes:T(T(T({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Zg.augment(n.itemBehaviours,[n.toggling.fold($y.revoke,(function(n){return $y.config(T({aria:{mode:"checked"}},n))})),My.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){ox(n)}}),ly.config({mode:"execution"}),Kg.config({store:{mode:"memory",initialValue:n.data}}),ky("item-type-events",D(Qy(),[xi(Tr(),ex),xi(Wr(),My.focus)]))]),components:n.components,eventOrder:n.eventOrder}},ax=[ye("data"),ye("components"),ye("dom"),He("hasSubmenu",!1),Be("toggling"),Zg.field("itemBehaviours",[$y,My,ly,Kg]),He("ignoreFocus",!1),He("domModification",{}),js("builder",ux),He("eventOrder",{})],cx=function(n){return{dom:n.dom,components:n.components,events:vi([Ei(Wr())])}},sx=[ye("dom"),ye("components"),js("builder",cx)],fx=y("item-widget"),lx=y([Ep({name:"widget",overrides:function(n){return{behaviours:Lf([Kg.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:p}})])}}})]),dx=function(n){var t=Lp(fx(),n,lx()),e=jp(fx(),n,t.internals()),o=function(t){return Up(t,n,"widget").map((function(n){return ly.focusIn(n),n}))},r=function(t,e){return pv(e.event.target)?R.none():function(){return n.autofocus?(e.setSource(t.element),R.none()):R.none()}()};return{dom:n.dom,components:e,domModification:n.domModification,events:vi([Fi((function(n,t){o(n).each((function(n){t.stop()}))})),xi(Tr(),ex),xi(Wr(),(function(t,e){n.autofocus?o(t):My.focus(t)}))]),behaviours:Zg.augment(n.widgetBehaviours,[Kg.config({store:{mode:"memory",initialValue:n.data}}),My.config({ignore:n.ignoreFocus,onFocus:function(n){ox(n)}}),ly.config({mode:"special",focusIn:n.autofocus?function(n){o(n)}:Xf(),onLeft:r,onRight:r,onEscape:function(t,e){return My.isFocused(t)||n.autofocus?n.autofocus?(e.setSource(t.element),R.none()):R.none():(My.focus(t),R.some(!0))}})])}},mx=[ye("uid"),ye("data"),ye("components"),ye("dom"),He("autofocus",!1),He("ignoreFocus",!1),Zg.field("widgetBehaviours",[Kg,My,ly]),He("domModification",{}),Jp(lx()),js("builder",dx)],gx=ce("type",{widget:mx,item:ax,separator:sx}),px=function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:n.focusManager}},vx=function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}},hx=function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusManager:n.focusManager}},bx=y([Ap({factory:{sketch:function(n){var t=ie("menu.spec item",gx,n);return t.builder(t)}},name:"items",unit:"item",defaults:function(n,t){return t.hasOwnProperty("uid")?t:T(T({},t),{uid:Gu("item")})},overrides:function(n,t){return{type:t.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),yx=y([ye("value"),ye("items"),ye("dom"),ye("components"),He("eventOrder",{}),Jg("menuBehaviours",[zv,Kg,yv,ly]),ze("movement",{mode:"menu",moveOnTab:!0},ce("mode",{grid:[Ws(),js("config",px)],matrix:[js("config",vx),ye("rowSelector")],menu:[He("moveOnTab",!0),js("config",hx)]})),Is(),He("fakeFocus",!1),He("focusManager",ah()),Hs("onHighlight")]),xx=y("alloy.menu-focus"),wx=function(n,t,e,o){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Qg(n.menuBehaviours,[zv.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Kg.config({store:{mode:"memory",initialValue:n.value}}),yv.config({find:R.some}),ly.config(n.movement.config(n,n.movement))]),events:vi([xi(ix(),(function(n,t){var e=t.event;n.getSystem().getByDom(e.target).each((function(e){zv.highlight(n,e),t.stop(),li(n,xx(),{menu:n,item:e})}))})),xi(rx(),(function(n,t){var e=t.event.item;zv.highlight(n,e)}))]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}},Sx=cv({name:"Menu",configFields:yx(),partFields:bx(),factory:wx}),kx=function(n){return Fn(n,(function(n,t){return{k:n,v:t}}))},Cx=function(n,t,e,o){return Nn(e,o).bind((function(o){return Nn(n,o).bind((function(o){var r=Cx(n,t,e,o);return R.some([o].concat(r))}))})).getOr([])},Ox=function(n,t){var e={};An(n,(function(n,t){X(n,(function(n){e[n]=t}))}));var o=t,r=kx(t),i=Mn(r,(function(n,t){return[t].concat(Cx(e,o,r,t))}));return Mn(e,(function(n){return Nn(i,n).getOr([n])}))},_x=function(){var n=Ke({}),t=Ke({}),e=Ke({}),o=Ke(R.none()),r=Ke({}),i=function(){n.set({}),t.set({}),e.set({}),o.set(R.none())},u=function(){return o.get().isNone()},a=function(n,e){var o;t.set(T(T({},t.get()),(o={},o[n]={type:"prepared",menu:e},o)))},c=function(i,u,a,c){o.set(R.some(i)),n.set(a),t.set(u),r.set(c);var s=Ox(c,a);e.set(s)},s=function(t){return Hn(n.get(),(function(n,e){return n===t}))},f=function(n,t,e){return p(n).bind((function(o){return s(n).bind((function(n){return t(n).map((function(n){return{triggeredMenu:o,triggeringItem:n,triggeringPath:e}}))}))}))},l=function(n,t){var r=K(h(n).toArray(),(function(n){return p(n).isSome()}));return Nn(e.get(),n).bind((function(n){var e=rn(r.concat(n)),i=en(e,(function(n,r){return f(n,t,e.slice(0,r+1)).fold((function(){return o.get().is(n)?[]:[R.none()]}),(function(n){return[R.some(n)]}))}));return fv(i)}))},d=function(t){return Nn(n.get(),t).map((function(n){var o=Nn(e.get(),t).getOr([]);return[n].concat(o)}))},m=function(n){return Nn(e.get(),n).bind((function(n){return n.length>1?R.some(n.slice(1)):R.none()}))},g=function(n){return Nn(e.get(),n)},p=function(n){return v(n).bind(Tx)},v=function(n){return Nn(t.get(),n)},h=function(t){return Nn(n.get(),t)},b=function(n){var t=r.get();return un(Dn(t),n)},y=function(){return o.get().bind(p)},x=function(){return t.get()};return{setMenuBuilt:a,setContents:c,expand:d,refresh:g,collapse:m,lookupMenu:v,lookupItem:h,otherMenus:b,getPrimary:y,getMenus:x,clear:i,isClear:u,getTriggeringPath:l}},Tx=function(n){return"prepared"===n.type?R.some(n.menu):R.none()},Ex={init:_x,extractPreparedMenu:Tx},Dx=function(n,t){var e,o=Ke(R.none()),r=function(t,e,o){return Mn(o,(function(o,r){var i=function(){return Sx.sketch(T(T({},o),{value:r,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?ch():ah()}))};return r===e?{type:"prepared",menu:t.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))},i=Ex.init(),u=function(t){var e=r(t,n.data.primary,n.data.menus),o=s();return i.setContents(n.data.primary,e,n.data.expansions,o),i.getPrimary()},a=function(n){return Kg.getValue(n).value},c=function(n,t,e){return mn(t,(function(n){if(!n.getSystem().isConnected())return R.none();var t=zv.getCandidates(n);return Z(t,(function(n){return a(n)===e}))}))},s=function(t){return Mn(n.data.menus,(function(n,t){return en(n.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))}))},f=function(n,t){zv.highlight(n,t),zv.getHighlighted(t).orThunk((function(){return zv.getFirst(t)})).each((function(t){mi(n,t.element,Wr())}))},l=function(n,t){return sv(G(t,(function(t){return n.lookupMenu(t).bind((function(n){return"prepared"===n.type?R.some(n.menu):R.none()}))})))},d=function(t,e,o){var r=l(e,e.otherMenus(o));X(r,(function(e){ja(e.element,[n.markers.backgroundMenu]),n.stayInDom||wy.remove(t,e)}))},m=function(t){return o.get().getOrThunk((function(){var e={},r=$d(t.element,"."+n.markers.item),i=K(r,(function(n){return"true"===Ou(n,"aria-haspopup")}));return X(i,(function(n){t.getSystem().getByDom(n).each((function(n){var t=a(n);e[t]=n}))})),o.set(R.some(e)),e}))},g=function(n,t){var e=m(n);An(e,(function(n,e){var o=L(t,e);ku(n.element,"aria-expanded",o)}))},v=function(t,e,o){return R.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return R.none();var i=r.menu,u=l(e,o.slice(1));return X(u,(function(t){Pa(t.element,n.markers.backgroundMenu)})),Wa(i.element)||wy.append(t,xc(i)),ja(i.element,[n.markers.backgroundMenu]),f(t,i),d(t,e,o),R.some(i)}))}))};(function(n){n[n["HighlightSubmenu"]=0]="HighlightSubmenu",n[n["HighlightParent"]=1]="HighlightParent"})(e||(e={}));var h=function(n,t,e){if("notbuilt"===e.type){var o=n.getSystem().build(e.nbMenu());return i.setMenuBuilt(t,o),o}return e.menu},b=function(t,o,r){void 0===r&&(r=e.HighlightSubmenu);var u=a(o);return i.expand(u).bind((function(u){return g(t,u),R.from(u[0]).bind((function(a){return i.lookupMenu(a).bind((function(c){var s=h(t,a,c);return Wa(s.element)||wy.append(t,xc(s)),n.onOpenSubmenu(t,o,s,rn(u)),r===e.HighlightSubmenu?(zv.highlightFirst(s),v(t,i,u)):(zv.dehighlightAll(s),R.some(o))}))}))}))},y=function(t,e){var o=a(e);return i.collapse(o).bind((function(o){return g(t,o),v(t,i,o).map((function(o){return n.onCollapseMenu(t,e,o),o}))}))},x=function(n,t){var e=a(t);return i.refresh(e).bind((function(t){return g(n,t),v(n,i,t)}))},w=function(n,t){return pv(t.element)?R.none():b(n,t,e.HighlightSubmenu)},S=function(n,t){return pv(t.element)?R.none():y(n,t)},k=function(t,e){return y(t,e).orThunk((function(){return n.onEscape(t,e).map((function(){return t}))}))},C=function(t){return function(e,o){return ps(o.getSource(),"."+n.markers.item).bind((function(n){return e.getSystem().getByDom(n).toOptional().bind((function(n){return t(e,n).map(O)}))}))}},_=vi([xi(xx(),(function(n,t){var e=t.event.item;i.lookupItem(a(e)).each((function(){var e=t.event.menu;zv.highlight(n,e);var o=a(t.event.item);i.refresh(o).each((function(t){return d(n,i,t)}))}))})),Fi((function(t,o){var r=o.event.target;t.getSystem().getByDom(r).each((function(o){var r=a(o);0===r.indexOf("collapse-item")&&y(t,o),b(t,o,e.HighlightSubmenu).fold((function(){n.onExecute(t,o)}),p)}))})),Bi((function(t,e){u(t).each((function(e){wy.append(t,xc(e)),n.onOpenMenu(t,e),n.highlightImmediately&&f(t,e)}))}))].concat(n.navigateOnHover?[xi(rx(),(function(t,o){var r=o.event.item;x(t,r),b(t,r,e.HighlightParent),n.onHover(t,r)}))]:[])),E=function(n){return zv.getHighlighted(n).bind(zv.getHighlighted)},D=function(n){E(n).each((function(t){y(n,t)}))},B=function(n){i.getPrimary().each((function(t){f(n,t)}))},A=function(n){return R.from(n.components()[0]).filter((function(n){return"menu"===Ou(n.element,"role")}))},M=function(t){var e=i.getPrimary().bind((function(n){return E(t).bind((function(n){var e=a(n),o=zn(i.getMenus()),r=sv(G(o,Ex.extractPreparedMenu));return i.getTriggeringPath(e,(function(n){return c(t,r,n)}))})).map((function(t){return{primary:n,triggeringPath:t}}))}));e.fold((function(){A(t).each((function(e){n.onRepositionMenu(t,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;n.onRepositionMenu(t,o,r)}))},F={collapseMenu:D,highlightPrimary:B,repositionMenus:M};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Qg(n.tmenuBehaviours,[ly.config({mode:"special",onRight:C(w),onLeft:C(S),onEscape:C(k),focusIn:function(n,t){i.getPrimary().each((function(t){mi(n,t.element,Wr())}))}}),zv.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),yv.config({find:function(n){return zv.getHighlighted(n)}}),wy.config({})]),eventOrder:n.eventOrder,apis:F,events:_}},Bx=y("collapse-item"),Ax=function(n,t,e){return{primary:n,menus:t,expansions:e}},Mx=function(n,t){return{primary:n,menus:ft(n,t),expansions:{}}},Fx=function(n){return{value:Pu(Bx()),meta:{text:n}}},Ix=av({name:"TieredMenu",configFields:[Ls("onExecute"),Ls("onEscape"),Ns("onOpenMenu"),Ns("onOpenSubmenu"),Hs("onRepositionMenu"),Hs("onCollapseMenu"),He("highlightImmediately",!0),Te("data",[ye("primary"),ye("menus"),ye("expansions")]),He("fakeFocus",!1),Hs("onHighlight"),Hs("onHover"),Rs(),ye("dom"),He("navigateOnHover",!0),He("stayInDom",!1),Jg("tmenuBehaviours",[ly,zv,yv,wy]),He("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:Dx,extraApis:{tieredData:Ax,singleData:Mx,collapseItem:Fx}}),Rx=function(n,t,e,o,r){var i=function(){return n.lazySink(t)},u="horizontal"===o.type?{layouts:{onLtr:function(){return Ef()},onRtl:function(){return Df()}}}:{},a=function(n){return 2===n.length},c=function(n){return a(n)?u:{}};return Ix.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return mg.close(t),n.onEscape.map((function(n){return n(t)})),R.some(!0)},onExecute:function(){return R.some(!0)},onOpenMenu:function(n,t){Fm.positionWithinBounds(i().getOrDie(),e,t,r())},onOpenSubmenu:function(n,t,e,o){var r=i().getOrDie();Fm.position(r,T({anchor:"submenu",item:t},c(o)),e)},onRepositionMenu:function(n,t,o){var u=i().getOrDie();Fm.positionWithinBounds(u,e,t,r()),X(o,(function(n){var t=c(n.triggeringPath);Fm.position(u,T({anchor:"submenu",item:n.triggeringItem},t),n.triggeredMenu)}))}})},Vx=function(n,t){var e=function(t,e){var o=n.getRelated(t);return o.exists((function(n){return ys(n,e)}))},o=function(n,t){mg.setContent(n,t)},r=function(n,t,e){i(n,t,e,R.none())},i=function(n,t,e,o){u(n,t,e,(function(){return o.map((function(n){return rs(n)}))}))},u=function(t,e,o,r){var i=n.lazySink(t).getOrDie();mg.openWhileCloaked(t,o,(function(){return Fm.positionWithinBounds(i,e,t,r())})),Kg.setValue(t,R.some({mode:"position",anchor:e,getBounds:r}))},a=function(n,t,e){c(n,t,e,(function(){return R.none()}))},c=function(t,e,o,r){var i=Rx(n,t,e,o,r);mg.open(t,i),Kg.setValue(t,R.some({mode:"menu",menu:i}))},s=function(n){mg.isOpen(n)&&(Kg.setValue(n,R.none()),mg.close(n))},f=function(n){return mg.getState(n)},l=function(t){mg.isOpen(t)&&Kg.getValue(t).each((function(e){switch(e.mode){case"menu":mg.getState(t).each((function(n){Ix.repositionMenus(n)}));break;case"position":var o=n.lazySink(t).getOrDie();Fm.positionWithinBounds(o,e.anchor,t,e.getBounds());break}}))},d={setContent:o,showAt:r,showWithin:i,showWithinBounds:u,showMenuAt:a,showMenuWithinBounds:c,hide:s,getContent:f,reposition:l,isOpen:mg.isOpen};return{uid:n.uid,dom:n.dom,behaviours:Qg(n.inlineBehaviours,[mg.config({isPartOf:function(n,t,o){return ys(t,o)||e(n,o)},getAttachPoint:function(t){return n.lazySink(t).getOrDie()},onOpen:function(t){n.onShow(t)},onClose:function(t){n.onHide(t)}}),Kg.config({store:{mode:"memory",initialValue:R.none()}}),Yf.config({channels:T(T({},bg(T({isExtraPart:t.isExtraPart},n.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),xg(T(T({},n.fireRepositionEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})),{doReposition:l})))})]),eventOrder:n.eventOrder,apis:d}},Px=av({name:"InlineView",configFields:[ye("lazySink"),Hs("onShow"),Hs("onHide"),Ie("onEscape"),Jg("inlineBehaviours",[mg,Kg,Yf]),Ve("fireDismissalEventInstead",[He("event",ei())]),Ve("fireRepositionEventInstead",[He("event",oi())]),He("getRelated",R.none),He("isExtraPart",C),He("eventOrder",R.none)],factory:Vx,apis:{showAt:function(n,t,e,o){n.showAt(t,e,o)},showWithin:function(n,t,e,o,r){n.showWithin(t,e,o,r)},showWithinBounds:function(n,t,e,o,r){n.showWithinBounds(t,e,o,r)},showMenuAt:function(n,t,e,o){n.showMenuAt(t,e,o)},showMenuWithinBounds:function(n,t,e,o,r){n.showMenuWithinBounds(t,e,o,r)},hide:function(n,t){n.hide(t)},isOpen:function(n,t){return n.isOpen(t)},getContent:function(n,t){return n.getContent(t)},setContent:function(n,t,e){n.setContent(t,e)},reposition:function(n,t){n.reposition(t)}}}),Hx=function(n){return n.x},zx=function(n,t){return n.x+n.width/2-t.width/2},Nx=function(n,t){return n.x+n.width-t.width},Lx=function(n){return n.y},jx=function(n,t){return n.y+n.height-t.height},Ux=function(n,t,e){return Gs(Nx(n,t),jx(n,t),e.innerSoutheast(),Zs(),uf(n,{right:0,bottom:3}),"layout-inner-se")},Wx=function(n,t,e){return Gs(Hx(n),jx(n,t),e.innerSouthwest(),Qs(),uf(n,{left:1,bottom:3}),"layout-inner-sw")},Gx=function(n,t,e){return Gs(Nx(n,t),Lx(n),e.innerNortheast(),$s(),uf(n,{right:0,top:2}),"layout-inner-ne")},Xx=function(n,t,e){return Gs(Hx(n),Lx(n),e.innerNorthwest(),Js(),uf(n,{left:1,top:2}),"layout-inner-nw")},Yx=function(n,t,e){return Gs(zx(n,t),Lx(n),e.innerNorth(),nf(),uf(n,{top:2}),"layout-inner-n")},qx=function(n,t,e){return Gs(zx(n,t),jx(n,t),e.innerSouth(),tf(),uf(n,{bottom:3}),"layout-inner-s")},Kx=tinymce.util.Tools.resolve("tinymce.util.Delay"),Jx=function(n){var t=Zy(n.action),e=n.dom.tag,o=function(t){return Nn(n.dom,"attributes").bind((function(n){return Nn(n,t)}))},r=function(){if("button"===e){var n=o("type").getOr("button"),t=o("role").map((function(n){return{role:n}})).getOr({});return T({type:n},t)}var r=o("role").getOr("button");return{role:r}};return{uid:n.uid,dom:n.dom,components:n.components,events:t,behaviours:Zg.augment(n.buttonBehaviours,[My.config({}),ly.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:r()},eventOrder:n.eventOrder}},$x=av({name:"Button",factory:Jx,configFields:[He("uid",void 0),ye("dom"),He("components",[]),Zg.field("buttonBehaviours",[My,ly]),Be("action"),Be("role"),He("eventOrder",{})]}),Qx=function(n){var t=rv(n)&&jn(n,"uid")?n.uid:Gu("memento"),e=function(n){return n.getSystem().getByUid(t).getOrDie()},o=function(n){return n.getSystem().getByUid(t).toOptional()},r=function(){return T(T({},n),{uid:t})};return{get:e,getOpt:o,asSpec:r}},Zx=function(n){return R.from(n()["temporary-placeholder"]).getOr("!not found!")},nw=function(n,t){return R.from(t()[n.toLowerCase()]).getOrThunk((function(){return Zx(t)}))},tw=function(n,t,e){return R.from(t()[n.toLowerCase()]).or(e).getOrThunk((function(){return Zx(t)}))},ew=function(n,t){return mn(n,(function(n){return R.from(t()[n.toLowerCase()])})).getOrThunk((function(){return Zx(t)}))},ow={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},rw=function(n){var t=Qx({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:Lf([wy.config({})])}),e=function(n){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+n+"%"}}}},o=function(n){return{dom:{tag:"div",classes:["tox-text"],innerHtml:n+"%"}}},r=Qx({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:Lf([wy.config({})])}),i=function(n,t){n.getSystem().isConnected()&&r.getOpt(n).each((function(n){wy.set(n,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(t)]},o(t)])}))},u=function(n,e){if(n.getSystem().isConnected()){var o=t.get(n);wy.set(o,[vc(e)])}},a={updateProgress:i,updateText:u},c=tn([n.icon.toArray(),n.level.toArray(),n.level.bind((function(n){return R.from(ow[n])})).toArray()]),s=Qx($x.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:nw("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})),f=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:ew(c,n.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:Lf([wy.config({})])}];return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map((function(n){return["tox-notification","tox-notification--in","tox-notification--"+n]})).getOr(["tox-notification","tox-notification--in"])},behaviours:Lf([My.config({}),ky("notification-events",[xi(Er(),(function(n){s.getOpt(n).each(My.focus)}))])]),components:f.concat(n.progress?[r.asSpec()]:[]).concat(n.closeButton?[s.asSpec()]:[]),apis:a}},iw=av({name:"Notification",factory:rw,configFields:[Be("level"),ye("progress"),ye("icon"),ye("onAction"),ye("text"),ye("iconProvider"),ye("translationProvider"),Ue("closeButton",!0)],apis:{updateProgress:function(n,t,e){n.updateProgress(t,e)},updateText:function(n,t,e){n.updateText(t,e)}}});function uw(n,t,e){var o=t.backstage,r=function(n){switch(n){case"bc-bc":return qx;case"tc-tc":return Yx;case"tc-bc":return xf;case"bc-tc":default:return wf}},i=function(n){X(n,(function(n){return n.moveTo(0,0)}))},u=function(n){n.length>0&&(fn(n).each((function(n){return n.moveRel(null,"banner")})),X(n,(function(t,e){e>0&&t.moveRel(n[e-1].getEl(),"bc-tc")})))},a=function(n){i(n),u(n)},c=function(n,i){var u=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),a=function(){i(),Px.hide(s)},c=yc(iw.sketch({text:n.text,level:L(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:R.from(n.icon),closeButton:!u,onAction:a,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),s=yc(Px.sketch(T({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:t.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return e.add(s),n.timeout>0&&Kx.setTimeout((function(){a()}),n.timeout),{close:a,moveTo:function(n,t){Px.showAt(s,{anchor:"makeshift",x:n,y:t},xc(c))},moveRel:function(n,e){if("banner"!==e){var o=r(e),i={anchor:"node",root:Ga(),node:R.some(to.fromDom(n)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}};Px.showAt(s,i,xc(c))}else Px.showAt(s,t.backstage.shared.anchors.banner(),xc(c))},text:function(n){iw.updateText(c,n)},settings:n,getEl:function(){return c.element.dom},progressBar:{value:function(n){iw.updateProgress(c,n)}}}},s=function(n){n.close()},f=function(n){return n.settings};return{open:c,close:s,reposition:a,getArgs:f}}var aw,cw=function(n,t){var e=null,o=function(){null!==e&&(clearTimeout(e),e=null)},r=function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null===e&&(e=setTimeout((function(){n.apply(null,o),e=null}),t))};return{cancel:o,throttle:r}},sw=function(n,t){var e=null,o=function(){null!==e&&(clearTimeout(e),e=null)},r=function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null!==e&&clearTimeout(e),e=setTimeout((function(){n.apply(null,o),e=null}),t)};return{cancel:o,throttle:r}},fw=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),lw=function(n,t){return n.isBlock(t)||L(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===n.getContentEditable(t)},dw=function(n,t,e,o,r){var i=fw(n,(function(t){return lw(n,t)}));return R.from(i.backwards(t,e,o,r))},mw="[data-mce-autocompleter]",gw=function(n,t){return pw(to.fromDom(n.selection.getNode())).getOrThunk((function(){var e=to.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',n.getDoc());return lu(e,to.fromDom(t.extractContents())),t.insertNode(e.dom),Gi(e).each((function(n){return n.dom.normalize()})),Kd(e).map((function(t){n.selection.setCursorLocation(t.dom,Gd(t))})),e}))},pw=function(n){return ps(n,mw)},vw=function(n){return n.collapsed&&3===n.startContainer.nodeType},hw=function(n){return n.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},bw=function(n){return""!==n&&-1!=="  \f\n\r\t\v".indexOf(n)},yw=function(n,t){return n.substring(t.length)},xw=function(n,t,e){var o;for(o=t-1;o>=0;o--){var r=n.charAt(o);if(bw(r))return R.none();if(r===e)break}return R.some(o)},ww=function(n,t,e,o){if(void 0===o&&(o=0),!vw(t))return R.none();var r=function(n,t,o){return xw(o,t,e).getOr(t)},i=n.getParent(t.startContainer,n.isBlock)||n.getRoot();return dw(n,t.startContainer,t.startOffset,r,i).bind((function(n){var r=t.cloneRange();if(r.setStart(n.container,n.offset),r.setEnd(t.endContainer,t.endOffset),r.collapsed)return R.none();var i=hw(r),u=i.lastIndexOf(e);return 0!==u||yw(i,e).length<o?R.none():R.some({text:yw(i,e),range:r,triggerChar:e})}))},Sw=function(n,t,e,o){return void 0===o&&(o=0),pw(to.fromDom(t.startContainer)).fold((function(){return ww(n,t,e,o)}),(function(t){var o=n.createRng();o.selectNode(t.dom);var r=hw(o);return R.some({range:o,text:yw(r,e),triggerChar:e})}))},kw=function(n,t){t.on("keypress compositionend",n.onKeypress.throttle),t.on("remove",n.onKeypress.cancel);var e=function(n,t){li(n,Br(),{raw:t})};t.on("keydown",(function(t){var o=function(){return n.getView().bind(zv.getHighlighted)};8===t.which&&n.onKeypress.throttle(t),n.isActive()&&(27===t.which&&n.cancelIfNecessary(),n.isMenuOpen()?13===t.which?(o().each(di),t.preventDefault()):40===t.which?(o().fold((function(){n.getView().each(zv.highlightFirst)}),(function(n){e(n,t)})),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||o().each((function(n){e(n,t),t.preventDefault(),t.stopImmediatePropagation()})):13!==t.which&&38!==t.which&&40!==t.which||n.cancelIfNecessary())})),t.on("NodeChange",(function(t){n.isActive()&&!n.isProcessingAction()&&pw(to.fromDom(t.element)).isNone()&&n.cancelIfNecessary()}))},Cw={setup:kw},Ow=tinymce.util.Tools.resolve("tinymce.util.Promise"),_w=function(n,t){return{container:n,offset:t}},Tw=function(n){return n.nodeType===nr},Ew=function(n){return n.nodeType===Zo},Dw=function(n){if(Tw(n))return _w(n,n.data.length);var t=n.childNodes;return t.length>0?Dw(t[t.length-1]):_w(n,t.length)},Bw=function(n,t){var e=n.childNodes;return e.length>0&&t<e.length?Bw(e[t],0):e.length>0&&Ew(n)&&e.length===t?Dw(e[e.length-1]):_w(n,t)},Aw=function(n,t){return dw(n,t.container,t.offset,(function(n,t){return 0===t?-1:t}),n.getRoot()).filter((function(n){var t=n.container.data.charAt(n.offset-1);return!bw(t)})).isSome()},Mw=function(n){return function(t){var e=Bw(t.startContainer,t.startOffset);return!Aw(n,e)}},Fw=function(n,t,e){return mn(e.triggerChars,(function(e){return Sw(n,t,e)}))},Iw=function(n,t){var e=t(),o=n.selection.getRng();return Fw(n.dom,o,e).bind((function(e){return Rw(n,t,e)}))},Rw=function(n,t,e,o){void 0===o&&(o={});var r=t(),i=n.selection.getRng(),u=i.startContainer.nodeValue,a=K(r.lookupByChar(e.triggerChar),(function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk((function(){return Mw(n.dom)}))(e.range,u,e.text)}));if(0===a.length)return R.none();var c=Ow.all(G(a,(function(n){var t=n.fetch(e.text,n.maxResults,o);return t.then((function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction,highlightOn:n.highlightOn}}))})));return R.some({lookupData:c,context:e})},Vw=zt([Se("type"),Fe("text")]),Pw=function(n){return oe("separatormenuitem",Vw,n)},Hw=zt([He("type","autocompleteitem"),He("active",!1),He("disabled",!1),He("meta",{}),Se("value"),Fe("text"),Fe("icon")]),zw=zt([Se("type"),Se("ch"),Ne("minChars",1),He("columns",1),Ne("maxResults",10),Ie("matches"),Oe("fetch"),Oe("onAction"),Xe("highlightOn",[],me)]),Nw=function(n){return oe("Autocompleter.Separator",Vw,n)},Lw=function(n){return oe("Autocompleter.Item",Hw,n)},jw=function(n){return oe("Autocompleter",zw,n)},Uw=[Ue("disabled",!1),Fe("tooltip"),Fe("icon"),Fe("text"),We("onSetup",(function(){return p}))],Ww=zt([Se("type"),Oe("onAction")].concat(Uw)),Gw=function(n){return oe("toolbarbutton",Ww,n)},Xw=[Ue("active",!1)].concat(Uw),Yw=zt(Xw.concat([Se("type"),Oe("onAction")])),qw=function(n){return oe("ToggleButton",Yw,n)},Kw=[We("predicate",C),je("scope","node",["node","editor"]),je("position","selection",["node","selection","line"])],Jw=Uw.concat([He("type","contextformbutton"),He("primary",!1),Oe("onAction"),qe("original",x)]),$w=Xw.concat([He("type","contextformbutton"),He("primary",!1),Oe("onAction"),qe("original",x)]),Qw=Uw.concat([He("type","contextformbutton")]),Zw=Xw.concat([He("type","contextformtogglebutton")]),nS=ce("type",{contextformbutton:Jw,contextformtogglebutton:$w}),tS=zt([He("type","contextform"),We("initValue",(function(){return""})),Fe("label"),De("commands",nS),Ae("launch",ce("type",{contextformbutton:Qw,contextformtogglebutton:Zw}))].concat(Kw)),eS=function(n){return oe("ContextForm",tS,n)},oS=zt([He("type","contexttoolbar"),Se("items")].concat(Kw)),rS=function(n){return oe("ContextToolbar",oS,n)},iS=function(n){var t={};return X(n,(function(n){t[n]={}})),Dn(t)},uS=function(n){var t=n.ui.registry.getAll().popups,e=Mn(t,(function(n){return jw(n).fold((function(n){throw new Error(ue(n))}),(function(n){return n}))})),o=iS(Pn(e,(function(n){return n.ch}))),r=zn(e),i=function(n){return K(r,(function(t){return t.ch===n}))};return{dataset:e,triggerChars:o,lookupByChar:i}};(function(n){n[n["CLOSE_ON_EXECUTE"]=0]="CLOSE_ON_EXECUTE",n[n["BUBBLE_TO_SANDBOX"]=1]="BUBBLE_TO_SANDBOX"})(aw||(aw={}));var aS,cS=aw,sS="tox-menu-nav__js",fS="tox-collection__item",lS="tox-swatch",dS={normal:sS,color:lS},mS="tox-collection__item--enabled",gS="tox-collection__group-heading",pS="tox-collection__item-icon",vS="tox-collection__item-label",hS="tox-collection__item-accessory",bS="tox-collection__item-caret",yS="tox-collection__item-checkmark",xS="tox-collection__item--active",wS="tox-collection__item-icon-rtl",SS="tox-collection__item-container",kS="tox-collection__item-container--column",CS="tox-collection__item-container--row",OS="tox-collection__item-container--align-right",_S="tox-collection__item-container--align-left",TS="tox-collection__item-container--valign-top",ES="tox-collection__item-container--valign-middle",DS="tox-collection__item-container--valign-bottom",BS=function(n){return Nn(dS,n).getOr(sS)},AS=function(n){return"color"===n?"tox-swatches":"tox-menu"},MS=function(n){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:AS(n),tieredMenu:"tox-tiered-menu"}},FS=function(n){var t=MS(n);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:BS(n)}},IS=function(n,t,e){var o=MS(e);return{tag:"div",classes:tn([[o.menu,"tox-menu-"+t+"-column"],n?[o.hasIcons]:[]])}},RS=[Sx.parts.items({})],VS=function(n,t,e){var o=MS(e),r={tag:"div",classes:tn([[o.tieredMenu]])};return{dom:r,markers:FS(e)}},PS=function(n,t){return function(e){var o=W(e,t);return G(o,(function(t){return{dom:n,components:t}}))}},HS=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Sx.parts.items({preprocess:"auto"!==n?PS({tag:"div",classes:["tox-swatches__row"]},n):x})]}]}},zS=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Sx.parts.items({preprocess:PS({tag:"div",classes:["tox-collection__group"]},n)})]}},NS=function(n,t){var e=[],o=[];return X(n,(function(n,r){t(n,r)?(o.length>0&&e.push(o),o=[],Ln(n.dom,"innerHtml")&&o.push(n)):o.push(n)})),o.length>0&&e.push(o),G(e,(function(n){return{dom:{tag:"div",classes:["tox-collection__group"]},components:n}}))},LS=function(n,t,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[Sx.parts.items({preprocess:function(e){return"auto"!==n&&n>1?PS({tag:"div",classes:["tox-collection__group"]},n)(e):NS(e,(function(n,e){return"separator"===t[e].type}))}})]}},jS=function(n,t){return{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Sx.parts.items({preprocess:function(t){return NS(t,(function(t,e){return"separator"===n[e].type}))}})]}},US=function(n){return j(n,(function(n){return"icon"in n&&void 0!==n.icon}))},WS=function(n){return R.none()},GS=function(n,t,e,o,r){var i=jS(e);return{value:n,dom:i.dom,components:i.components,items:e}},XS=function(n,t,e,o,r){if("color"===r){var i=HS(o);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===r&&"auto"===o){i=LS(o,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===r&&1===o){i=LS(1,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===r){i=LS(o,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("listpreview"===r&&"auto"!==o){i=zS(o);return{value:n,dom:i.dom,components:i.components,items:e}}return{value:n,dom:IS(t,o,r),components:RS,items:e}},YS=[Se("type"),Se("src"),Fe("alt"),Xe("classes",[],me)],qS=zt(YS),KS=[Se("type"),Se("text"),Fe("name"),Xe("classes",["tox-collection__item-label"],me)],JS=zt(KS),$S=Zt((function(){return ae("type",{cardimage:qS,cardtext:JS,cardcontainer:QS})})),QS=zt([Se("type"),Le("direction","horizontal"),Le("align","left"),Le("valign","middle"),De("items",$S)]),ZS=[Ue("disabled",!1),Fe("text"),Fe("shortcut"),Yt("value","value",ot((function(){return Pu("menuitem-value")})),fe()),He("meta",{})],nk=zt([Se("type"),Fe("label"),De("items",$S),We("onSetup",(function(){return p})),We("onAction",p)].concat(ZS)),tk=function(n){return oe("cardmenuitem",nk,n)},ek=zt([Se("type"),Ue("active",!1),Fe("icon")].concat(ZS)),ok=function(n){return oe("choicemenuitem",ek,n)},rk=["inserttable","colorswatch"],ik=zt([Se("type"),ke("fancytype",rk),We("onAction",p)]),uk=function(n){return oe("fancymenuitem",ik,n)},ak=zt([Se("type"),We("onSetup",(function(){return p})),We("onAction",p),Fe("icon")].concat(ZS)),ck=function(n){return oe("menuitem",ak,n)},sk=zt([Se("type"),Oe("getSubmenuItems"),We("onSetup",(function(){return p})),Fe("icon")].concat(ZS)),fk=function(n){return oe("nestedmenuitem",sk,n)},lk=zt([Se("type"),Fe("icon"),Ue("active",!1),We("onSetup",(function(){return p})),Oe("onAction")].concat(ZS)),dk=function(n){return oe("togglemenuitem",lk,n)},mk=function(n,t,e){var o=$d(n.element,"."+e);if(o.length>0){var r=nn(o,(function(n){var e=n.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>t})).getOr(o.length);return R.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return R.none()},gk=function(n,t){return Lf([ky(n,t)])},pk=function(n){return gk(Pu("unnamed-events"),n)},vk={namedEvents:gk,unnamedEvents:pk},hk=Pu("tooltip.exclusive"),bk=Pu("tooltip.show"),yk=Pu("tooltip.hide"),xk=function(n,t,e){n.getSystem().broadcastOn([hk],{})},wk=function(n,t,e,o){e.getTooltip().each((function(n){n.getSystem().isConnected()&&wy.set(n,o)}))},Sk=Object.freeze({__proto__:null,hideAllExclusive:xk,setComponents:wk}),kk=function(n,t){var e=function(e){t.getTooltip().each((function(o){jm(o),n.onHide(e,o),t.clearTooltip()})),t.clearTimer()},o=function(e){if(!t.isShowing()){xk(e);var o=n.lazySink(e).getOrDie(),r=e.getSystem().build({dom:n.tooltipDom,components:n.tooltipComponents,events:vi("normal"===n.mode?[xi(Tr(),(function(n){fi(e,bk)})),xi(Or(),(function(n){fi(e,yk)}))]:[]),behaviours:Lf([wy.config({})])});t.setTooltip(r),zm(o,r),n.onShow(e,r),Fm.position(o,n.anchor(e),r)}};return vi(tn([[xi(bk,(function(e){t.resetTimer((function(){o(e)}),n.delay)})),xi(yk,(function(o){t.resetTimer((function(){e(o)}),n.delay)})),xi(jr(),(function(n,t){var o=t;o.universal||L(o.channels,hk)&&e(n)})),Ai((function(n){e(n)}))],"normal"===n.mode?[xi(Er(),(function(n){fi(n,bk)})),xi(Nr(),(function(n){fi(n,yk)})),xi(Tr(),(function(n){fi(n,bk)})),xi(Or(),(function(n){fi(n,yk)}))]:[xi(ci(),(function(n,t){fi(n,bk)})),xi(si(),(function(n){fi(n,yk)}))]]))},Ck=Object.freeze({__proto__:null,events:kk}),Ok=[ye("lazySink"),ye("tooltipDom"),He("exclusive",!0),He("tooltipComponents",[]),He("delay",300),je("mode","normal",["normal","follow-highlight"]),He("anchor",(function(n){return{anchor:"hotspot",hotspot:n,layouts:{onLtr:y([wf,xf,vf,bf,hf,yf]),onRtl:y([wf,xf,vf,bf,hf,yf])}}})),Hs("onHide"),Hs("onShow")],_k=function(){var n=Ke(R.none()),t=Ke(R.none()),e=function(){return t.get()},o=function(n){t.set(R.some(n))},r=function(){t.set(R.none())},i=function(){n.get().each((function(n){clearTimeout(n)}))},u=function(t,e){i(),n.set(R.some(setTimeout((function(){t()}),e)))},a=function(){return t.get().isSome()},c=y("not-implemented");return ra({getTooltip:e,isShowing:a,setTooltip:o,clearTooltip:r,clearTimer:i,resetTimer:u,readState:c})},Tk=Object.freeze({__proto__:null,init:_k}),Ek=Uf({fields:Ok,name:"tooltipping",active:Ck,state:Tk,apis:Sk}),Dk=function(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},Bk=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Ak=tinymce.util.Tools.resolve("tinymce.util.I18n"),Mk=["input","button","textarea","select"],Fk=function(n,t,e){var o=t.disabled()?Lk:jk;o(n,t)},Ik=function(n,t){return!0===t.useNative&&L(Mk,Ii(n.element))},Rk=function(n){return Tu(n.element,"disabled")},Vk=function(n){ku(n.element,"disabled","disabled")},Pk=function(n){Eu(n.element,"disabled")},Hk=function(n){return"true"===Ou(n.element,"aria-disabled")},zk=function(n){ku(n.element,"aria-disabled","true")},Nk=function(n){ku(n.element,"aria-disabled","false")},Lk=function(n,t,e){t.disableClass.each((function(t){Pa(n.element,t)}));var o=Ik(n,t)?Vk:zk;o(n),t.onDisabled(n)},jk=function(n,t,e){t.disableClass.each((function(t){za(n.element,t)}));var o=Ik(n,t)?Pk:Nk;o(n),t.onEnabled(n)},Uk=function(n,t){return Ik(n,t)?Rk(n):Hk(n)},Wk=function(n,t,e,o){var r=o?Lk:jk;r(n,t)},Gk=Object.freeze({__proto__:null,enable:jk,disable:Lk,isDisabled:Uk,onLoad:Fk,set:Wk}),Xk=function(n,t){return sa({classes:t.disabled()?t.disableClass.toArray():[]})},Yk=function(n,t){return vi([hi(Ur(),(function(t,e){return Uk(t,n)})),Rf(n,t,Fk)])},qk=Object.freeze({__proto__:null,exhibit:Xk,events:Yk}),Kk=[We("disabled",C),He("useNative",!0),Be("disableClass"),Hs("onDisabled"),Hs("onEnabled")],Jk=Uf({fields:Kk,name:"disabling",active:qk,apis:Gk}),$k=tinymce.util.Tools.resolve("tinymce.EditorManager"),Qk=function(n){var t=n.getParam("skin"),e=n.getParam("skin_url");if(!1!==t){var o=t||"oxide";e=e?n.documentBaseURI.toAbsolute(e):$k.baseURL+"/skins/ui/"+o}return e},Zk=function(n){return n.getParam("readonly",!1,"boolean")},nC=function(n){return!1===n.getParam("skin")},tC=function(n){return n.getParam("height",Math.max(n.getElement().offsetHeight,200))},eC=function(n){return n.getParam("width",Bk.DOM.getStyle(n.getElement(),"width"))},oC=function(n){return R.from(n.getParam("min_width")).filter(m)},rC=function(n){return R.from(n.getParam("min_height")).filter(m)},iC=function(n){return R.from(n.getParam("max_width")).filter(m)},uC=function(n){return R.from(n.getParam("max_height")).filter(m)},aC=function(n){return R.from(n.getParam("style_formats")).filter(a)},cC=function(n){return n.getParam("style_formats_merge",!1,"boolean")},sC=function(n){return n.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},fC=function(n){return n.getParam("removed_menuitems","")},lC=function(n){return!1!==n.getParam("menubar",!0,"boolean")},dC=function(n){var t=n.getParam("toolbar",!0),e=!0===t,o=i(t),r=a(t)&&t.length>0;return!gC(n)&&(r||o||e)},mC=function(n){var t=U(9,(function(t){return n.getParam("toolbar"+(t+1),!1,"string")})),e=K(t,(function(n){return"string"===typeof n}));return e.length>0?R.some(e):R.none()},gC=function(n){return mC(n).fold((function(){var t=n.getParam("toolbar",[],"string[]");return t.length>0}),O)};(function(n){n["default"]="wrap",n["floating"]="floating",n["sliding"]="sliding",n["scrolling"]="scrolling"})(aS||(aS={}));var pC,vC=function(n){return n.getParam("toolbar_mode","","string")};(function(n){n["auto"]="auto",n["top"]="top",n["bottom"]="bottom"})(pC||(pC={}));var hC,bC=function(n){return n.getParam("toolbar_groups",{},"object")},yC=function(n){return n.getParam("toolbar_location",pC.auto,"string")},xC=function(n){return yC(n)===pC.bottom},wC=function(n){return n.getParam("fixed_toolbar_container","","string")},SC=function(n){return n.getParam("fixed_toolbar_container_target")},kC=function(n){return n.getParam("toolbar_persist",!1,"boolean")},CC=function(n){if(!n.inline)return R.none();var t=wC(n);if(t.length>0)return gs(Ga(),t);var e=SC(n);return l(e)?R.some(to.fromDom(e)):R.none()},OC=function(n){return n.inline&&CC(n).isSome()},_C=function(n){var t=CC(n);return t.getOrThunk((function(){return eu(tu(to.fromDom(n.getElement())))}))},TC=function(n){return n.inline&&!lC(n)&&!dC(n)&&!gC(n)},EC=function(n){var t=n.getParam("toolbar_sticky",!1,"boolean");return(t||n.inline)&&!OC(n)&&!TC(n)},DC=function(n){return n.getParam("draggable_modal",!1,"boolean")},BC=function(n){var t=n.getParam("menu");return t?Mn(t,(function(n){return T(T({},n),{items:n.items})})):{}},AC=function(n){return n.getParam("menubar")},MC=function(n){return n.getParam("toolbar",!0)},FC=function(n){return n.getParam("file_picker_callback")},IC=function(n){return n.getParam("file_picker_types")},RC=function(n){return n.getParam("file_browser_callback_types")},VC=function(n){return!1===n.getParam("typeahead_urls")},PC=function(n){return n.getParam("anchor_top","#top")},HC=function(n){return n.getParam("anchor_bottom","#bottom")},zC=function(n){var t=n.getParam("file_picker_validator_handler",void 0,"function");return void 0===t?n.getParam("filepicker_validator_handler",void 0,"function"):t},NC="silver.readonly",LC=zt([Ce("readonly")]),jC=function(n,t){var e=n.outerContainer,o=e.element;t&&(n.mothership.broadcastOn([gg()],{target:o}),n.uiMothership.broadcastOn([gg()],{target:o})),n.mothership.broadcastOn([NC],{readonly:t}),n.uiMothership.broadcastOn([NC],{readonly:t})},UC=function(n,t){n.on("init",(function(){n.mode.isReadOnly()&&jC(t,!0)})),n.on("SwitchMode",(function(){return jC(t,n.mode.isReadOnly())})),Zk(n)&&n.setMode("readonly")},WC=function(){var n;return Yf.config({channels:(n={},n[NC]={schema:LC,onReceive:function(n,t){Jk.set(n,t.readonly)}},n)})},GC=function(n){return Jk.config({disabled:n,disableClass:"tox-collection__item--state-disabled"})},XC=function(n){return Jk.config({disabled:n})},YC=function(n){return Jk.config({disabled:n,disableClass:"tox-tbtn--disabled"})},qC=function(n){return Jk.config({disabled:n,disableClass:"tox-tbtn--disabled",useNative:!1})},KC={item:GC,button:XC,splitButton:YC,toolbarButton:qC},JC=function(n,t){var e=n.getApi(t);return function(n){n(e)}},$C=function(n,t){return Bi((function(e){var o=JC(n,e);o((function(e){var o=n.onSetup(e);d(o)&&t.set(o)}))}))},QC=function(n,t){return Ai((function(e){return JC(n,e)(t.get())}))},ZC=function(n,t){return Fi((function(e,o){JC(n,e)(n.onAction),n.triggersSubmenu||t!==cS.CLOSE_ON_EXECUTE||(e.getSystem().isConnected()&&fi(e,Yr()),o.stop())}))},nO=(hC={},hC[Ur()]=["disabling","alloy.base.behaviour","toggling","item-events"],hC),tO=function(n){return en(n,(function(n){return n.toArray()}))},eO=function(n,t,e,o){var r=Ke(p);return{type:"item",dom:t.dom,components:tO(t.optComponents),data:n.data,eventOrder:nO,hasSubmenu:n.triggersSubmenu,itemBehaviours:Lf([ky("item-events",[ZC(n,e),$C(n,r),QC(n,r)]),KC.item((function(){return n.disabled||o.isDisabled()})),WC(),wy.config({})].concat(n.itemBehaviours))}},oO=function(n){return{value:n.value,meta:T({text:n.text.getOr("")},n.meta)}},rO=tinymce.util.Tools.resolve("tinymce.Env"),iO=function(n){var t={alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"},e={meta:"Ctrl",access:"Shift+Alt"},o=rO.mac?t:e,r=n.split("+"),i=G(r,(function(n){var t=n.toLowerCase().trim();return Ln(o,t)?o[t]:n}));return rO.mac?i.join(""):i.join("+")},uO=function(n){return{dom:{tag:"div",classes:[pS],innerHtml:n}}},aO=function(n){return{dom:{tag:"div",classes:[vS]},components:[vc(Ak.translate(n))]}},cO=function(n,t){return{dom:{tag:"div",classes:t,innerHtml:n}}},sO=function(n,t){return{dom:{tag:"div",classes:[vS]},components:[{dom:{tag:n.tag,styles:n.styles},components:[vc(Ak.translate(t))]}]}},fO=function(n){return{dom:{tag:"div",classes:[hS],innerHtml:iO(n)}}},lO=function(n){return{dom:{tag:"div",classes:[yS],innerHtml:nw("checkmark",n)}}},dO=function(n){return{dom:{tag:"div",classes:[bS],innerHtml:nw("chevron-right",n)}}},mO=function(n){return{dom:{tag:"div",classes:[bS],innerHtml:nw("chevron-down",n)}}},gO=function(n,t){var e="vertical"===n.direction?kS:CS,o="left"===n.align?_S:OS,r=function(){switch(n.valign){case"top":return TS;case"middle":return ES;case"bottom":return DS}};return{dom:{tag:"div",classes:[SS,e,o,r()]},components:t}},pO=function(n,t,e){return{dom:{tag:"img",classes:t,attributes:{src:n,alt:e.getOr("")}}}},vO=function(n,t,e,o){var r="custom",i="remove",u=function(){var u=lS,a=e.getOr(""),c=n.map((function(n){return{title:o.translate(n)}})).getOr({}),s={tag:"div",attributes:c,classes:[u]};return T(T({},s),t===r?{tag:"button",classes:D(s.classes,["tox-swatches__picker-btn"]),innerHtml:a}:t===i?{classes:D(s.classes,["tox-swatch--remove"]),innerHtml:a}:{attributes:T(T({},s.attributes),{"data-mce-color":t}),styles:{"background-color":t}})};return{dom:u(),optComponents:[]}},hO=function(n,t){var e=t.map((function(n){return{attributes:{title:Ak.translate(n)}}})).getOr({});return T({tag:"div",classes:[sS,fS].concat(n?[wS]:[])},e)},bO=function(n,t,e,o,r){var i=e?t.or(R.some("")).map(uO):R.none(),u=n.checkMark,a=n.htmlContent.fold((function(){return n.textContent.map(o)}),(function(n){return R.some(cO(n,[vS]))})),c={dom:hO(r,n.ariaLabel),optComponents:[i,a,n.shortcutContent.map(fO),u,n.caret]};return c},yO=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],xO=["list-bull-circle","list-bull-default","list-bull-square"],wO=function(n,t,e,o){void 0===o&&(o=R.none());var r=function(n){return n.map((function(n){return Ak.isRtl()&&L(yO,n)?n+"-rtl":n}))},i=Ak.isRtl()&&n.iconContent.exists((function(n){return L(xO,n)})),u=r(n.iconContent).map((function(n){return tw(n,t.icons,o)})),a=R.from(n.meta).fold((function(){return aO}),(function(n){return Ln(n,"style")?w(sO,n.style):aO}));return"color"===n.presets?vO(n.ariaLabel,n.value,u,t):bO(n,u,e,a,i)},SO=function(n,t){return Nn(n,"tooltipWorker").map((function(n){return[Ek.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(n){return{anchor:"submenu",item:n,overrides:{maxHeightFunction:Bl}}},mode:"follow-highlight",onShow:function(t,e){n((function(n){Ek.setComponents(t,[hc({element:to.fromDom(n)})])}))}})]})).getOr([])},kO=function(n){return Bk.DOM.encode(n)},CO=function(n,t){var e=Ak.translate(n),o=kO(e);if(t.length>0){var r=new RegExp(Dk(t),"gi");return o.replace(r,(function(n){return'<span class="tox-autocompleter-highlight">'+n+"</span>"}))}return o},OO=function(n,t,e,o,r,i,u,a){void 0===a&&(a=!0);var c=wO({presets:o,textContent:R.none(),htmlContent:e?n.text.map((function(n){return CO(n,t)})):R.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:R.none(),checkMark:R.none(),caret:R.none(),value:n.value},u.providers,a,n.icon);return eO({data:oO(n),disabled:n.disabled,getApi:y({}),onAction:function(t){return r(n.value,n.meta)},onSetup:y(p),triggersSubmenu:!1,itemBehaviours:SO(n.meta,u)},c,i,u.providers)},_O=function(n,t){return G(n,(function(n){switch(n.type){case"cardcontainer":return gO(n,_O(n.items,t));case"cardimage":return pO(n.src,n.classes,n.alt);case"cardtext":var e=n.name.exists((function(n){return L(t.cardText.highlightOn,n)})),o=e?R.from(t.cardText.matchText).getOr(""):"";return cO(CO(n.text,o),n.classes)}}))},TO=function(n,t,e,o){var r=function(n){return{isDisabled:function(){return Jk.isDisabled(n)},setDisabled:function(t){Jk.set(n,t),X($d(n.element,"*"),(function(e){n.getSystem().getByDom(e).each((function(n){n.hasConfigured(Jk)&&Jk.set(n,t)}))}))}}},i={dom:hO(!1,n.label),optComponents:[R.some({dom:{tag:"div",classes:[SS,CS]},components:_O(n.items,o)})]};return eO({data:oO(T({text:R.none()},n)),disabled:n.disabled,getApi:r,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:R.from(o.itemBehaviours).getOr([])},i,t,e.providers)},EO=function(n,t,e,o,r,i,u,a){void 0===a&&(a=!0);var c=function(n){return{setActive:function(t){$y.set(n,t)},isActive:function(){return $y.isOn(n)},isDisabled:function(){return Jk.isDisabled(n)},setDisabled:function(t){return Jk.set(n,t)}}},s=wO({presets:e,textContent:t?n.text:R.none(),htmlContent:R.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:t?n.shortcut:R.none(),checkMark:t?R.some(lO(u.icons)):R.none(),caret:R.none(),value:n.value},u,a);return Kn(eO({data:oO(n),disabled:n.disabled,getApi:c,onAction:function(t){return o(n.value)},onSetup:function(n){return n.setActive(r),p},triggersSubmenu:!1,itemBehaviours:[]},s,i,u),{toggling:{toggleClass:mS,toggleOnExecute:!1,selected:n.active}})},DO=Vp(fx(),lx()),BO=function(n){return{value:n}},AO=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,MO=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,FO=function(n){return AO.test(n)||MO.test(n)},IO=function(n){var t=n.value.replace(AO,(function(n,t,e,o){return t+t+e+e+o+o}));return{value:t}},RO=function(n){var t=IO(n),e=MO.exec(t.value);return null===e?["FFFFFF","FF","FF","FF"]:e},VO=function(n){var t=n.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},PO=function(n){var t=VO(n.red)+VO(n.green)+VO(n.blue);return BO(t)},HO=Math.min,zO=Math.max,NO=Math.round,LO=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,jO=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,UO=function(n,t,e,o){return{red:n,green:t,blue:e,alpha:o}},WO=function(n){var t=parseInt(n,10);return t.toString()===n&&t>=0&&t<=255},GO=function(n){var t,e,o,r=(n.hue||0)%360,i=n.saturation/100,u=n.value/100;if(i=zO(0,HO(i,1)),u=zO(0,HO(u,1)),0===i)return t=e=o=NO(255*u),UO(t,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:t=c,e=s,o=0;break;case 1:t=s,e=c,o=0;break;case 2:t=0,e=c,o=s;break;case 3:t=0,e=s,o=c;break;case 4:t=s,e=0,o=c;break;case 5:t=c,e=0,o=s;break;default:t=e=o=0}return t=NO(255*(t+f)),e=NO(255*(e+f)),o=NO(255*(o+f)),UO(t,e,o,1)},XO=function(n){var t=RO(n),e=parseInt(t[1],16),o=parseInt(t[2],16),r=parseInt(t[3],16);return UO(e,o,r,1)},YO=function(n,t,e,o){var r=parseInt(n,10),i=parseInt(t,10),u=parseInt(e,10),a=parseFloat(o);return UO(r,i,u,a)},qO=function(n){if("transparent"===n)return R.some(UO(0,0,0,0));var t=LO.exec(n);if(null!==t)return R.some(YO(t[1],t[2],t[3],"1"));var e=jO.exec(n);return null!==e?R.some(YO(e[1],e[2],e[3],e[4])):R.none()},KO=function(n){return"rgba("+n.red+","+n.green+","+n.blue+","+n.alpha+")"},JO=UO(255,0,0,1),$O=function(n){return n.fire("SkinLoaded")},QO=function(n,t){return n.fire("SkinLoadError",t)},ZO=function(n){return n.fire("ResizeEditor")},n_=function(n,t){return n.fire("ResizeContent",t)},t_=function(n,t){return n.fire("ScrollContent",t)},e_=function(n,t){return n.fire("TextColorChange",t)},o_=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),r_="tinymce-custom-colors";function i_(n){void 0===n&&(n=10);var t=o_.getItem(r_),e=i(t)?JSON.parse(t):[],o=function(t){var e=n-t.length;return e<0?t.slice(0,n):t},r=o(e),u=function(t){N(r,t).each(a),r.unshift(t),r.length>n&&r.pop(),o_.setItem(r_,JSON.stringify(r))},a=function(n){r.splice(n,1)},c=function(){return r.slice(0)};return{add:u,state:c}}var u_,a_="choiceitem",c_=[{type:a_,text:"Light Green",value:"#BFEDD2"},{type:a_,text:"Light Yellow",value:"#FBEEB8"},{type:a_,text:"Light Red",value:"#F8CAC6"},{type:a_,text:"Light Purple",value:"#ECCAFA"},{type:a_,text:"Light Blue",value:"#C2E0F4"},{type:a_,text:"Green",value:"#2DC26B"},{type:a_,text:"Yellow",value:"#F1C40F"},{type:a_,text:"Red",value:"#E03E2D"},{type:a_,text:"Purple",value:"#B96AD9"},{type:a_,text:"Blue",value:"#3598DB"},{type:a_,text:"Dark Turquoise",value:"#169179"},{type:a_,text:"Orange",value:"#E67E23"},{type:a_,text:"Dark Red",value:"#BA372A"},{type:a_,text:"Dark Purple",value:"#843FA1"},{type:a_,text:"Dark Blue",value:"#236FA1"},{type:a_,text:"Light Gray",value:"#ECF0F1"},{type:a_,text:"Medium Gray",value:"#CED4D9"},{type:a_,text:"Gray",value:"#95A5A6"},{type:a_,text:"Dark Gray",value:"#7E8C8D"},{type:a_,text:"Navy Blue",value:"#34495E"},{type:a_,text:"Black",value:"#000000"},{type:a_,text:"White",value:"#ffffff"}],s_=i_(10),f_=function(n){var t=[],e=document.createElement("canvas");e.height=1,e.width=1;for(var o=e.getContext("2d"),r=function(n,t){var e=255,o=t/255,r=Math.round(n*o+e*(1-o));return("0"+r.toString(16)).slice(-2).toUpperCase()},i=function(n){if(/^[0-9A-Fa-f]{6}$/.test(n))return"#"+n.toUpperCase();o.clearRect(0,0,e.width,e.height),o.fillStyle="#FFFFFF",o.fillStyle=n,o.fillRect(0,0,1,1);var t=o.getImageData(0,0,1,1).data,i=t[0],u=t[1],a=t[2],c=t[3];return"#"+r(i,c)+r(u,c)+r(a,c)},u=0;u<n.length;u+=2)t.push({text:n[u+1],value:i(n[u]),type:"choiceitem"});return t},l_=function(n,t){return n.getParam("color_cols",t,"number")},d_=function(n){return!1!==n.getParam("custom_colors")},m_=function(n){return n.getParam("color_map")},g_=function(n){var t=m_(n);return void 0!==t?f_(t):c_},p_=function(){return G(s_.state(),(function(n){return{type:a_,text:n,value:n}}))},v_=function(n){s_.add(n)},h_=function(n,t){var e;return n.dom.getParents(n.selection.getStart(),(function(n){var o;(o=n.style["forecolor"===t?"color":"background-color"])&&(e=e||o)})),e},b_=function(n,t,e){n.undoManager.transact((function(){n.focus(),n.formatter.apply(t,{value:e}),n.nodeChanged()}))},y_=function(n,t){n.undoManager.transact((function(){n.focus(),n.formatter.remove(t,{value:null},null,!0),n.nodeChanged()}))},x_=function(n){n.addCommand("mceApplyTextcolor",(function(t,e){b_(n,t,e)})),n.addCommand("mceRemoveTextcolor",(function(t){y_(n,t)}))},w_=function(n){return Math.max(5,Math.ceil(Math.sqrt(n)))},S_=function(n){var t=g_(n),e=w_(t.length);return l_(n,e)},k_=function(n){var t="choiceitem",e={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},o={type:t,text:"Custom color",icon:"color-picker",value:"custom"};return n?[e,o]:[e]},C_=function(n,t,e,o){if("custom"===e){var r=B_(n);r((function(e){e.each((function(e){v_(e),n.execCommand("mceApplyTextcolor",t,e),o(e)}))}),"#000000")}else"remove"===e?(o(""),n.execCommand("mceRemoveTextcolor",t)):(o(e),n.execCommand("mceApplyTextcolor",t,e))},O_=function(n,t){return n.concat(p_().concat(k_(t)))},__=function(n,t){return function(e){e(O_(n,t))}},T_=function(n,t,e){var o="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";n.setIconFill(o,e)},E_=function(n,t,e,o,r){n.ui.registry.addSplitButton(t,{tooltip:o,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:function(t){var o=R.from(h_(n,e));return o.bind((function(n){return qO(n).map((function(n){var e=PO(n).value;return po(t.toLowerCase(),e)}))})).getOr(!1)},columns:S_(n),fetch:__(g_(n),d_(n)),onAction:function(t){null!==r.get()&&C_(n,e,r.get(),p)},onItemAction:function(o,i){C_(n,e,i,(function(e){r.set(e),e_(n,{name:t,color:e})}))},onSetup:function(e){null!==r.get()&&T_(e,t,r.get());var o=function(n){n.name===t&&T_(e,n.name,n.color)};return n.on("TextColorChange",o),function(){n.off("TextColorChange",o)}}})},D_=function(n,t,e,o){n.ui.registry.addNestedMenuItem(t,{text:o,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){C_(n,e,t.value,p)}}]}})},B_=function(n){return function(t,e){var o=!1,r=function(e){var r=e.getData(),i=r.colorpicker;o?(t(R.from(i)),e.close()):n.windowManager.alert(n.translate(["Invalid hex color code: {0}",i]))},i=function(n,t){"hex-valid"===t.name&&(o=t.value)},u={colorpicker:e};n.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:u,onAction:i,onSubmit:r,onClose:p,onCancel:function(){t(R.none())}})}},A_=function(n){x_(n);var t=Ke(null),e=Ke(null);E_(n,"forecolor","forecolor","Text color",t),E_(n,"backcolor","hilitecolor","Background color",e),D_(n,"forecolor","forecolor","Text color"),D_(n,"backcolor","hilitecolor","Background color")},M_=function(n,t,e,o,r,i,u,a){var c=US(t),s="color"!==r?"normal":"color",f=F_(t,e,o,s,i,u,a);return XS(n,c,f,o,r)},F_=function(n,t,e,o,r,i,u){return sv(G(n,(function(a){return"choiceitem"===a.type?ok(a).fold(WS,(function(c){return R.some(EO(c,1===e,o,t,i(a.value),r,u,US(n)))})):R.none()})))},I_=function(n,t){var e=FS(t);if(1===n)return{mode:"menu",moveOnTab:!0};if("auto"===n)return{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}};var o="color"===t?"tox-swatches__row":"tox-collection__group";return{mode:"matrix",rowSelector:"."+o}},R_=function(n,t){return 1===n?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===n?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===t?".tox-swatches__row":".tox-collection__group",cell:"color"===t?"."+lS:"."+fS}}},V_=function(n,t){var e=O_(t.colorinput.getColors(),t.colorinput.hasCustomColors()),o=t.colorinput.getColorCols(),r="color",i=M_(Pu("menu-value"),e,(function(t){n.onAction({value:t})}),o,r,cS.CLOSE_ON_EXECUTE,C,t.shared.providers),u=T(T({},i),{markers:FS(r),movement:I_(o,r)});return{type:"widget",data:{value:Pu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[DO.widget(Sx.sketch(u))]}},P_=Pu("cell-over"),H_=Pu("cell-execute"),z_=function(n,t,e){var o,r=function(e){return li(e,P_,{row:n,col:t})},i=function(e){return li(e,H_,{row:n,col:t})},u=function(n,t){t.stop(),i(n)};return yc({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:Lf([ky("insert-table-picker-cell",[xi(Tr(),My.focus),xi(Ur(),i),xi(Ir(),u),xi(Gr(),u)]),$y.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),My.config({onFocus:r})])})},N_=function(n,t,e){for(var o=[],r=0;r<t;r++){for(var i=[],u=0;u<e;u++)i.push(z_(r,u,n));o.push(i)}return o},L_=function(n,t,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)$y.set(n[i][u],i<=t&&u<=e)},j_=function(n){return en(n,(function(n){return G(n,xc)}))},U_=function(n,t){return vc(t+1+"x"+(n+1))},W_=function(n){var t=10,e=10,o=Pu("size-label"),r=N_(o,t,e),i=Qx({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:o}},components:[vc("0x0")],behaviours:Lf([wy.config({})])});return{type:"widget",data:{value:Pu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[DO.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:j_(r).concat(i.asSpec()),behaviours:Lf([ky("insert-table-picker",[_i(P_,(function(n,o,u){var a=u.event.row,c=u.event.col;L_(r,a,c,t,e),wy.set(i.get(n),[U_(a,c)])})),_i(H_,(function(t,e,o){n.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),fi(t,Yr())}))]),ly.config({initSize:{numRows:t,numColumns:e},mode:"flatgrid",selector:'[role="button"]'})])})]}},G_={inserttable:W_,colorswatch:V_},X_=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)?R.some(n[t]):R.none()},Y_=function(n,t){return X_(G_,n.fancytype).map((function(e){return e(n,t)}))},q_=function(n,t,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1);var i=r?mO(e.icons):dO(e.icons),u=function(n){return{isDisabled:function(){return Jk.isDisabled(n)},setDisabled:function(t){return Jk.set(n,t)}}},a=wO({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:R.none(),ariaLabel:n.text,caret:R.some(i),checkMark:R.none(),shortcutContent:n.shortcut},e,o);return eO({data:oO(n),getApi:u,disabled:n.disabled,onAction:p,onSetup:n.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,t,e)},K_=function(n,t,e,o){void 0===o&&(o=!0);var r=function(n){return{isDisabled:function(){return Jk.isDisabled(n)},setDisabled:function(t){return Jk.set(n,t)}}},i=wO({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:R.none(),ariaLabel:n.text,caret:R.none(),checkMark:R.none(),shortcutContent:n.shortcut},e,o);return eO({data:oO(n),getApi:r,disabled:n.disabled,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,t,e)},J_=function(n){var t=n.text.fold((function(){return{}}),(function(n){return{innerHtml:n}}));return{type:"separator",dom:T({tag:"div",classes:[fS,gS]},t),components:[]}},$_=function(n,t,e,o){void 0===o&&(o=!0);var r=function(n){return{setActive:function(t){$y.set(n,t)},isActive:function(){return $y.isOn(n)},isDisabled:function(){return Jk.isDisabled(n)},setDisabled:function(t){return Jk.set(n,t)}}},i=wO({iconContent:n.icon,textContent:n.text,htmlContent:R.none(),ariaLabel:n.text,checkMark:R.some(lO(e.icons)),caret:R.none(),shortcutContent:n.shortcut,presets:"normal",meta:n.meta},e,o);return Kn(eO({data:oO(n),disabled:n.disabled,getApi:r,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,t,e),{toggling:{toggleClass:mS,toggleOnExecute:!1,selected:n.active}})},Q_=OO,Z_=J_,nT=K_,tT=q_,eT=$_,oT=Y_,rT=TO;(function(n){n[n["ContentFocus"]=0]="ContentFocus",n[n["UiFocus"]=1]="UiFocus"})(u_||(u_={}));var iT=function(n,t,e,o,r){var i=e.shared.providers,u=function(n){return r?T(T({},n),{shortcut:R.none(),icon:n.text.isSome()?R.none():n.icon}):n};switch(n.type){case"menuitem":return ck(n).fold(WS,(function(n){return R.some(nT(u(n),t,i,o))}));case"nestedmenuitem":return fk(n).fold(WS,(function(n){return R.some(tT(u(n),t,i,o,r))}));case"togglemenuitem":return dk(n).fold(WS,(function(n){return R.some(eT(u(n),t,i,o))}));case"separator":return Pw(n).fold(WS,(function(n){return R.some(Z_(n))}));case"fancymenuitem":return uk(n).fold(WS,(function(n){return oT(u(n),e)}));default:return R.none()}},uT=function(n,t,e,o,r,i,u){var a=1===o,c=!a||US(n);return sv(G(n,(function(n){switch(n.type){case"separator":return Nw(n).fold(WS,(function(n){return R.some(Z_(n))}));case"cardmenuitem":return tk(n).fold(WS,(function(n){return R.some(rT(T(T({},n),{onAction:function(t){n.onAction(t),e(n.value,n.meta)}}),r,i,{itemBehaviours:SO(n.meta,i),cardText:{matchText:t,highlightOn:u}}))}));case"autocompleteitem":default:return Lw(n).fold(WS,(function(n){return R.some(Q_(n,t,a,"normal",e,r,i,c))}))}})))},aT=function(n,t,e,o,r){var i=US(t),u=sv(G(t,(function(n){var t=function(n){return r?!n.hasOwnProperty("text"):i},u=function(n){return iT(n,e,o,t(n),r)};return"nestedmenuitem"===n.type&&n.getSubmenuItems().length<=0?u(T(T({},n),{disabled:!0})):u(n)}))),a=r?GS:XS;return a(n,i,u,1,"normal")},cT=function(n){return Ix.singleData(n.value,n)},sT=function(n,t,e,o){var r=e===u_.ContentFocus?ch():ah(),i=I_(t,o),u=FS(o);return{dom:n.dom,components:n.components,items:n.items,value:n.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===u_.ContentFocus,focusManager:r,menuBehaviours:vk.unnamedEvents("auto"!==t?[]:[Bi((function(n,t){mk(n,4,u.item).each((function(t){var e=t.numColumns,o=t.numRows;ly.setGridSize(n,o,e)}))}))])}},fT=function(n,t){var e=Ke(R.none()),o=Ke(!1),r=yc(Px.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:Lf([ky("dismissAutocompleter",[xi(ei(),(function(){return c()}))])]),lazySink:t.getSink})),i=function(){return Px.isOpen(r)},u=function(){return e.get().isSome()},a=function(){u()&&Px.hide(r)},c=function(){if(u()){var t=e.get().map((function(n){return n.element}));pw(t.getOr(to.fromDom(n.selection.getNode()))).each(hu),a(),e.set(R.none()),o.set(!1)}},s=$n((function(){return uS(n)})),f=function(e,r){var i=mn(r,(function(n){return R.from(n.columns)})).getOr(1);return en(r,(function(r){var u=r.items;return uT(u,r.matchText,(function(t,i){var u=n.selection.getRng();Sw(n.dom,u,e).fold((function(){}),(function(n){var e=n.range,u={hide:function(){c()},reload:function(n){a(),g(n)}};o.set(!0),r.onAction(u,e,t,i),o.set(!1)}))}),i,cS.BUBBLE_TO_SANDBOX,t,r.highlightOn)}))},l=function(t){if(!u()){var r=gw(n,t.range);e.set(R.some({triggerChar:t.triggerChar,element:r,matchLength:t.text.length})),o.set(!1)}},d=function(t,e,o,i){t.matchLength=e.text.length;var u=mn(o,(function(n){return R.from(n.columns)})).getOr(1);Px.showAt(r,{anchor:"node",root:to.fromDom(n.getBody()),node:R.from(t.element)},Sx.sketch(sT(XS("autocompleter-value",!0,i,u,"normal"),u,u_.ContentFocus,"normal"))),Px.getContent(r).each(zv.highlightFirst)},m=function(t){return e.get().map((function(e){return Sw(n.dom,n.selection.getRng(),e.triggerChar).bind((function(e){return Rw(n,s,e,t)}))})).getOrThunk((function(){return Iw(n,s)}))},g=function(n){m(n).fold(c,(function(n){l(n.context),n.lookupData.then((function(t){e.get().map((function(e){var o=n.context;if(e.triggerChar===o.triggerChar){var r=f(o.triggerChar,t);r.length>0?d(e,o,t,r):o.text.length-e.matchLength>=10?c():a()}}))}))}))},p=sw((function(n){27!==n.which&&g()}),50),v={onKeypress:p,cancelIfNecessary:c,isMenuOpen:i,isActive:u,isProcessingAction:o.get,getView:function(){return Px.getContent(r)}};!1===n.hasPlugin("rtc")&&Cw.setup(v,n)},lT={register:fT},dT=O,mT=function(n,t,e){return Lc(n,t,dT,e)},gT=function(n,t,e){return jc(n,t,dT,e)},pT=Hc,vT=function(n,t,e){return ps(n,t,e).isSome()},hT=function(n,t){var e=null,o=function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){n.apply(null,o),e=null}),t)},r=function(){null!==e&&(clearTimeout(e),e=null)};return{cancel:r,schedule:o}},bT=5,yT=400,xT=function(n){var t=n.raw;return void 0===t.touches||1!==t.touches.length?R.none():R.some(t.touches[0])},wT=function(n,t){var e=Math.abs(n.clientX-t.x),o=Math.abs(n.clientY-t.y);return e>bT||o>bT},ST=function(n){var t=Ke(R.none()),e=Ke(!1),o=hT((function(t){n.triggerEvent(Xr(),t),e.set(!0)}),yT),r=function(n){return xT(n).each((function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:n.target};o.schedule(n),e.set(!1),t.set(R.some(i))})),R.none()},i=function(n){return o.cancel(),xT(n).each((function(n){t.get().each((function(e){wT(n,e)&&t.set(R.none())}))})),R.none()},u=function(r){o.cancel();var i=function(n){return ir(n.target,r.target)};return t.get().filter(i).map((function(t){return e.get()?(r.prevent(),!1):n.triggerEvent(Gr(),r)}))},a=lt([{key:yr(),value:r},{key:xr(),value:i},{key:wr(),value:u}]),c=function(n,t){return Nn(a,t).bind((function(t){return t(n)}))};return{fireIfReady:c}},kT=function(n){var t=n.raw;return t.which===Nv[0]&&!L(["input","textarea"],Ii(n.target))&&!vT(n.target,'[contenteditable="true"]')},CT=function(){return qo().browser.isFirefox()},OT=Ht([Oe("triggerEvent"),He("stopBackspace",!0)]),_T=function(n,t){return CT()?gT(n,"focus",t):mT(n,"focusin",t)},TT=function(n,t){return CT()?gT(n,"blur",t):mT(n,"focusout",t)},ET=function(n,t){var e=ie("Getting GUI events settings",OT,t),o=["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"],r=ST(e),i=G(o.concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(t){return mT(n,t,(function(n){r.fireIfReady(n,t).each((function(t){t&&n.kill()}));var o=e.triggerEvent(t,n);o&&n.kill()}))})),u=Ke(R.none()),a=mT(n,"paste",(function(n){r.fireIfReady(n,"paste").each((function(t){t&&n.kill()}));var t=e.triggerEvent("paste",n);t&&n.kill(),u.set(R.some(setTimeout((function(){e.triggerEvent(Lr(),n)}),0)))})),c=mT(n,"keydown",(function(n){var t=e.triggerEvent("keydown",n);t?n.kill():!0===e.stopBackspace&&kT(n)&&n.prevent()})),s=_T(n,(function(n){var t=e.triggerEvent("focusin",n);t&&n.kill()})),f=Ke(R.none()),l=TT(n,(function(n){var t=e.triggerEvent("focusout",n);t&&n.kill(),f.set(R.some(setTimeout((function(){e.triggerEvent(Nr(),n)}),0)))})),d=function(){X(i,(function(n){n.unbind()})),c.unbind(),s.unbind(),l.unbind(),a.unbind(),u.get().each(clearTimeout),f.get().each(clearTimeout)};return{unbind:d}},DT=function(n,t){var e=Nn(n,"target").getOr(t);return Ke(e)},BT=function(n,t){var e=Ke(!1),o=Ke(!1),r=function(){e.set(!0)},i=function(){o.set(!0)};return{stop:r,cut:i,isStopped:e.get,isCut:o.get,event:n,setSource:t.set,getSource:t.get}},AT=function(n){var t=Ke(!1),e=function(){t.set(!0)};return{stop:e,cut:p,isStopped:t.get,isCut:C,event:n,setSource:k("Cannot set source of a broadcasted event"),getSource:k("Cannot get source of a broadcasted event")}},MT=Wn.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),FT=function(n,t,e,o,r,i){var u=n(t,o),a=BT(e,r);return u.fold((function(){return i.logEventNoHandlers(t,o),MT.complete()}),(function(n){var e=n.descHandler,o=va(e);return o(a),a.isStopped()?(i.logEventStopped(t,n.element,e.purpose),MT.stopped()):a.isCut()?(i.logEventCut(t,n.element,e.purpose),MT.complete()):Gi(n.element).fold((function(){return i.logNoParent(t,n.element,e.purpose),MT.complete()}),(function(o){return i.logEventResponse(t,n.element,e.purpose),MT.resume(o)}))}))},IT=function(n,t,e,o,r,i){return FT(n,t,e,o,r,i).fold(O,(function(o){return IT(n,t,e,o,r,i)}),C)},RT=function(n,t,e,o,r){var i=DT(e,o);return FT(n,t,e,o,i,r)},VT=function(n,t,e){var o=AT(t);return X(n,(function(n){var t=n.descHandler,e=va(t);e(o)})),o.isStopped()},PT=function(n,t,e,o){return HT(n,t,e,e.target,o)},HT=function(n,t,e,o,r){var i=DT(e,o);return IT(n,t,e,o,i,r)},zT=function(n,t){return{element:n,descHandler:t}},NT=function(n,t){return{id:n,descHandler:t}},LT=function(){var n={},t=function(t,e,o){An(o,(function(o,r){var i=void 0!==n[r]?n[r]:{};i[e]=pa(o,t),n[r]=i}))},e=function(n,t){return Wu(t).fold((function(){return R.none()}),(function(e){return n.bind((function(n){return Nn(n,e)})).map((function(n){return zT(t,n)}))}))},o=function(t){return Nn(n,t).map((function(n){return Pn(n,(function(n,t){return NT(t,n)}))})).getOr([])},r=function(t,o,r){var i=Nn(n,o);return lr(r,(function(n){return e(i,n)}),t)},i=function(t){An(n,(function(n,e){n.hasOwnProperty(t)&&delete n[t]}))};return{registerId:t,unregisterId:i,filterByType:o,find:r}},jT=function(){var n=LT(),t={},e=function(n){var t=n.element;return Wu(t).fold((function(){return ju("uid-",n.element)}),(function(n){return n}))},o=function(n,e){var o=t[e];if(o!==n)throw new Error('The tagId "'+e+'" is already used by: '+Mu(o.element)+"\nCannot use it for: "+Mu(n.element)+"\nThe conflicting element is"+(Wa(o.element)?" ":" not ")+"already in the DOM");i(n)},r=function(r){var i=e(r);jn(t,i)&&o(r,i);var u=[r];n.registerId(u,i,r.events),t[i]=r},i=function(e){Wu(e.element).each((function(e){delete t[e],n.unregisterId(e)}))},u=function(t){return n.filterByType(t)},a=function(t,e,o){return n.find(t,e,o)},c=function(n){return Nn(t,n)};return{find:a,filter:u,register:r,unregister:i,getById:c}},UT=function(n){var t=n.dom,e=t.attributes,o=E(t,["attributes"]);return{uid:n.uid,dom:T({tag:"div",attributes:T({role:"presentation"},e)},o),components:n.components,behaviours:$g(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},WT=av({name:"Container",factory:UT,configFields:[He("components",[]),Jg("containerBehaviours",[]),He("events",{}),He("domModification",{}),He("eventOrder",{})]}),GT=function(n){var t=function(t){return Gi(n.element).fold(O,(function(n){return ir(t,n)}))},e=jT(),o=function(n,o){return e.find(t,n,o)},r=ET(n.element,{triggerEvent:function(n,t){return Es(n,t.target,(function(e){return PT(o,n,t,e)}))}}),i={debugInfo:y("real"),triggerEvent:function(n,t,e){Es(n,t,(function(r){return HT(o,n,e,t,r)}))},triggerFocus:function(n,t){Wu(n).fold((function(){$f(n)}),(function(e){Es(zr(),n,(function(e){return RT(o,zr(),{originator:t,kill:p,prevent:p,target:n},n,e),!1}))}))},triggerEscape:function(n,t){i.triggerEvent("keydown",n.element,t.event)},getByUid:function(n){return v(n)},getByDom:function(n){return h(n)},build:yc,addToGui:function(n){c(n)},removeFromGui:function(n){s(n)},addToWorld:function(n){u(n)},removeFromWorld:function(n){a(n)},broadcast:function(n){d(n)},broadcastOn:function(n,t){m(n,t)},broadcastEvent:function(n,t){g(n,t)},isConnected:O},u=function(n){n.connect(i),Hi(n.element)||(e.register(n),X(n.components(),u),i.triggerEvent(Kr(),n.element,{target:n.element}))},a=function(n){Hi(n.element)||(X(n.components(),a),e.unregister(n)),n.disconnect()},c=function(t){zm(n,t)},s=function(n){jm(n)},f=function(){r.unbind(),vu(n.element)},l=function(n){var t=e.filter(jr());X(t,(function(t){var e=t.descHandler,o=va(e);o(n)}))},d=function(n){l({universal:!0,data:n})},m=function(n,t){l({universal:!1,channels:n,data:t})},g=function(n,t){var o=e.filter(n);return VT(o,t)},v=function(n){return e.getById(n).fold((function(){return hn.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),hn.value)},h=function(n){var t=Wu(n).getOr("not found");return v(t)};return u(n),{root:n,element:n.element,destroy:f,add:c,remove:s,getByUid:v,getByDom:h,addToWorld:u,removeFromWorld:a,broadcast:d,broadcastOn:m,broadcastEvent:g}},XT=function(n,t){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:G(n.items,t.interpreter)}},YT=y([He("prefix","form-field"),Jg("fieldBehaviours",[yv,Kg])]),qT=y([Bp({schema:[ye("dom")],name:"label"}),Bp({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[ye("text")],name:"aria-descriptor"}),Ep({factory:{sketch:function(n){var t=st(n,["factory"]);return n.factory.sketch(t)}},schema:[ye("factory")],name:"field"})]),KT=function(n,t,e,o){var r=Qg(n.fieldBehaviours,[yv.config({find:function(t){return Up(t,n,"field")}}),Kg.config({store:{mode:"manual",getValue:function(n){return yv.getCurrent(n).bind(Kg.getValue)},setValue:function(n,t){yv.getCurrent(n).each((function(n){Kg.setValue(n,t)}))}}})]),i=vi([Bi((function(t,e){var o=Gp(t,n,["label","field","aria-descriptor"]);o.field().each((function(t){var e=Pu(n.prefix);o.label().each((function(n){ku(n.element,"for",e),ku(t.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=Pu(n.prefix);ku(e.element,"id",o),ku(t.element,"aria-describedby",o)}))}))}))]),u={getField:function(t){return Up(t,n,"field")},getLabel:function(t){return Up(t,n,"label")}};return{uid:n.uid,dom:n.dom,components:t,behaviours:r,events:i,apis:u}},JT=cv({name:"FormField",configFields:YT(),partFields:qT(),factory:KT,apis:{getField:function(n,t){return n.getField(t)},getLabel:function(n,t){return n.getLabel(t)}}}),$T=function(n,t){return sa({attributes:lt([{key:t.tabAttr,value:"true"}])})},QT=Object.freeze({__proto__:null,exhibit:$T}),ZT=[He("tabAttr","data-alloy-tabstop")],nE=Uf({fields:ZT,name:"tabstopping",active:QT}),tE=tinymce.util.Tools.resolve("tinymce.html.Entities"),eE=function(n,t,e,o){var r=rE(n,t,e,o);return JT.sketch(r)},oE=function(n,t){return eE(n,t,[],[])},rE=function(n,t,e,o){return{dom:uE(e),components:n.toArray().concat([t]),fieldBehaviours:Lf(o)}},iE=function(){return uE([])},uE=function(n){return{tag:"div",classes:["tox-form__group"].concat(n)}},aE=function(n,t){return JT.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}})},cE=Pu("form-component-change"),sE=Pu("form-close"),fE=Pu("form-cancel"),lE=Pu("form-action"),dE=Pu("form-submit"),mE=Pu("form-block"),gE=Pu("form-unblock"),pE=Pu("form-tabchange"),vE=Pu("form-resize"),hE=function(n,t){var e,o=n.label.map((function(n){return aE(n,t)})),r=function(n){return function(t,e){ps(e.event.target,"[data-collection-item-value]").each((function(o){n(t,e,o,Ou(o,"data-collection-item-value"))}))}},i=function(e,o){var r=G(o,(function(e){var o=Ak.translate(e.text),r=1===n.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,(function(n){return u[n]})),c=t.isDisabled()?" tox-collection__item--state-disabled":"";return'<div class="tox-collection__item'+c+'" tabindex="-1" data-collection-item-value="'+tE.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),i="auto"!==n.columns&&n.columns>1?W(r,n.columns):[r],u=G(i,(function(n){return'<div class="tox-collection__group">'+n.join("")+"</div>"}));xu(e.element,u.join(""))},u=r((function(e,o,r,i){o.stop(),t.isDisabled()||li(e,lE,{name:n.name,value:i})})),a=[xi(Tr(),r((function(n,t,e){$f(e)}))),xi(Ir(),u),xi(Gr(),u),xi(Er(),r((function(n,t,e){gs(n.element,"."+xS).each((function(n){za(n,xS)})),Pa(e,xS)}))),xi(Dr(),r((function(n){gs(n.element,"."+xS).each((function(n){za(n,xS)}))}))),Fi(r((function(t,e,o,r){li(t,lE,{name:n.name,value:r})})))],c=function(n,t){return G($d(n.element,".tox-collection__item"),t)},s=JT.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==n.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:x},behaviours:Lf([Jk.config({disabled:t.isDisabled,onDisabled:function(n){c(n,(function(n){Pa(n,"tox-collection__item--state-disabled"),ku(n,"aria-disabled",!0)}))},onEnabled:function(n){c(n,(function(n){za(n,"tox-collection__item--state-disabled"),Eu(n,"aria-disabled")}))}}),WC(),wy.config({}),Kg.config({store:{mode:"memory",initialValue:[]},onSetValue:function(t,e){i(t,e),"auto"===n.columns&&mk(t,5,"tox-collection__item").each((function(n){var e=n.numRows,o=n.numColumns;ly.setGridSize(t,e,o)})),fi(t,vE)}}),nE.config({}),ly.config(R_(n.columns,"normal")),ky("collection-events",a)]),eventOrder:(e={},e[Ur()]=["disabling","alloy.base.behaviour","collection-events"],e)}),f=["tox-form__group--collection"];return eE(o,s,f,[])},bE=y([Be("data"),He("inputAttributes",{}),He("inputStyles",{}),He("tag","input"),He("inputClasses",[]),Hs("onSetValue"),He("styles",{}),He("eventOrder",{}),Jg("inputBehaviours",[Kg,My]),He("selectOnFocus",!0)]),yE=function(n){return Lf([My.config({onFocus:n.selectOnFocus?function(n){var t=n.element,e=ic(t);t.dom.setSelectionRange(0,e.length)}:p})])},xE=function(n){return T(T({},yE(n)),Qg(n.inputBehaviours,[Kg.config({store:T(T({mode:"manual"},n.data.map((function(n){return{initialValue:n}})).getOr({})),{getValue:function(n){return ic(n.element)},setValue:function(n,t){var e=ic(n.element);e!==t&&uc(n.element,t)}}),onSetValue:n.onSetValue})]))},wE=function(n){return{tag:n.tag,attributes:T({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses}},SE=function(n,t){return{uid:n.uid,dom:wE(n),components:[],behaviours:xE(n),eventOrder:n.eventOrder}},kE=av({name:"Input",configFields:bE(),factory:SE}),CE={},OE={exports:CE};(function(t,e,o,r){(function(r){if("object"===typeof e&&"undefined"!==typeof o)o.exports=r();else if("function"===typeof t&&t.amd)t([],r);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof n?n:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=r()}})((function(){return function(){function n(t,e,o){function i(a,c){if(!e[a]){if(!t[a]){var s="function"==typeof r&&r;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=e[a]={exports:{}};t[a][0].call(l.exports,(function(n){var e=t[a][1][n];return i(e||n)}),l,l.exports,n,t,e,o)}return e[a].exports}for(var u="function"==typeof r&&r,a=0;a<o.length;a++)i(o[a]);return i}return n}()({1:[function(n,t,e){var o,r,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(n){if(o===setTimeout)return setTimeout(n,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(n,0);try{return o(n,0)}catch(t){try{return o.call(null,n,0)}catch(t){return o.call(this,n,0)}}}function s(n){if(r===clearTimeout)return clearTimeout(n);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(n);try{return r(n)}catch(t){try{return r.call(null,n)}catch(t){return r.call(this,n)}}}(function(){try{o="function"===typeof setTimeout?setTimeout:u}catch(n){o=u}try{r="function"===typeof clearTimeout?clearTimeout:a}catch(n){r=a}})();var f,l=[],d=!1,m=-1;function g(){d&&f&&(d=!1,f.length?l=f.concat(l):m=-1,l.length&&p())}function p(){if(!d){var n=c(g);d=!0;var t=l.length;while(t){f=l,l=[];while(++m<t)f&&f[m].run();m=-1,t=l.length}f=null,d=!1,s(n)}}function v(n,t){this.fun=n,this.array=t}function h(){}i.nextTick=function(n){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];l.push(new v(n,t)),1!==l.length||d||c(p)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,t,e){(function(n){(function(e){var o=setTimeout;function r(){}function i(n,t){return function(){n.apply(t,arguments)}}function u(n){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(n,this)}function a(n,t){while(3===n._state)n=n._value;0!==n._state?(n._handled=!0,u._immediateFn((function(){var e=1===n._state?t.onFulfilled:t.onRejected;if(null!==e){var o;try{o=e(n._value)}catch(r){return void s(t.promise,r)}c(t.promise,o)}else(1===n._state?c:s)(t.promise,n._value)}))):n._deferreds.push(t)}function c(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===typeof t||"function"===typeof t)){var e=t.then;if(t instanceof u)return n._state=3,n._value=t,void f(n);if("function"===typeof e)return void d(i(e,t),n)}n._state=1,n._value=t,f(n)}catch(o){s(n,o)}}function s(n,t){n._state=2,n._value=t,f(n)}function f(n){2===n._state&&0===n._deferreds.length&&u._immediateFn((function(){n._handled||u._unhandledRejectionFn(n._value)}));for(var t=0,e=n._deferreds.length;t<e;t++)a(n,n._deferreds[t]);n._deferreds=null}function l(n,t,e){this.onFulfilled="function"===typeof n?n:null,this.onRejected="function"===typeof t?t:null,this.promise=e}function d(n,t){var e=!1;try{n((function(n){e||(e=!0,c(t,n))}),(function(n){e||(e=!0,s(t,n))}))}catch(o){if(e)return;e=!0,s(t,o)}}u.prototype["catch"]=function(n){return this.then(null,n)},u.prototype.then=function(n,t){var e=new this.constructor(r);return a(this,new l(n,t,e)),e},u.all=function(n){var t=Array.prototype.slice.call(n);return new u((function(n,e){if(0===t.length)return n([]);var o=t.length;function r(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(n){r(i,n)}),e)}t[i]=u,0===--o&&n(t)}catch(c){e(c)}}for(var i=0;i<t.length;i++)r(i,t[i])}))},u.resolve=function(n){return n&&"object"===typeof n&&n.constructor===u?n:new u((function(t){t(n)}))},u.reject=function(n){return new u((function(t,e){e(n)}))},u.race=function(n){return new u((function(t,e){for(var o=0,r=n.length;o<r;o++)n[o].then(t,e)}))},u._immediateFn="function"===typeof n?function(t){n(t)}:function(n){o(n,0)},u._unhandledRejectionFn=function(n){"undefined"!==typeof console&&console},u._setImmediateFn=function(n){u._immediateFn=n},u._setUnhandledRejectionFn=function(n){u._unhandledRejectionFn=n},"undefined"!==typeof t&&t.exports?t.exports=u:e.Promise||(e.Promise=u)})(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(t,o){var r=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(n,t){this._id=n,this._clearFn=t}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;t>=0&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),t))},e.setImmediate="function"===typeof t?t:function(n){var t=c++,o=!(arguments.length<2)&&u.call(arguments,1);return a[t]=!0,r((function(){a[t]&&(o?n.apply(null,o):n.call(null),e.clearImmediate(t))})),t},e.clearImmediate="function"===typeof o?o:function(n){delete a[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var o=n("promise-polyfill"),r=function(){return"undefined"!==typeof window?window:Function("return this;")()}();t.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,CE,OE,void 0);var _E,TE=OE.exports.boltExport,EE=function(n){var t=R.none(),e=[],o=function(n){return EE((function(t){r((function(e){t(n(e))}))}))},r=function(n){u()?c(n):e.push(n)},i=function(n){u()||(t=R.some(n),a(e),e=[])},u=function(){return t.isSome()},a=function(n){X(n,c)},c=function(n){t.each((function(t){setTimeout((function(){n(t)}),0)}))};return n(i),{get:r,map:o,isReady:u}},DE=function(n){return EE((function(t){t(n)}))},BE={nu:EE,pure:DE},AE=function(n){setTimeout((function(){throw n}),0)},ME=function(n){var t=function(t){n().then(t,AE)},e=function(t){return ME((function(){return n().then(t)}))},o=function(t){return ME((function(){return n().then((function(n){return t(n).toPromise()}))}))},r=function(t){return ME((function(){return n().then((function(){return t.toPromise()}))}))},i=function(){return BE.nu(t)},u=function(){var t=null;return ME((function(){return null===t&&(t=n()),t}))},a=n;return{map:e,bind:o,anonBind:r,toLazy:i,toCached:u,toPromise:a,get:t}},FE=function(n){return ME((function(){return new TE(n)}))},IE=function(n){return ME((function(){return TE.resolve(n)}))},RE={nu:FE,pure:IE},VE=["input","textarea"],PE=function(n){var t=Ii(n);return L(VE,t)},HE=function(n,t){var e=t.getRoot(n).getOr(n.element);za(e,t.invalidClass),t.notify.each((function(t){PE(n.element)&&ku(n.element,"aria-invalid",!1),t.getContainer(n).each((function(n){xu(n,t.validHtml)})),t.onValid(n)}))},zE=function(n,t,e,o){var r=t.getRoot(n).getOr(n.element);Pa(r,t.invalidClass),t.notify.each((function(t){PE(n.element)&&ku(n.element,"aria-invalid",!0),t.getContainer(n).each((function(n){xu(n,o)})),t.onInvalid(n,o)}))},NE=function(n,t,e){return t.validator.fold((function(){return RE.pure(hn.value(!0))}),(function(t){return t.validate(n)}))},LE=function(n,t,e){return t.notify.each((function(t){t.onValidate(n)})),NE(n,t).map((function(o){return n.getSystem().isConnected()?o.fold((function(o){return zE(n,t,e,o),hn.error(o)}),(function(e){return HE(n,t),hn.value(e)})):hn.error("No longer in system")}))},jE=function(n,t){var e=t.getRoot(n).getOr(n.element);return Na(e,t.invalidClass)},UE=Object.freeze({__proto__:null,markValid:HE,markInvalid:zE,query:NE,run:LE,isInvalid:jE}),WE=function(n,t){return n.validator.map((function(e){return vi([xi(e.onEvent,(function(e){LE(e,n,t).get(x)}))].concat(e.validateOnLoad?[Bi((function(e){LE(e,n,t).get(p)}))]:[]))})).getOr({})},GE=Object.freeze({__proto__:null,events:WE}),XE=[ye("invalidClass"),He("getRoot",R.none),Ve("notify",[He("aria","alert"),He("getContainer",R.none),He("validHtml",""),Hs("onValid"),Hs("onInvalid"),Hs("onValidate")]),Ve("validator",[ye("validate"),He("onEvent","input"),He("validateOnLoad",!0)])],YE=Uf({fields:XE,name:"invalidating",active:GE,apis:UE,extra:{validation:function(n){return function(t){var e=Kg.getValue(t);return RE.pure(n(e))}}}}),qE=function(n,t,e,o){return e.getOrCreate(n,t,o)},KE=Object.freeze({__proto__:null,getCoupled:qE}),JE=[xe("others",te(hn.value,fe()))],$E=function(){var n={},t=function(t,e,o){var r=Dn(e.others);if(r)return Nn(n,o).getOrThunk((function(){var r=Nn(e.others,o).getOrDie("No information found for coupled component: "+o),i=r(t),u=t.getSystem().build(i);return n[o]=u,u}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))},e=y({});return ra({readState:e,getOrCreate:t})},QE=Object.freeze({__proto__:null,init:$E}),ZE=Uf({fields:JE,name:"coupling",apis:KE,state:QE}),nD=y("sink"),tD=y(Bp({name:nD(),overrides:y({dom:{tag:"div"},behaviours:Lf([Fm.config({useFixed:O})]),events:vi([Ti(Br()),Ti(kr()),Ti(Ir())])})}));(function(n){n[n["HighlightFirst"]=0]="HighlightFirst",n[n["HighlightNone"]=1]="HighlightNone"})(_E||(_E={}));var eD,oD=function(n,t){var e=n.getHotspot(t).getOr(t),o="hotspot",r=n.getAnchorOverrides();return n.layouts.fold((function(){return{anchor:o,hotspot:e,overrides:r}}),(function(n){return{anchor:o,hotspot:e,overrides:r,layouts:n}}))},rD=function(n,t,e){var o=n.fetch;return o(e).map(t)},iD=function(n,t,e,o,r,i,u){var a=rD(n,t,o),c=fD(o,n);return a.map((function(n){return n.bind((function(n){return R.from(Ix.sketch(T(T({},i.menu()),{uid:Gu(""),data:n,highlightImmediately:u===_E.HighlightFirst,onOpenMenu:function(n,t){var o=c().getOrDie();Fm.position(o,e,t),mg.decloak(r)},onOpenSubmenu:function(n,t,e){var o=c().getOrDie();Fm.position(o,{anchor:"submenu",item:t},e),mg.decloak(r)},onRepositionMenu:function(n,t,o){var r=c().getOrDie();Fm.position(r,e,t),X(o,(function(n){Fm.position(r,{anchor:"submenu",item:n.triggeringItem},n.triggeredMenu)}))},onEscape:function(){return My.focus(o),mg.close(r),R.some(!0)}})))}))}))},uD=function(n,t,e,o,r,i,u){var a=oD(n,e),c=iD(n,t,a,e,o,r,u);return c.map((function(n){return n.fold((function(){mg.isOpen(o)&&mg.close(o)}),(function(n){mg.cloak(o),mg.open(o,n),i(o)})),o}))},aD=function(n,t,e,o,r,i,u){return mg.close(o),RE.pure(o)},cD=function(n,t,e,o,r,i){var u=ZE.getCoupled(e,"sandbox"),a=mg.isOpen(u),c=a?aD:uD;return c(n,t,e,u,o,r,i)},sD=function(n,t,e){var o=yv.getCurrent(t).getOr(t),r=Ic(n.element);e?Ka(o.element,"min-width",r+"px"):Fc(o.element,r)},fD=function(n,t){return n.getSystem().getByUid(t.uid+"-"+nD()).map((function(n){return function(){return hn.value(n)}})).getOrThunk((function(){return t.lazySink.fold((function(){return function(){return hn.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(t){return function(){return t(n)}}))}))},lD=function(n){mg.getState(n).each((function(n){Ix.repositionMenus(n)}))},dD=function(n,t,e){var o=hs(),r=function(r,i){var u=oD(n,t);o.link(t.element),n.matchWidth&&sD(u.hotspot,i,n.useMinWidth),n.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},i=function(n,r){o.unlink(t.element),void 0!==e&&void 0!==e.onClose&&e.onClose(n,r)},u=fD(t,n);return{dom:{tag:"div",classes:n.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Zg.augment(n.sandboxBehaviours,[Kg.config({store:{mode:"memory",initialValue:t}}),mg.config({onOpen:r,onClose:i,isPartOf:function(n,e,o){return ys(e,o)||ys(t,o)},getAttachPoint:function(){return u().getOrDie()}}),yv.config({find:function(n){return mg.getState(n).bind((function(n){return yv.getCurrent(n)}))}}),Yf.config({channels:T(T({},bg({isExtraPart:C})),xg({doReposition:lD}))})])}},mD=function(n){var t=ZE.getCoupled(n,"sandbox");lD(t)},gD=function(){return[He("sandboxClasses",[]),Zg.field("sandboxBehaviours",[yv,Yf,mg,Kg])]},pD=y([ye("dom"),ye("fetch"),Hs("onOpen"),zs("onExecute"),He("getHotspot",R.some),He("getAnchorOverrides",y({})),Ul(),Jg("dropdownBehaviours",[$y,ZE,ly,My]),ye("toggleClass"),He("eventOrder",{}),Be("lazySink"),He("matchWidth",!1),He("useMinWidth",!1),Be("role")].concat(gD())),vD=y([Dp({schema:[Rs()],name:"menu",defaults:function(n){return{onExecute:n.onExecute}}}),tD()]),hD=function(n,t,e,o){var r,i=function(t){return Nn(n.dom,"attributes").bind((function(n){return Nn(n,t)}))},u=function(n){mg.getState(n).each((function(n){Ix.highlightPrimary(n)}))},a=function(t){var e=u;cD(n,(function(n){return n}),t,o,e,_E.HighlightFirst).get(p)},c={expand:function(t){$y.isOn(t)||cD(n,(function(n){return n}),t,o,p,_E.HighlightNone).get(p)},open:function(t){$y.isOn(t)||cD(n,(function(n){return n}),t,o,p,_E.HighlightFirst).get(p)},isOpen:$y.isOn,close:function(t){$y.isOn(t)&&cD(n,(function(n){return n}),t,o,p,_E.HighlightFirst).get(p)},repositionMenus:function(n){$y.isOn(n)&&mD(n)}},s=function(n,t){return di(n),R.some(!0)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.dropdownBehaviours,[$y.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),ZE.config({others:{sandbox:function(t){return dD(n,t,{onOpen:function(){return $y.on(t)},onClose:function(){return $y.off(t)}})}}}),ly.config({mode:"special",onSpace:s,onEnter:s,onDown:function(n,t){if(bD.isOpen(n)){var e=ZE.getCoupled(n,"sandbox");u(e)}else bD.open(n);return R.some(!0)},onEscape:function(n,t){return bD.isOpen(n)?(bD.close(n),R.some(!0)):R.none()}}),My.config({})]),events:Zy(R.some(a)),eventOrder:T(T({},n.eventOrder),(r={},r[Ur()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:c,domModification:{attributes:T(T({"aria-haspopup":"true"},n.role.fold((function(){return{}}),(function(n){return{role:n}}))),"button"===n.dom.tag?{type:i("type").getOr("button")}:{})}}},bD=cv({name:"Dropdown",configFields:pD(),partFields:vD(),factory:hD,apis:{open:function(n,t){return n.open(t)},expand:function(n,t){return n.expand(t)},close:function(n,t){return n.close(t)},isOpen:function(n,t){return n.isOpen(t)},repositionMenus:function(n,t){return n.repositionMenus(t)}}}),yD=function(){return sa({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})},xD=function(){return vi([hi(Vr(),O)])},wD=Object.freeze({__proto__:null,events:xD,exhibit:yD}),SD=Uf({fields:[],name:"unselecting",active:wD}),kD=function(n,t){return bD.sketch({dom:n.dom,components:n.components,toggleClass:"mce-active",dropdownBehaviours:Lf([KC.button(t.providers.isDisabled),WC(),SD.config({}),nE.config({})]),layouts:n.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:function(e){return RE.nu((function(t){return n.fetch(t)})).map((function(o){return R.from(cT(Kn(M_(Pu("menu-value"),o,(function(t){n.onItemAction(e,t)}),n.columns,n.presets,cS.CLOSE_ON_EXECUTE,C,t.providers),{movement:I_(n.columns,n.presets)})))}))},parts:{menu:VS(!1,1,n.presets)}})},CD=Pu("color-input-change"),OD=Pu("color-swatch-change"),_D=Pu("color-picker-cancel"),TD=function(n,t,e){var o=JT.parts.field({factory:kE,inputClasses:["tox-textfield"],onSetValue:function(n){return YE.run(n).get(p)},inputBehaviours:Lf([Jk.config({disabled:t.providers.isDisabled}),WC(),nE.config({}),YE.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(n){return Gi(n.element)},notify:{onValid:function(n){var t=Kg.getValue(n);li(n,CD,{color:t})}},validator:{validateOnLoad:!1,validate:function(n){var t=Kg.getValue(n);if(0===t.length)return RE.pure(hn.value(!0));var e=to.fromTag("span");Ka(e,"background-color",t);var o=nc(e,"background-color").fold((function(){return hn.error("blah")}),(function(n){return hn.value(t)}));return RE.pure(o)}}})]),selectOnFocus:!1}),r=n.label.map((function(n){return aE(n,t.providers)})),i=function(n,t){li(n,OD,{value:t})},u=function(n,t){a.getOpt(n).each((function(n){"custom"===t?e.colorPicker((function(t){t.fold((function(){return fi(n,_D)}),(function(t){i(n,t),v_(t)}))}),"#ffffff"):i(n,"remove"===t?"":t)}))},a=Qx(kD({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[hf,vf,wf]},onLtr:function(){return[vf,hf,wf]}},components:[],fetch:__(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:u},t));return JT.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,a.asSpec()]}]),fieldBehaviours:Lf([ky("form-field-events",[xi(CD,(function(t,e){a.getOpt(t).each((function(n){Ka(n.element,"background-color",e.event.color)})),li(t,cE,{name:n.name})})),xi(OD,(function(n,t){JT.getField(n).each((function(e){Kg.setValue(e,t.event.value),yv.getCurrent(n).each(My.focus)}))})),xi(_D,(function(n,t){JT.getField(n).each((function(t){yv.getCurrent(n).each(My.focus)}))}))])])})},ED=Bp({schema:[ye("dom")],name:"label"}),DD=function(n){return Bp({name:n+"-edge",overrides:function(t){var e=t.model.manager.edgeActions[n];return e.fold((function(){return{}}),(function(n){return{events:vi([wi(yr(),(function(t,e,o){return n(t,o)}),[t]),wi(kr(),(function(t,e,o){return n(t,o)}),[t]),wi(Cr(),(function(t,e,o){o.mouseIsDown.get()&&n(t,o)}),[t])])}}))}})},BD=DD("top-left"),AD=DD("top"),MD=DD("top-right"),FD=DD("right"),ID=DD("bottom-right"),RD=DD("bottom"),VD=DD("bottom-left"),PD=DD("left"),HD=Ep({name:"thumb",defaults:y({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:vi([Oi(yr(),n,"spectrum"),Oi(xr(),n,"spectrum"),Oi(wr(),n,"spectrum"),Oi(kr(),n,"spectrum"),Oi(Cr(),n,"spectrum"),Oi(_r(),n,"spectrum")])}}}),zD=Ep({schema:[qe("mouseIsDown",(function(){return Ke(!1)}))],name:"spectrum",overrides:function(n){var t=n.model,e=t.manager,o=function(t,o){return e.getValueFromEvent(o).map((function(o){return e.setValueFrom(t,n,o)}))};return{behaviours:Lf([ly.config({mode:"special",onLeft:function(t){return e.onLeft(t,n)},onRight:function(t){return e.onRight(t,n)},onUp:function(t){return e.onUp(t,n)},onDown:function(t){return e.onDown(t,n)}}),My.config({})]),events:vi([xi(yr(),o),xi(xr(),o),xi(kr(),o),xi(Cr(),(function(t,e){n.mouseIsDown.get()&&o(t,e)}))])}}}),ND=[ED,PD,FD,AD,RD,BD,MD,VD,ID,HD,zD],LD="slider.change.value",jD=y(LD),UD=function(n){return-1!==n.type.indexOf("touch")},WD=function(n){var t=n.event.raw;if(UD(t)){var e=t;return void 0!==e.touches&&1===e.touches.length?R.some(e.touches[0]).map((function(n){return Tc(n.clientX,n.clientY)})):R.none()}var o=t;return void 0!==o.clientX?R.some(o).map((function(n){return Tc(n.clientX,n.clientY)})):R.none()},GD="top",XD="right",YD="bottom",qD="left",KD=function(n){return n.model.minX},JD=function(n){return n.model.minY},$D=function(n){return n.model.minX-1},QD=function(n){return n.model.minY-1},ZD=function(n){return n.model.maxX},nB=function(n){return n.model.maxY},tB=function(n){return n.model.maxX+1},eB=function(n){return n.model.maxY+1},oB=function(n,t,e){return t(n)-e(n)},rB=function(n){return oB(n,ZD,KD)},iB=function(n){return oB(n,nB,JD)},uB=function(n){return rB(n)/2},aB=function(n){return iB(n)/2},cB=function(n){return n.stepSize},sB=function(n){return n.snapToGrid},fB=function(n){return n.snapStart},lB=function(n){return n.rounded},dB=function(n,t){return void 0!==n[t+"-edge"]},mB=function(n){return dB(n,qD)},gB=function(n){return dB(n,XD)},pB=function(n){return dB(n,GD)},vB=function(n){return dB(n,YD)},hB=function(n){return n.model.value.get()},bB=function(n){return{x:n}},yB=function(n){return{y:n}},xB=function(n,t){return{x:n,y:t}},wB=function(n,t){li(n,jD(),{value:t})},SB=function(n,t){wB(n,xB($D(t),QD(t)))},kB=function(n,t){wB(n,yB(QD(t)))},CB=function(n,t){wB(n,xB(uB(t),QD(t)))},OB=function(n,t){wB(n,xB(tB(t),QD(t)))},_B=function(n,t){wB(n,bB(tB(t)))},TB=function(n,t){wB(n,xB(tB(t),aB(t)))},EB=function(n,t){wB(n,xB(tB(t),eB(t)))},DB=function(n,t){wB(n,yB(eB(t)))},BB=function(n,t){wB(n,xB(uB(t),eB(t)))},AB=function(n,t){wB(n,xB($D(t),eB(t)))},MB=function(n,t){wB(n,bB($D(t)))},FB=function(n,t){wB(n,xB($D(t),aB(t)))},IB=function(n,t,e,o){return n<t?n:n>e?e:n===t?t-1:Math.max(t,n-o)},RB=function(n,t,e,o){return n>e?n:n<t?t:n===e?e+1:Math.min(e,n+o)},VB=function(n,t,e){return Math.max(t,Math.min(e,n))},PB=function(n,t,e,o,r){return r.fold((function(){var r=n-t,i=Math.round(r/o)*o;return VB(t+i,t-1,e+1)}),(function(t){var r=(n-t)%o,i=Math.round(r/o),u=Math.floor((n-t)/o),a=Math.floor((e-t)/o),c=Math.min(a,u+i),s=t+c*o;return Math.max(t,s)}))},HB=function(n,t,e){return Math.min(e,Math.max(n,t))-t},zB=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,i=n.step,u=n.snap,a=n.snapStart,c=n.rounded,s=n.hasMinEdge,f=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=s?t-1:t,p=f?e+1:e;if(r<l)return g;if(r>d)return p;var v=HB(r,l,d),h=VB(v/m*o+t,g,p);return u&&h>=t&&h<=e?PB(h,t,e,i,a):c?Math.round(h):h},NB=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,a=n.maxBound,c=n.maxOffset,s=n.centerMinEdge,f=n.centerMaxEdge;return r<t?i?0:s:r>e?u?a:f:(r-t)/o*c},LB="top",jB="right",UB="bottom",WB="left",GB="width",XB="height",YB=function(n){return n.element.dom.getBoundingClientRect()},qB=function(n,t){return n[t]},KB=function(n){var t=YB(n);return qB(t,WB)},JB=function(n){var t=YB(n);return qB(t,jB)},$B=function(n){var t=YB(n);return qB(t,LB)},QB=function(n){var t=YB(n);return qB(t,UB)},ZB=function(n){var t=YB(n);return qB(t,GB)},nA=function(n){var t=YB(n);return qB(t,XB)},tA=function(n,t,e){return(n+t)/2-e},eA=function(n,t){var e=YB(n),o=YB(t),r=qB(e,WB),i=qB(e,jB),u=qB(o,WB);return tA(r,i,u)},oA=function(n,t){var e=YB(n),o=YB(t),r=qB(e,LB),i=qB(e,UB),u=qB(o,LB);return tA(r,i,u)},rA=function(n,t){li(n,jD(),{value:t})},iA=function(n){return{x:n}},uA=function(n,t,e){var o={min:KD(t),max:ZD(t),range:rB(t),value:e,step:cB(t),snap:sB(t),snapStart:fB(t),rounded:lB(t),hasMinEdge:mB(t),hasMaxEdge:gB(t),minBound:KB(n),maxBound:JB(n),screenRange:ZB(n)};return zB(o)},aA=function(n,t,e){var o=uA(n,t,e),r=iA(o);return rA(n,r),o},cA=function(n,t){var e=KD(t);rA(n,iA(e))},sA=function(n,t){var e=ZD(t);rA(n,iA(e))},fA=function(n,t,e){var o=n>0?RB:IB,r=o(hB(e).x,KD(e),ZD(e),cB(e));return rA(t,iA(r)),R.some(r)},lA=function(n){return function(t,e){return fA(n,t,e).map(O)}},dA=function(n){var t=WD(n);return t.map((function(n){return n.left}))},mA=function(n,t,e,o,r){var i=0,u=ZB(n),a=o.bind((function(t){return R.some(eA(t,n))})).getOr(i),c=r.bind((function(t){return R.some(eA(t,n))})).getOr(u),s={min:KD(t),max:ZD(t),range:rB(t),value:e,hasMinEdge:mB(t),hasMaxEdge:gB(t),minBound:KB(n),minOffset:i,maxBound:JB(n),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return NB(s)},gA=function(n,t,e,o,r,i){var u=mA(t,i,e,o,r);return KB(t)-KB(n)+u},pA=function(n,t,e,o){var r=hB(e),i=gA(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),e),u=Ic(t.element)/2;Ka(t.element,"left",i-u+"px")},vA=lA(-1),hA=lA(1),bA=R.none,yA=R.none,xA={"top-left":R.none(),top:R.none(),"top-right":R.none(),right:R.some(_B),"bottom-right":R.none(),bottom:R.none(),"bottom-left":R.none(),left:R.some(MB)},wA=Object.freeze({__proto__:null,setValueFrom:aA,setToMin:cA,setToMax:sA,findValueOfOffset:uA,getValueFromEvent:dA,findPositionOfValue:gA,setPositionFromValue:pA,onLeft:vA,onRight:hA,onUp:bA,onDown:yA,edgeActions:xA}),SA=function(n,t){li(n,jD(),{value:t})},kA=function(n){return{y:n}},CA=function(n,t,e){var o={min:JD(t),max:nB(t),range:iB(t),value:e,step:cB(t),snap:sB(t),snapStart:fB(t),rounded:lB(t),hasMinEdge:pB(t),hasMaxEdge:vB(t),minBound:$B(n),maxBound:QB(n),screenRange:nA(n)};return zB(o)},OA=function(n,t,e){var o=CA(n,t,e),r=kA(o);return SA(n,r),o},_A=function(n,t){var e=JD(t);SA(n,kA(e))},TA=function(n,t){var e=nB(t);SA(n,kA(e))},EA=function(n,t,e){var o=n>0?RB:IB,r=o(hB(e).y,JD(e),nB(e),cB(e));return SA(t,kA(r)),R.some(r)},DA=function(n){return function(t,e){return EA(n,t,e).map(O)}},BA=function(n){var t=WD(n);return t.map((function(n){return n.top}))},AA=function(n,t,e,o,r){var i=0,u=nA(n),a=o.bind((function(t){return R.some(oA(t,n))})).getOr(i),c=r.bind((function(t){return R.some(oA(t,n))})).getOr(u),s={min:JD(t),max:nB(t),range:iB(t),value:e,hasMinEdge:pB(t),hasMaxEdge:vB(t),minBound:$B(n),minOffset:i,maxBound:QB(n),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return NB(s)},MA=function(n,t,e,o,r,i){var u=AA(t,i,e,o,r);return $B(t)-$B(n)+u},FA=function(n,t,e,o){var r=hB(e),i=MA(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),e),u=kc(t.element)/2;Ka(t.element,"top",i-u+"px")},IA=R.none,RA=R.none,VA=DA(-1),PA=DA(1),HA={"top-left":R.none(),top:R.some(kB),"top-right":R.none(),right:R.none(),"bottom-right":R.none(),bottom:R.some(DB),"bottom-left":R.none(),left:R.none()},zA=Object.freeze({__proto__:null,setValueFrom:OA,setToMin:_A,setToMax:TA,findValueOfOffset:CA,getValueFromEvent:BA,findPositionOfValue:MA,setPositionFromValue:FA,onLeft:IA,onRight:RA,onUp:VA,onDown:PA,edgeActions:HA}),NA=function(n,t){li(n,jD(),{value:t})},LA=function(n,t){return{x:n,y:t}},jA=function(n,t,e){var o=uA(n,t,e.left),r=CA(n,t,e.top),i=LA(o,r);return NA(n,i),i},UA=function(n,t,e,o){var r=n>0?RB:IB,i=t?hB(o).x:r(hB(o).x,KD(o),ZD(o),cB(o)),u=t?r(hB(o).y,JD(o),nB(o),cB(o)):hB(o).y;return NA(e,LA(i,u)),R.some(i)},WA=function(n,t){return function(e,o){return UA(n,t,e,o).map(O)}},GA=function(n,t){var e=KD(t),o=JD(t);NA(n,LA(e,o))},XA=function(n,t){var e=ZD(t),o=nB(t);NA(n,LA(e,o))},YA=function(n){return WD(n)},qA=function(n,t,e,o){var r=hB(e),i=gA(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),e),u=MA(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),e),a=Ic(t.element)/2,c=kc(t.element)/2;Ka(t.element,"left",i-a+"px"),Ka(t.element,"top",u-c+"px")},KA=WA(-1,!1),JA=WA(1,!1),$A=WA(-1,!0),QA=WA(1,!0),ZA={"top-left":R.some(SB),top:R.some(CB),"top-right":R.some(OB),right:R.some(TB),"bottom-right":R.some(EB),bottom:R.some(BB),"bottom-left":R.some(AB),left:R.some(FB)},nM=Object.freeze({__proto__:null,setValueFrom:jA,setToMin:GA,setToMax:XA,getValueFromEvent:YA,setPositionFromValue:qA,onLeft:KA,onRight:JA,onUp:$A,onDown:QA,edgeActions:ZA}),tM=[He("stepSize",1),He("onChange",p),He("onChoose",p),He("onInit",p),He("onDragStart",p),He("onDragEnd",p),He("snapToGrid",!1),He("rounded",!0),Be("snapStart"),xe("model",ce("mode",{x:[He("minX",0),He("maxX",100),qe("value",(function(n){return Ke(n.mode.minX)})),ye("getInitialValue"),js("manager",wA)],y:[He("minY",0),He("maxY",100),qe("value",(function(n){return Ke(n.mode.minY)})),ye("getInitialValue"),js("manager",zA)],xy:[He("minX",0),He("maxX",100),He("minY",0),He("maxY",100),qe("value",(function(n){return Ke({x:n.mode.minX,y:n.mode.minY})})),ye("getInitialValue"),js("manager",nM)]})),Jg("sliderBehaviours",[ly,Kg]),qe("mouseIsDown",(function(){return Ke(!1)}))],eM=function(n,t,e,o){var r,i=function(t){return Wp(t,n,"thumb")},u=function(t){return Wp(t,n,"spectrum")},a=function(t){return Up(t,n,"left-edge")},c=function(t){return Up(t,n,"right-edge")},s=function(t){return Up(t,n,"top-edge")},f=function(t){return Up(t,n,"bottom-edge")},l=n.model,d=l.manager,m=function(t,e){d.setPositionFromValue(t,e,n,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:f,getSpectrum:u})},g=function(n,t){l.value.set(t);var e=i(n);m(n,e)},p=function(t,e){g(t,e);var o=i(t);return n.onChange(t,o,e),R.some(!0)},v=function(t){d.setToMin(t,n)},h=function(t){d.setToMax(t,n)},b=function(t){var e=function(){Up(t,n,"thumb").each((function(e){var o=l.value.get();n.onChoose(t,e,o)}))},o=n.mouseIsDown.get();n.mouseIsDown.set(!1),o&&e()},y=function(t,e){e.stop(),n.mouseIsDown.set(!0),n.onDragStart(t,i(t))},x=function(t,e){e.stop(),n.onDragEnd(t,i(t)),b(t)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.sliderBehaviours,[ly.config({mode:"special",focusIn:function(t){return Up(t,n,"spectrum").map(ly.focusIn).map(O)}}),Kg.config({store:{mode:"manual",getValue:function(n){return l.value.get()}}}),Yf.config({channels:(r={},r[vg()]={onReceive:b},r)})]),events:vi([xi(jD(),(function(n,t){p(n,t.event.value)})),Bi((function(t,e){var o=l.getInitialValue();l.value.set(o);var r=i(t);m(t,r);var a=u(t);n.onInit(t,r,a,l.value.get())})),xi(yr(),y),xi(wr(),x),xi(kr(),y),xi(_r(),x)]),apis:{resetToMin:v,resetToMax:h,setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},oM=cv({name:"Slider",configFields:tM,partFields:ND,factory:eM,apis:{setValue:function(n,t,e){n.setValue(t,e)},resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),rM=function(n,t,e){return{hue:n,saturation:t,value:e}},iM=function(n){var t=0,e=0,o=0,r=n.red/255,i=n.green/255,u=n.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u));if(a===c)return o=a,rM(0,0,100*o);var s=r===a?i-u:u===a?r-i:u-r;return t=r===a?3:u===a?1:5,t=60*(t-s/(c-a)),e=(c-a)/c,o=c,rM(Math.round(t),Math.round(100*e),Math.round(100*o))},uM=function(n){return iM(XO(n))},aM=function(n){return PO(GO(n))},cM=Pu("rgb-hex-update"),sM=Pu("slider-update"),fM=Pu("palette-update"),lM=function(n,t){var e=oM.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=oM.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return oM.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:y({y:0})},components:[e,o],sliderBehaviours:Lf([My.config({})]),onChange:function(n,t,e){li(n,sM,{value:e})}})},dM="form",mM=[Jg("formBehaviours",[Kg])],gM=function(n){return"<alloy.field."+n+">"},pM=function(n){var t=function(){var n=[],t=function(t,e){return n.push(t),Hp(dM,gM(t),e)};return{field:t,record:function(){return n}}}(),e=n(t),o=t.record(),r=G(o,(function(n){return Ep({name:n,pname:gM(n)})}));return tv(dM,mM,r,hM,e)},vM=function(n,t){return n.fold((function(){return hn.error(t)}),hn.value)},hM=function(n,t){return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.formBehaviours,[Kg.config({store:{mode:"manual",getValue:function(t){var e=Xp(t,n);return Mn(e,(function(n,t){return n().bind((function(n){var e=yv.getCurrent(n);return vM(e,new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+Mu(n.element)))})).map(Kg.getValue)}))},setValue:function(t,e){An(e,(function(e,o){Up(t,n,o).each((function(n){yv.getCurrent(n).each((function(n){Kg.setValue(n,e)}))}))}))}}})]),apis:{getField:function(t,e){return Up(t,n,e).bind(yv.getCurrent)}}}},bM={getField:ea((function(n,t,e){return n.getField(t,e)})),sketch:pM},yM=Pu("valid-input"),xM=Pu("invalid-input"),wM=Pu("validating-input"),SM="colorcustom.rgb.",kM=function(n,t,e,o){var r=function(e,o){return YE.config({invalidClass:t("invalid"),notify:{onValidate:function(n){li(n,wM,{type:e})},onValid:function(n){li(n,yM,{type:e,value:Kg.getValue(n)})},onInvalid:function(n){li(n,xM,{type:e,value:Kg.getValue(n)})}},validator:{validate:function(t){var e=Kg.getValue(t),r=o(e)?hn.value(!0):hn.error(n("aria.input.invalid"));return RE.pure(r)},validateOnLoad:!1}})},i=function(e,o,i,u,a){var c=n(SM+"range"),s=JT.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),f=JT.parts.field({data:a,factory:kE,inputAttributes:T({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[t("textfield")],inputBehaviours:Lf([r(o,e),nE.config({})]),onSetValue:function(n){if(YE.isInvalid(n)){var t=YE.run(n);t.get(p)}}}),l=[s,f],d="hex"!==o?[JT.parts["aria-descriptor"]({text:c})]:[],m=l.concat(d);return{dom:{tag:"div",attributes:{role:"presentation"}},components:m}},u=function(n,t){var e=PO(t);return bM.getField(n,"hex").each((function(t){My.isFocused(t)||Kg.setValue(n,{hex:e.value})})),e},a=function(n,t){var e=t.red,o=t.green,r=t.blue;Kg.setValue(n,{red:e,green:o,blue:r})},c=Qx({dom:{tag:"div",classes:[t("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),s=function(n,t){c.getOpt(n).each((function(n){Ka(n.element,"background-color","#"+t.value)}))},f=function(){var r={red:Ke(R.some(255)),green:Ke(R.some(255)),blue:Ke(R.some(255)),hex:Ke(R.some("ffffff"))},f=function(n,t){var e=XO(t);a(n,e),g(e)},l=function(n){return r[n].get()},d=function(n,t){r[n].set(t)},m=function(){return l("red").bind((function(n){return l("green").bind((function(t){return l("blue").map((function(e){return UO(n,t,e,1)}))}))}))},g=function(n){var t=n.red,e=n.green,o=n.blue;d("red",R.some(t)),d("green",R.some(e)),d("blue",R.some(o))},p=function(n,t){var e=t.event;"hex"!==e.type?d(e.type,R.none()):o(n)},v=function(n,t){e(n);var o=BO(t);d("hex",R.some(t));var r=XO(o);a(n,r),g(r),li(n,cM,{hex:o}),s(n,o)},h=function(n,t,e){var o=parseInt(e,10);d(t,R.some(o)),m().each((function(t){var e=u(n,t);li(n,cM,{hex:e}),s(n,e)}))},b=function(n){return"hex"===n.type},y=function(n,t){var e=t.event;b(e)?v(n,e.value):h(n,e.type,e.value)},x=function(t){return{label:n(SM+t+".label"),description:n(SM+t+".description")}},w=x("red"),S=x("green"),k=x("blue"),C=x("hex");return Kn(bM.sketch((function(e){return{dom:{tag:"form",classes:[t("rgb-form")],attributes:{"aria-label":n("aria.color.picker")}},components:[e.field("red",JT.sketch(i(WO,"red",w.label,w.description,255))),e.field("green",JT.sketch(i(WO,"green",S.label,S.description,255))),e.field("blue",JT.sketch(i(WO,"blue",k.label,k.description,255))),e.field("hex",JT.sketch(i(FO,"hex",C.label,C.description,"ffffff"))),c.asSpec()],formBehaviours:Lf([YE.config({invalidClass:t("form-invalid")}),ky("rgb-form-events",[xi(yM,y),xi(xM,p),xi(wM,p)])])}})),{apis:{updateHex:function(n,t){Kg.setValue(n,{hex:t.value}),f(n,t),s(n,t)}}})},l=av({factory:f,name:"RgbForm",configFields:[],apis:{updateHex:function(n,t,e){n.updateHex(t,e)}},extraApis:{}});return l},CM=function(n,t){var e=oM.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),o=oM.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:"<div class="+t("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(n,t){var e=n.width,o=n.height,r=n.getContext("2d");if(null!==r){r.fillStyle=t,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}},i=function(n,t){var e=n.components()[0].element.dom,o=rM(t,100,100),i=GO(o);r(e,KO(i))},u=function(n,t){var e=iM(XO(t));oM.setValue(n,{x:e.saturation,y:100-e.value})},a=function(n){var i=y({x:0,y:0}),u=function(n,t,e){li(n,fM,{value:e})},a=function(n,t,e,o){r(e.element.dom,KO(JO))},c=Lf([yv.config({find:R.some}),My.config({})]);return oM.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:i},rounded:!1,components:[e,o],onChange:u,onInit:a,sliderBehaviours:c})},c=av({factory:a,name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(n,t,e){i(t,e)},setThumb:function(n,t,e){u(t,e)}},extraApis:{}});return c},OM=function(n,t){var e=function(e){var o=kM(n,t,e.onValidHex,e.onInvalidHex),r=CM(n,t),i=function(n){return(100-n)/100*360},u=function(n){return 100-n/360*100},a={paletteRgba:Ke(JO),paletteHue:Ke(0)},c=Qx(lM(n,t)),s=Qx(r.sketch({})),f=Qx(o.sketch({})),l=function(n,t,e){s.getOpt(n).each((function(n){r.setHue(n,e)}))},d=function(n,t){f.getOpt(n).each((function(n){o.updateHex(n,t)}))},m=function(n,t,e){c.getOpt(n).each((function(n){oM.setValue(n,{y:u(e)})}))},g=function(n,t){s.getOpt(n).each((function(n){r.setThumb(n,t)}))},p=function(n,t){var e=XO(n);a.paletteRgba.set(e),a.paletteHue.set(t)},v=function(n,t,e,o){p(t,e),X(o,(function(o){o(n,t,e)}))},h=function(){var n=[d];return function(t,e){var o=e.event.value,r=a.paletteHue.get(),i=rM(r,o.x,100-o.y),u=aM(i);v(t,u,r,n)}},b=function(){var n=[l,d];return function(t,e){var o=i(e.event.value.y),r=a.paletteRgba.get(),u=iM(r),c=rM(o,u.saturation,u.value),s=aM(c);v(t,s,o,n)}},y=function(){var n=[l,m,g];return function(t,e){var o=e.event.hex,r=uM(o);v(t,o,r.hue,n)}};return{uid:e.uid,dom:e.dom,components:[s.asSpec(),c.asSpec(),f.asSpec()],behaviours:Lf([ky("colour-picker-events",[xi(cM,y()),xi(fM,h()),xi(sM,b())]),yv.config({find:function(n){return f.getOpt(n)}}),ly.config({mode:"acyclic"})])}},o=av({name:"ColourPicker",configFields:[ye("dom"),He("onValidHex",p),He("onInvalidHex",p)],factory:e});return o},_M=function(){return yv.config({find:R.some})},TM=function(n){return yv.config({find:n.getOpt})},EM=function(n){return yv.config({find:function(t){return Ji(t.element,n).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}})},DM={self:_M,memento:TM,childAt:EM},BM={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},AM=function(n){return BM[n]},MM=function(n){return AM(n)},FM=function(n){var t=function(n){return"tox-"+n},e=OM(MM,t),o=function(n){li(n,lE,{name:"hex-valid",value:!0})},r=function(n){li(n,lE,{name:"hex-valid",value:!1})},i=Qx(e.sketch({dom:{tag:"div",classes:[t("color-picker-container")],attributes:{role:"presentation"}},onValidHex:o,onInvalidHex:r}));return{dom:{tag:"div"},components:[i.asSpec()],behaviours:Lf([Kg.config({store:{mode:"manual",getValue:function(n){var t=i.get(n),e=yv.getCurrent(t),o=e.bind((function(n){var t=Kg.getValue(n);return t.hex}));return o.map((function(n){return"#"+n})).getOr("")},setValue:function(n,t){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,o=e.exec(t),r=i.get(n),u=yv.getCurrent(r);u.fold((function(){}),(function(n){Kg.setValue(n,{hex:R.from(o[1]).getOr("")}),bM.getField(n,"hex").each((function(n){fi(n,Mr())}))}))}}}),DM.self()])}},IM=tinymce.util.Tools.resolve("tinymce.Resource"),RM=function(n){return Object.prototype.hasOwnProperty.call(n,"init")},VM=function(n){var t=Ke(R.none()),e=Qx({dom:{tag:n.tag}}),o=Ke(R.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Lf([ky("custom-editor-events",[Bi((function(r){e.getOpt(r).each((function(e){(RM(n)?n.init(e.element.dom):IM.load(n.scriptId,n.scriptUrl).then((function(t){return t(e.element.dom,n.settings)}))).then((function(n){o.get().each((function(t){n.setValue(t)})),o.set(R.none()),t.set(R.some(n))}))}))}))]),Kg.config({store:{mode:"manual",getValue:function(){return t.get().fold((function(){return o.get().getOr("")}),(function(n){return n.getValue()}))},setValue:function(n,e){t.get().fold((function(){o.set(R.some(e))}),(function(n){return n.setValue(e)}))}}}),DM.self()]),components:[e.asSpec()]}},PM=tinymce.util.Tools.resolve("tinymce.util.Tools"),HM=zt([He("preprocess",x),He("postprocess",x)]),zM=function(n,t){var e=ie("RepresentingConfigs.memento processors",HM,t);return Kg.config({store:{mode:"manual",getValue:function(t){var o=n.get(t),r=Kg.getValue(o);return e.postprocess(r)},setValue:function(t,o){var r=e.preprocess(o),i=n.get(t);Kg.setValue(i,r)}}})},NM=function(n,t,e){return Kg.config(Kn({store:{mode:"manual",getValue:t,setValue:e}},n.map((function(n){return{store:{initialValue:n}}})).getOr({})))},LM=function(n,t,e){return NM(n,(function(n){return t(n.element)}),(function(n,t){return e(n.element,t)}))},jM=function(n){return LM(n,ic,uc)},UM=function(n){return LM(n,yu,xu)},WM=function(n){return Kg.config({store:{mode:"memory",initialValue:n}})},GM={memento:zM,withElement:LM,withComp:NM,domValue:jM,domHtml:UM,memory:WM},XM="jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp",YM=function(n,t){var e=PM.explode(t.getSetting("images_file_types",XM,"string")),o=function(n){return j(e,(function(t){return vo(n.name.toLowerCase(),"."+t.toLowerCase())}))};return K(dn(n),o)},qM=function(n,t){var e=function(n,t){t.stop()},o=function(n){return function(t,e){X(n,(function(n){n(t,e)}))}},r=function(n,t){if(!Jk.isDisabled(n)){var e=t.event.raw;u(n,e.dataTransfer.files)}},i=function(n,t){var e=t.event.raw.target;u(n,e.files)},u=function(e,o){Kg.setValue(e,YM(o,t)),li(e,cE,{name:n.name})},a=Qx({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Lf([ky("input-file-events",[Ti(Ir()),Ti(Gr())])])}),c=function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Lf([GM.memory([]),DM.self(),Jk.config({}),$y.config({toggleClass:"dragenter",toggleOnExecute:!1}),ky("dropzone-events",[xi("dragenter",o([e,$y.toggle])),xi("dragleave",o([e,$y.toggle])),xi("dragover",e),xi("drop",o([e,r])),xi(Fr(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:t.translate("Drop an image here")}},$x.sketch({dom:{tag:"button",innerHtml:t.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(n){var t=a.get(n);t.element.dom.click()},buttonBehaviours:Lf([nE.config({}),KC.button(t.isDisabled),WC()])})]}]}},s=n.label.map((function(n){return aE(n,t)})),f=JT.parts.field({factory:{sketch:c}});return eE(s,f,["tox-form__group--stretched"],[])},KM=function(n,t){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+n.columns+"col"]},components:G(n.items,t.interpreter)}},JM=Pu("alloy-fake-before-tabstop"),$M=Pu("alloy-fake-after-tabstop"),QM=function(n){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:n},behaviours:Lf([My.config({ignore:!0}),nE.config({})])}},ZM=function(n){return{dom:{tag:"div",classes:["tox-navobj"]},components:[QM([JM]),n,QM([$M])],behaviours:Lf([DM.childAt(1)])}},nF=function(n,t){li(n,Br(),{raw:{which:9,shiftKey:t}})},tF=function(n,t){var e=t.element;Na(e,JM)?nF(n,!0):Na(e,$M)&&nF(n,!1)},eF=function(n){return vT(n,["."+JM,"."+$M].join(","),C)},oF=!(qo().browser.isIE()||qo().browser.isEdge()),rF=function(n){var t=Ke("");return{getValue:function(n){return t.get()},setValue:function(e,o){if(n)ku(e.element,"srcdoc",o);else{ku(e.element,"src","javascript:''");var r=e.element.dom.contentWindow.document;r.open(),r.write(o),r.close()}t.set(o)}}},iF=function(n,t){var e=oF&&n.sandboxed,o=T(T({},n.label.map((function(n){return{title:n}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=rF(e),i=n.label.map((function(n){return aE(n,t)})),u=function(n){return ZM({uid:n.uid,dom:{tag:"iframe",attributes:o},behaviours:Lf([nE.config({}),My.config({}),GM.withComp(R.none(),r.getValue,r.setValue)])})},a=JT.parts.field({factory:{sketch:u}});return eE(i,a,["tox-form__group--stretched"],[])},uF=function(n,t){return sF(document.createElement("canvas"),n,t)},aF=function(n){var t=uF(n.width,n.height),e=cF(t);return e.drawImage(n,0,0),t},cF=function(n){return n.getContext("2d")},sF=function(n,t,e){return n.width=t,n.height=e,n},fF=function(n){return n.naturalWidth||n.width},lF=function(n){return n.naturalHeight||n.height},dF=function(){var n=function(n){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],f(n,o(u,this),o(a,this))},t=window,e=n.immediateFn||"function"===typeof t.setImmediate&&t.setImmediate||function(n){return setTimeout(n,1)},o=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return n.apply(t,e)}},r=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};function i(n){var t=this;null!==this._state?e((function(){var e=t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(r){return void n.reject(r)}n.resolve(o)}else(t._state?n.resolve:n.reject)(t._value)})):this._deferreds.push(n)}function u(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===typeof n||"function"===typeof n)){var t=n.then;if("function"===typeof t)return void f(o(t,n),o(u,this),o(a,this))}this._state=!0,this._value=n,c.call(this)}catch(e){a.call(this,e)}}function a(n){this._state=!1,this._value=n,c.call(this)}function c(){for(var n=0,t=this._deferreds;n<t.length;n++){var e=t[n];i.call(this,e)}this._deferreds=[]}function s(n,t,e,o){this.onFulfilled="function"===typeof n?n:null,this.onRejected="function"===typeof t?t:null,this.resolve=e,this.reject=o}var f=function(n,t,e){var o=!1;try{n((function(n){o||(o=!0,t(n))}),(function(n){o||(o=!0,e(n))}))}catch(r){if(o)return;o=!0,e(r)}};return n.prototype.catch=function(n){return this.then(null,n)},n.prototype.then=function(t,e){var o=this;return new n((function(n,r){i.call(o,new s(t,e,n,r))}))},n.all=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=Array.prototype.slice.call(1===t.length&&r(t[0])?t[0]:t);return new n((function(n,t){if(0===o.length)return n([]);for(var e=o.length,r=function(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(n){r(i,n)}),t)}o[i]=u,0===--e&&n(o)}catch(c){t(c)}},i=0;i<o.length;i++)r(i,o[i])}))},n.resolve=function(t){return t&&"object"===typeof t&&t.constructor===n?t:new n((function(n){n(t)}))},n.reject=function(t){return new n((function(n,e){e(t)}))},n.race=function(t){return new n((function(n,e){for(var o=0,r=t;o<r.length;o++){var i=r[o];i.then(n,e)}}))},n},mF=window.Promise?window.Promise:dF(),gF=function(n){return new mF((function(t,e){var o=URL.createObjectURL(n),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),t(r)},a=function(){i(),e("Unable to load data of type "+n.type+": "+o)};r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)}))},pF=function(n){var t=n.split(","),e=/data:([^;]+)/.exec(t[0]);if(!e)return R.none();for(var o=e[1],r=t[1],i=1024,u=atob(r),a=u.length,c=Math.ceil(a/i),s=new Array(c),f=0;f<c;++f){for(var l=f*i,d=Math.min(l+i,a),m=new Array(d-l),g=l,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0);s[f]=new Uint8Array(m)}return R.some(new Blob(s,{type:o}))},vF=function(n){return new mF((function(t,e){pF(n).fold((function(){e("uri is not base64: "+n)}),t)}))},hF=function(n,t,e){return t=t||"image/png",d(HTMLCanvasElement.prototype.toBlob)?new mF((function(o,r){n.toBlob((function(n){n?o(n):r()}),t,e)})):vF(n.toDataURL(t,e))},bF=function(n,t,e){return t=t||"image/png",n.toDataURL(t,e)},yF=function(n){return gF(n).then((function(n){wF(n);var t=uF(fF(n),lF(n)),e=cF(t);return e.drawImage(n,0,0),t}))},xF=function(n){return new mF((function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n)}))},wF=function(n){URL.revokeObjectURL(n.src)},SF=function(n,t,e){var o=t.type,r=y(o),i=function(){return mF.resolve(t)},u=y(e),a=function(){return e.split(",")[1]},c=function(t,e){return n.then((function(n){return hF(n,t,e)}))},s=function(t,e){return n.then((function(n){return bF(n,t,e)}))},f=function(n,t){return s(n,t).then((function(n){return n.split(",")[1]}))},l=function(){return n.then(aF)};return{getType:r,toBlob:i,toDataURL:u,toBase64:a,toAdjustedBlob:c,toAdjustedDataURL:s,toAdjustedBase64:f,toCanvas:l}},kF=function(n){return xF(n).then((function(t){return SF(yF(n),n,t)}))},CF=function(n,t){return hF(n,t).then((function(t){return SF(mF.resolve(n),t,n.toDataURL())}))},OF=function(n){return kF(n)},_F=function(n,t,e){var o="string"===typeof n?parseFloat(n):n;return o>e?o=e:o<t&&(o=t),o},TF=function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},EF=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],DF=function(n,t){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=t[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=n[u+5*a]*o[a];r[u+5*i]=e}}return r},BF=function(n,t){var e;return t=_F(t,-1,1),t*=100,t<0?e=127+t/100*127:(e=t%1,e=0===e?EF[t]:EF[Math.floor(t)]*(1-e)+EF[Math.floor(t)+1]*e,e=127*e+127),DF(n,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])},AF=function(n,t){return t=_F(255*t,-255,255),DF(n,[1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])},MF=function(n,t,e,o){return t=_F(t,0,2),e=_F(e,0,2),o=_F(o,0,2),DF(n,[t,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])},FF=function(n,t){return n.toCanvas().then((function(e){return IF(e,n.getType(),t)}))},IF=function(n,t,e){var o=cF(n),r=function(n,t){for(var e,o,r,i,u=n.data,a=t[0],c=t[1],s=t[2],f=t[3],l=t[4],d=t[5],m=t[6],g=t[7],p=t[8],v=t[9],h=t[10],b=t[11],y=t[12],x=t[13],w=t[14],S=t[15],k=t[16],C=t[17],O=t[18],_=t[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+v,u[T+2]=e*h+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return n},i=r(o.getImageData(0,0,n.width,n.height),e);return o.putImageData(i,0,0),CF(n,t)},RF=function(n,t){return n.toCanvas().then((function(e){return VF(e,n.getType(),t)}))},VF=function(n,t,e){var o=cF(n),r=function(n,t,e){for(var o=function(n,t,e){return n>e?n=e:n<t&&(n=t),n},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=n.data,a=t.data,c=n.width,s=n.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var v=0;v<r;v++){var h=o(l+v-i,0,c-1),b=o(f+p-i,0,s-1),y=4*(b*c+h),x=e[p*r+v];d+=u[y]*x,m+=u[y+1]*x,g+=u[y+2]*x}var w=4*(f*c+l);a[w]=o(d,0,255),a[w+1]=o(m,0,255),a[w+2]=o(g,0,255)}return t},i=o.getImageData(0,0,n.width,n.height),u=o.getImageData(0,0,n.width,n.height);return u=r(i,u,e),o.putImageData(u,0,0),CF(n,t)},PF=function(n){var t=function(t,e,o){for(var r=cF(t),i=new Array(256),u=function(n,t){for(var e=n.data,o=0;o<e.length;o+=4)e[o]=t[e[o]],e[o+1]=t[e[o+1]],e[o+2]=t[e[o+2]];return n},a=0;a<i.length;a++)i[a]=n(a,o);var c=u(r.getImageData(0,0,t.width,t.height),i);return r.putImageData(c,0,0),CF(t,e)};return function(n,e){return n.toCanvas().then((function(o){return t(o,n.getType(),e)}))}},HF=function(n){return function(t,e){return FF(t,n(TF(),e))}},zF=function(n){return function(t){return FF(t,n)}},NF=function(n){return function(t){return RF(t,n)}},LF=zF([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),jF=HF(AF),UF=HF(BF),WF=function(n,t,e,o){return FF(n,MF(TF(),t,e,o))},GF=NF([0,-1,0,-1,5,-1,0,-1,0]),XF=PF((function(n,t){return 255*Math.pow(n/255,1-t)})),YF=function(n,t,e){var o=fF(n),r=lF(n),i=t/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=qF(n,i,u);return a?c.then((function(n){return YF(n,t,e)})):c},qF=function(n,t,e){return new mF((function(o){var r=fF(n),i=lF(n),u=Math.floor(r*t),a=Math.floor(i*e),c=uF(u,a),s=cF(c);s.drawImage(n,0,0,r,i,0,0,u,a),o(c)}))},KF=function(n,t){void 0===t&&(t=2);var e=Math.pow(10,t),o=Math.round(n*e);return Math.ceil(o/e)},JF=function(n,t){return n.toCanvas().then((function(e){return $F(e,n.getType(),t)}))},$F=function(n,t,e){var o=e<0?360+e:e,r=o*Math.PI/180,i=n.width,u=n.height,a=Math.sin(r),c=Math.cos(r),s=KF(Math.abs(i*c)+Math.abs(u*a)),f=KF(Math.abs(i*a)+Math.abs(u*c)),l=uF(s,f),d=cF(l);return d.translate(s/2,f/2),d.rotate(r),d.drawImage(n,-i/2,-u/2),CF(l,t)},QF=function(n,t){return n.toCanvas().then((function(e){return ZF(e,n.getType(),t)}))},ZF=function(n,t,e){var o=uF(n.width,n.height),r=cF(o);return"v"===e?(r.scale(1,-1),r.drawImage(n,0,-o.height)):(r.scale(-1,1),r.drawImage(n,-o.width,0)),CF(o,t)},nI=function(n,t,e,o,r){return n.toCanvas().then((function(i){return tI(i,n.getType(),t,e,o,r)}))},tI=function(n,t,e,o,r,i){var u=uF(r,i),a=cF(u);return a.drawImage(n,-e,-o),CF(u,t)},eI=function(n,t,e){return n.toCanvas().then((function(o){return YF(o,t,e).then((function(t){return CF(t,n.getType())}))}))},oI=function(n){return LF(n)},rI=function(n){return GF(n)},iI=function(n,t){return XF(n,t)},uI=function(n,t,e,o){return WF(n,t,e,o)},aI=function(n,t){return jF(n,t)},cI=function(n,t){return UF(n,t)},sI=function(n,t){return QF(n,t)},fI=function(n,t,e,o,r){return nI(n,t,e,o,r)},lI=function(n,t,e){return eI(n,t,e)},dI=function(n,t){return JF(n,t)},mI=function(n,t){return T({dom:{tag:"span",innerHtml:n,classes:["tox-icon","tox-tbtn__icon-wrap"]}},t)},gI=function(n,t){return mI(nw(n,t),{})},pI=function(n,t){return mI(nw(n,t),{behaviours:Lf([wy.config({})])})},vI=function(n,t,e){return{dom:{tag:"span",innerHtml:e.translate(n),classes:[t+"__select-label"]},behaviours:Lf([wy.config({})])}},hI=Pu("toolbar.button.execute"),bI=function(n){return Fi((function(t,e){JC(n,t)((function(e){li(t,hI,{buttonApi:e}),n.onAction(e)}))}))},yI=(eD={},eD[Ur()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],eD),xI=Pu("update-menu-text"),wI=Pu("update-menu-icon"),SI=function(n,t,e){var o=Ke(p),r=n.text.map((function(n){return Qx(vI(n,t,e.providers))})),i=n.icon.map((function(n){return Qx(pI(n,e.providers.icons))})),u=function(n,t){var e=Kg.getValue(n);return My.focus(e),li(e,"keydown",{raw:t.event.raw}),bD.close(e),R.some(!0)},a=n.role.fold((function(){return{}}),(function(n){return{role:n}})),c=n.tooltip.fold((function(){return{}}),(function(n){var t=e.providers.translate(n);return{title:t,"aria-label":t}})),s=Qx(bD.sketch(T(T(T({},n.uid?{uid:n.uid}:{}),a),{dom:{tag:"button",classes:[t,t+"--select"].concat(G(n.classes,(function(n){return t+"--"+n}))),attributes:T({},c)},components:tO([i.map((function(n){return n.asSpec()})),r.map((function(n){return n.asSpec()})),R.some({dom:{tag:"div",classes:[t+"__select-chevron"],innerHtml:nw("chevron-down",e.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Lf(D(n.dropdownBehaviours,[KC.button((function(){return n.disabled||e.providers.isDisabled()})),WC(),SD.config({}),wy.config({}),ky("dropdown-events",[$C(n,o),QC(n,o)]),ky("menubutton-update-display-text",[xi(xI,(function(n,t){r.bind((function(t){return t.getOpt(n)})).each((function(n){wy.set(n,[vc(e.providers.translate(t.event.text))])}))})),xi(wI,(function(n,t){i.bind((function(t){return t.getOpt(n)})).each((function(n){wy.set(n,[pI(t.event.icon,e.providers.icons)])}))}))])])),eventOrder:Kn(yI,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Lf([ly.config({mode:"special",onLeft:u,onRight:u})]),lazySink:e.getSink,toggleClass:t+"--active",parts:{menu:VS(!1,n.columns,n.presets)},fetch:function(t){return RE.nu(w(n.fetch,t))}})));return s.asSpec()},kI=function(n){return i(n)},CI=function(n){return"separator"===n.type},OI=function(n){return Ln(n,"getSubmenuItems")},_I={type:"separator"},TI=function(n,t){var e=$(n,(function(n,e){return kI(e)?""===e?n:"|"===e?n.length>0&&!CI(n[n.length-1])?n.concat([_I]):n:Ln(t,e.toLowerCase())?n.concat([t[e.toLowerCase()]]):n:n.concat([e])}),[]);return e.length>0&&CI(e[e.length-1])&&e.pop(),e},EI=function(n,t){var e=n.getSubmenuItems(),o=AI(e,t),r=Kn(o.menus,ft(n.value,o.items)),i=Kn(o.expansions,ft(n.value,n.value));return{item:n,menus:r,expansions:i}},DI=function(n,t){return OI(n)?EI(n,t):{item:n,menus:{},expansions:{}}},BI=function(n){if(CI(n))return n;var t=Nn(n,"value").getOrThunk((function(){return Pu("generated-menu-item")}));return Kn({value:t},n)},AI=function(n,t){var e=TI(i(n)?n.split(" "):n,t);return J(e,(function(n,e){var o=BI(e),r=DI(o,t);return{menus:Kn(n.menus,r.menus),items:[r.item].concat(n.items),expansions:Kn(n.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},MI=function(n,t,e,o){var r=Pu("primary-menu"),i=AI(n,e.shared.providers.menuItems());if(0===i.items.length)return R.none();var u=aT(r,i.items,t,e,o),a=Mn(i.menus,(function(n,o){return aT(o,n,t,e,!1)})),c=Kn(a,ft(r,u));return R.from(Ix.tieredData(r,c,i.expansions))},FI=function(n){return{isDisabled:function(){return Jk.isDisabled(n)},setDisabled:function(t){return Jk.set(n,t)},setActive:function(t){var e=n.element;t?(Pa(e,"tox-tbtn--enabled"),ku(e,"aria-pressed",!0)):(za(e,"tox-tbtn--enabled"),Eu(e,"aria-pressed"))},isActive:function(){return Na(n.element,"tox-tbtn--enabled")}}},II=function(n,t,e,o){return SI({text:n.text,icon:n.icon,tooltip:n.tooltip,role:o,fetch:function(t,o){n.fetch((function(n){o(MI(n,cS.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:n.onSetup,getApi:FI,columns:1,presets:"normal",classes:[],dropdownBehaviours:[nE.config({})]},t,e.shared)},RI=function(n,t,e){var o=function(n){return function(o){var r=!o.isActive();o.setActive(r),n.storage.set(r),e.shared.getSink().each((function(e){t().getOpt(e).each((function(t){$f(t.element),li(t,lE,{name:n.name,value:n.storage.get()})}))}))}},r=function(n){return function(t){t.setActive(n.storage.get())}};return function(t){t(G(n,(function(n){var t=n.text.fold((function(){return{}}),(function(n){return{text:n}}));return T(T({type:n.type,active:!1},t),{onAction:o(n),onSetup:r(n)})})))}},VI=function(n,t,e,o,r,i){void 0===e&&(e=[]);var u=t.fold((function(){return{}}),(function(n){return{action:n}})),a=T({buttonBehaviours:Lf([KC.button((function(){return n.disabled||i.isDisabled()})),WC(),nE.config({}),ky("button press",[yi("click"),yi("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Kn(a,{dom:o});return Kn(c,{components:r})},PI=function(n,t,e,o){void 0===o&&(o=[]);var r=n.tooltip.map((function(n){return{"aria-label":e.translate(n),title:e.translate(n)}})).getOr({}),i={tag:"button",classes:["tox-tbtn"],attributes:r},u=n.icon.map((function(n){return gI(n,e.icons)})),a=tO([u]);return VI(n,t,o,i,a,e)},HI=function(n,t,e,o){void 0===o&&(o=[]);var r=PI(n,R.some(t),e,o);return $x.sketch(r)},zI=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(n.text),u=n.icon?n.icon.map((function(n){return gI(n,e.icons)})):R.none(),a=u.isSome()?tO([u]):[],c=u.isSome()?{}:{innerHtml:i},s=D(n.primary||n.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],n.borderless?["tox-button--naked"]:[],r),f=T(T({tag:"button",classes:s},c),{attributes:{title:i}});return VI(n,t,o,f,a,e)},NI=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=zI(n,R.some(t),e,o,r);return $x.sketch(i)},LI=function(n,t){return function(e){"custom"===t?li(e,lE,{name:n,value:{}}):"submit"===t?fi(e,dE):"cancel"===t&&fi(e,fE)}},jI=function(n,t){return"menu"===t},UI=function(n,t){return"custom"===t||"cancel"===t||"submit"===t},WI=function(n,t,e){if(jI(n,t)){var o=function(){return u},r=n,i=T(T({},n),{onSetup:function(t){return t.setDisabled(n.disabled),p},fetch:RI(r.items,o,e)}),u=Qx(II(i,"tox-tbtn",e,R.none()));return u.asSpec()}if(UI(n,t)){var a=LI(n.name,t),c=T(T({},n),{borderless:!1});return NI(c,a,e.shared.providers,[])}},GI=function(n,t){var e=LI(n.name,"custom");return oE(R.none(),JT.parts.field(T({factory:$x},zI(n,R.some(e),t,[GM.memory(""),DM.self()]))))},XI=y([He("field1Name","field1"),He("field2Name","field2"),Ns("onLockedChange"),Vs(["lockClass"]),He("locked",!1),Zg.field("coupledFieldBehaviours",[yv,Kg])]),YI=function(n,t,e){return Up(n,t,e).bind(yv.getCurrent)},qI=function(n,t){return Ep({factory:JT,name:n,overrides:function(n){return{fieldBehaviours:Lf([ky("coupled-input-behaviour",[xi(Mr(),(function(e){YI(e,n,t).each((function(t){Up(e,n,"lock").each((function(o){$y.isOn(o)&&n.onLockedChange(e,t,o)}))}))}))])])}}})},KI=y([qI("field1","field2"),qI("field2","field1"),Ep({factory:$x,schema:[ye("dom")],name:"lock",overrides:function(n){return{buttonBehaviours:Lf([$y.config({selected:n.locked,toggleClass:n.markers.lockClass,aria:{mode:"pressed"}})])}}})]),JI=function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Zg.augment(n.coupledFieldBehaviours,[yv.config({find:R.some}),Kg.config({store:{mode:"manual",getValue:function(t){var e,o=qp(t,n,["field1","field2"]);return e={},e[n.field1Name]=Kg.getValue(o.field1()),e[n.field2Name]=Kg.getValue(o.field2()),e},setValue:function(t,e){var o=qp(t,n,["field1","field2"]);jn(e,n.field1Name)&&Kg.setValue(o.field1(),e[n.field1Name]),jn(e,n.field2Name)&&Kg.setValue(o.field2(),e[n.field2Name])}}})]),apis:{getField1:function(t){return Up(t,n,"field1")},getField2:function(t){return Up(t,n,"field2")},getLock:function(t){return Up(t,n,"lock")}}}},$I=cv({name:"FormCoupledInputs",configFields:XI(),partFields:KI(),factory:JI,apis:{getField1:function(n,t){return n.getField1(t)},getField2:function(n,t){return n.getField2(t)},getLock:function(n,t){return n.getLock(t)}}}),QI=function(n){var t={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},e=function(n){return n in t?t[n]:1},o=n.value.toFixed(e(n.unit));return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+n.unit},ZI=function(n){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/,e=t.exec(n);if(null!==e){var o=parseFloat(e[1]),r=e[2];return hn.value({value:o,unit:r})}return hn.error(n)},nR=function(n,t){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(n){return Object.prototype.hasOwnProperty.call(e,n)};return n.unit===t?R.some(n.value):o(n.unit)&&o(t)?e[n.unit]===e[t]?R.some(n.value):R.some(n.value/e[n.unit]*e[t]):R.none()},tR=function(n){return R.none()},eR=function(n,t){return function(e){return nR(e,t).map((function(e){return{value:e*n,unit:t}}))}},oR=function(n,t){var e=ZI(n).toOptional(),o=ZI(t).toOptional();return lv(e,o,(function(n,t){return nR(n,t.unit).map((function(n){return t.value/n})).map((function(n){return eR(n,t.unit)})).getOr(tR)})).getOr(tR)},rR=function(n,t){var e=tR,o=Pu("ratio-event"),r=$I.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(n.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:nw("lock",t.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:nw("unlock",t.icons)}}],buttonBehaviours:Lf([Jk.config({disabled:function(){return n.disabled||t.isDisabled()}}),WC(),nE.config({})])}),i=function(n){return{dom:{tag:"div",classes:["tox-form__group"]},components:n}},u=function(e){return JT.parts.field({factory:kE,inputClasses:["tox-textfield"],inputBehaviours:Lf([Jk.config({disabled:function(){return n.disabled||t.isDisabled()}}),WC(),nE.config({}),ky("size-input-events",[xi(Er(),(function(n,t){li(n,o,{isField1:e})})),xi(Fr(),(function(t,e){li(t,cE,{name:n.name})}))])]),selectOnFocus:!1})},a=function(n){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}}},c=$I.parts.field1(i([JT.parts.label(a("Width")),u(!0)])),s=$I.parts.field2(i([JT.parts.label(a("Height")),u(!1)]));return $I.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(n,t,o){ZI(Kg.getValue(n)).each((function(n){e(n).each((function(n){Kg.setValue(t,QI(n))}))}))},coupledFieldBehaviours:Lf([Jk.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){$I.getField1(n).bind(JT.getField).each(Jk.disable),$I.getField2(n).bind(JT.getField).each(Jk.disable),$I.getLock(n).each(Jk.disable)},onEnabled:function(n){$I.getField1(n).bind(JT.getField).each(Jk.enable),$I.getField2(n).bind(JT.getField).each(Jk.enable),$I.getLock(n).each(Jk.enable)}}),WC(),ky("size-input-events2",[xi(o,(function(n,t){var o=t.event.isField1,r=o?$I.getField1(n):$I.getField2(n),i=o?$I.getField2(n):$I.getField1(n),u=r.map(Kg.getValue).getOr(""),a=i.map(Kg.getValue).getOr("");e=oR(u,a)}))])])})},iR=y(Pu("undo")),uR=y(Pu("redo")),aR=y(Pu("zoom")),cR=y(Pu("back")),sR=y(Pu("apply")),fR=y(Pu("swap")),lR=y(Pu("transform")),dR=y(Pu("temp-transform")),mR=y(Pu("transform-apply")),gR={undo:iR,redo:uR,zoom:aR,back:cR,apply:sR,swap:fR,transform:lR,tempTransform:dR,transformApply:mR},pR=y("save-state"),vR=y("disable"),hR=y("enable"),bR={formActionEvent:lE,saveState:pR,disable:vR,enable:hR},yR=function(n,t){var e=function(n,e,o,r){return Qx(NI({name:n,text:n,disabled:o,primary:r,icon:R.none(),borderless:!1},e,t))},o=function(n,e,o,r){return Qx(HI({name:n,icon:R.some(n),tooltip:R.some(e),disabled:r,primary:!1,borderless:!1},o,t))},r=function(n,t){n.map((function(n){var e=n.get(t);e.hasConfigured(Jk)&&Jk.disable(e)}))},i=function(n,t){n.map((function(n){var e=n.get(t);e.hasConfigured(Jk)&&Jk.enable(e)}))},u={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},a=p,c=function(n,t,e){li(n,t,e)},s=function(n){return fi(n,bR.disable())},f=function(n){return fi(n,bR.enable())},l=function(n,t){s(n),c(n,gR.transform(),{transform:t}),f(n)},d=function(n,t){s(n),c(n,gR.tempTransform(),{transform:t}),f(n)},m=function(n){return function(){an.getOpt(n).each((function(n){wy.set(n,[rn])}))}},g=function(n,t){s(n),c(n,gR.transformApply(),{transform:t,swap:m(n)}),f(n)},v=function(){return e("Back",(function(n){return c(n,gR.back(),{swap:m(n)})}),!1,!1)},h=function(){return Qx({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Lf([Jk.config({})])})},b=function(){return e("Apply",(function(n){return c(n,gR.apply(),{swap:m(n)})}),!0,!0)},x=function(){return function(t){var e=n.getRect();return fI(t,e.x,e.y,e.w,e.h)}},w=[v(),h(),e("Apply",(function(t){var e=x();g(t,e),n.hideCrop()}),!1,!0)],S=WT.sketch({dom:u,components:w.map((function(n){return n.asSpec()})),containerBehaviours:Lf([ky("image-tools-crop-buttons-events",[xi(bR.disable(),(function(n,t){r(w,n)})),xi(bR.enable(),(function(n,t){i(w,n)}))])])}),k=Qx(rR({name:"size",label:R.none(),constrain:!0,disabled:!1},t)),C=function(n,t){return function(e){return lI(e,n,t)}},O=[v(),h(),k,h(),e("Apply",(function(n){k.getOpt(n).each((function(t){var e=Kg.getValue(t),o=parseInt(e.width,10),r=parseInt(e.height,10),i=C(o,r);g(n,i)}))}),!1,!0)],_=WT.sketch({dom:u,components:O.map((function(n){return n.asSpec()})),containerBehaviours:Lf([ky("image-tools-resize-buttons-events",[xi(bR.disable(),(function(n,t){r(O,n)})),xi(bR.enable(),(function(n,t){i(O,n)}))])])}),T=function(n,t){return function(e){return n(e,t)}},E=T(sI,"h"),D=T(sI,"v"),B=T(dI,-90),A=T(dI,90),M=function(n,t){d(n,t)},F=[v(),h(),o("flip-horizontally","Flip horizontally",(function(n){M(n,E)}),!1),o("flip-vertically","Flip vertically",(function(n){M(n,D)}),!1),o("rotate-left","Rotate counterclockwise",(function(n){M(n,B)}),!1),o("rotate-right","Rotate clockwise",(function(n){M(n,A)}),!1),h(),b()],I=WT.sketch({dom:u,components:F.map((function(n){return n.asSpec()})),containerBehaviours:Lf([ky("image-tools-fliprotate-buttons-events",[xi(bR.disable(),(function(n,t){r(F,n)})),xi(bR.enable(),(function(n,t){i(F,n)}))])])}),V=function(n,e,o,r,i){var u=oM.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}}),a=oM.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),c=oM.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Qx(oM.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:i,getInitialValue:y({x:r})},components:[u,a,c],sliderBehaviours:Lf([My.config({})]),onChoose:e}))},P=function(n,t,e,o,r){var i=function(n,e,o){var r=T(t,o.x/100);l(n,r)};return V(n,i,e,o,r)},H=function(n,t,e,o,r){return[v(),P(n,t,e,o,r),b()]},z=function(n,t,e,o,a){var c=H(n,t,e,o,a);return WT.sketch({dom:u,components:c.map((function(n){return n.asSpec()})),containerBehaviours:Lf([ky("image-tools-filter-panel-buttons-events",[xi(bR.disable(),(function(n,t){r(c,n)})),xi(bR.enable(),(function(n,t){i(c,n)}))])])})},N=[v(),h(),b()],L=WT.sketch({dom:u,components:N.map((function(n){return n.asSpec()}))}),j=z("Brightness",aI,-100,0,100),U=z("Contrast",cI,-100,0,100),W=z("Gamma",iI,-100,0,100),G=function(n,t,e){return function(o){return uI(o,n,t,e)}},X=function(n){var t=function(n,t,e){var o=Y.getOpt(n),r=K.getOpt(n),i=q.getOpt(n);o.each((function(t){r.each((function(e){i.each((function(o){var r=Kg.getValue(t).x/100,i=Kg.getValue(o).x/100,u=Kg.getValue(e).x/100,a=G(r,i,u);l(n,a)}))}))}))};return V(n,t,0,100,200)},Y=X("R"),q=X("G"),K=X("B"),J=[v(),Y,q,K,b()],$=WT.sketch({dom:u,components:J.map((function(n){return n.asSpec()}))}),Q=function(n,t,e){return function(o){var r=function(){an.getOpt(o).each((function(t){wy.set(t,[n]),e(t)}))};c(o,gR.swap(),{transform:t,swap:r})}},Z=function(t){n.showCrop()},nn=function(t){k.getOpt(t).each((function(t){var e=n.getMeasurements(),o=e.width,r=e.height;Kg.setValue(t,{width:o,height:r})}))},tn=R.some(rI),en=R.some(oI),on=[o("crop","Crop",Q(S,R.none(),Z),!1),o("resize","Resize",Q(_,R.none(),nn),!1),o("orientation","Orientation",Q(I,R.none(),a),!1),o("brightness","Brightness",Q(j,R.none(),a),!1),o("sharpen","Sharpen",Q(L,tn,a),!1),o("contrast","Contrast",Q(U,R.none(),a),!1),o("color-levels","Color levels",Q($,R.none(),a),!1),o("gamma","Gamma",Q(W,R.none(),a),!1),o("invert","Invert",Q(L,en,a),!1)],rn=WT.sketch({dom:u,components:on.map((function(n){return n.asSpec()}))}),un=WT.sketch({dom:{tag:"div"},components:[rn],containerBehaviours:Lf([wy.config({})])}),an=Qx(un),cn=function(n){return an.getOpt(n).map((function(n){var t=n.components()[0];return t.components()[t.components().length-1]}))};return{memContainer:an,getApplyButton:cn}},xR=tinymce.util.Tools.resolve("tinymce.geom.Rect"),wR=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),SR=tinymce.util.Tools.resolve("tinymce.util.Observable"),kR=tinymce.util.Tools.resolve("tinymce.util.VK"),CR=function(n){var t=Math.max,e=n.documentElement,o=n.body,r=t(e.scrollWidth,o.scrollWidth),i=t(e.clientWidth,o.clientWidth),u=t(e.offsetWidth,o.offsetWidth),a=t(e.scrollHeight,o.scrollHeight),c=t(e.clientHeight,o.clientHeight),s=t(e.offsetHeight,o.offsetHeight);return{width:r<u?i:r,height:a<s?c:a}},OR=function(n){var t,e;if(n.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<t.length;e++)n[t[e]]=n.changedTouches[0][t[e]]};function _R(n,t){var e,o,r,i,u=t.document||document,a=u.getElementById(t.handle||n),c=function(n){var c,l=CR(u);OR(n),n.preventDefault(),o=n.button;var d=a;r=n.screenX,i=n.screenY,c=window.getComputedStyle?window.getComputedStyle(d,null).getPropertyValue("cursor"):d.runtimeStyle.cursor,e=wR("<div></div>").css({position:"absolute",top:0,left:0,width:l.width,height:l.height,zIndex:2147483647,opacity:1e-4,cursor:c}).appendTo(u.body),wR(u).on("mousemove touchmove",s).on("mouseup touchend",f),t.start(n)},s=function(n){if(OR(n),n.button!==o)return f(n);n.deltaX=n.screenX-r,n.deltaY=n.screenY-i,n.preventDefault(),t.drag(n)},f=function(n){OR(n),wR(u).off("mousemove touchmove",s).off("mouseup touchend",f),e.remove(),t.stop&&t.stop(n)},l=function(){wR(a).off()};return wR(a).on("mousedown touchstart",c),{destroy:l}}var TR=0,ER=function(n,t,e,o,r){var i,u="tox-",a=u+"crid-"+TR++,c=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],s=["top","right","bottom","left"],f=function(n,t){return{x:t.x+n.x,y:t.y+n.y,w:t.w,h:t.h}},l=function(n,t){return{x:t.x-n.x,y:t.y-n.y,w:t.w,h:t.h}},d=function(){return l(e,n)},m=function(t,o,r,i){var u,a,c,s,f;u=o.x,a=o.y,c=o.w,s=o.h,u+=r*t.deltaX,a+=i*t.deltaY,c+=r*t.deltaW,s+=i*t.deltaH,c<20&&(c=20),s<20&&(s=20),f=n=xR.clamp({x:u,y:a,w:c,h:s},e,"move"===t.name),f=l(e,f),S.fire("updateRect",{rect:f}),y(f)},g=function(){var t=function(t){var e;return _R(a,{document:o.ownerDocument,handle:a+"-"+t.name,start:function(){e=n},drag:function(n){m(t,e,n.deltaX,n.deltaY)}})};wR('<div id="'+a+'" class="'+u+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),PM.each(s,(function(n){wR("#"+a,o).append('<div id="'+a+"-"+n+'"class="'+u+'croprect-block" style="display: none" data-mce-bogus="all">')})),PM.each(c,(function(n){wR("#"+a,o).append('<div id="'+a+"-"+n.name+'" class="'+u+"croprect-handle "+u+"croprect-handle-"+n.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+n.label+'" aria-grabbed="false" title="'+n.label+'">')})),i=PM.map(c,t),v(n),wR(o).on("focusin focusout",(function(n){wR(n.target).attr("aria-grabbed","focus"===n.type?"true":"false")})),wR(o).on("keydown",(function(t){var e;PM.each(c,(function(n){if(t.target.id===a+"-"+n.name)return e=n,!1}));var o=function(n,t,o,r,i){n.stopPropagation(),n.preventDefault(),m(e,o,r,i)};switch(t.keyCode){case kR.LEFT:o(t,e,n,-10,0);break;case kR.RIGHT:o(t,e,n,10,0);break;case kR.UP:o(t,e,n,0,-10);break;case kR.DOWN:o(t,e,n,0,10);break;case kR.ENTER:case kR.SPACEBAR:t.preventDefault(),r();break}}))},p=function(n){var t=PM.map(c,(function(n){return"#"+a+"-"+n.name})).concat(PM.map(s,(function(n){return"#"+a+"-"+n}))).join(",");n?wR(t,o).show():wR(t,o).hide()},v=function(n){var e=function(n,t){t.h<0&&(t.h=0),t.w<0&&(t.w=0),wR("#"+a+"-"+n,o).css({left:t.x,top:t.y,width:t.w,height:t.h})};PM.each(c,(function(t){wR("#"+a+"-"+t.name,o).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})})),e("top",{x:t.x,y:t.y,w:t.w,h:n.y-t.y}),e("right",{x:n.x+n.w,y:n.y,w:t.w-n.x-n.w+t.x,h:n.h}),e("bottom",{x:t.x,y:n.y+n.h,w:t.w,h:t.h-n.y-n.h+t.y}),e("left",{x:t.x,y:n.y,w:n.x-t.x,h:n.h}),e("move",n)},h=function(t){n=t,v(n)},b=function(e){t=e,v(n)},y=function(n){h(f(e,n))},x=function(t){e=t,v(n)},w=function(){PM.each(i,(function(n){n.destroy()})),i=[]};g();var S=PM.extend({toggleVisibility:p,setClampRect:x,setRect:h,getInnerRect:d,setInnerRect:y,setViewPortRect:b,destroy:w},SR);return S},DR={create:ER},BR=function(n){return new Ow((function(t){var e=function(){n.removeEventListener("load",e),t(n)};n.complete?t(n):n.addEventListener("load",e)}))},AR=function(n){var t=Qx({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=Ke(1),o=Ke(R.none()),r=Ke({x:0,y:0,w:1,h:1}),i=Ke({x:0,y:0,w:1,h:1}),u=function(n,i){g.getOpt(n).each((function(n){var u=e.get(),a=Ic(n.element),c=kc(n.element),s=i.dom.naturalWidth*u,f=i.dom.naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"};Ja(i,m),t.getOpt(n).each((function(n){Ja(n.element,m)})),o.get().each((function(n){var t=r.get();n.setRect({x:t.x*u+l,y:t.y*u+d,w:t.w*u,h:t.h*u}),n.setClampRect({x:l,y:d,w:s,h:f}),n.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(n,t){g.getOpt(n).each((function(n){var o=Ic(n.element),r=kc(n.element),i=t.dom.naturalWidth,u=t.dom.naturalHeight,a=Math.min(o/i,r/u);a>=1?e.set(1):e.set(a)}))},c=function(n,t){var e=to.fromTag("img");return ku(e,"src",t),BR(e.dom).then((function(){return g.getOpt(n).map((function(n){var t=hc({element:e});wy.replaceAt(n,1,R.some(t));var o=i.get(),c={x:0,y:0,w:e.dom.naturalWidth,h:e.dom.naturalHeight};i.set(c);var s=xR.inflate(c,-20,-20);return r.set(s),o.w===c.w&&o.h===c.h||a(n,e),u(n,e),e}))}))},s=function(n,t){var o=e.get(),r=t>0?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),g.getOpt(n).each((function(n){var t=n.components()[1].element;u(n,t)}))},f=function(){o.get().each((function(n){n.toggleVisibility(!0)}))},l=function(){o.get().each((function(n){n.toggleVisibility(!1)}))},d=function(){return r.get()},m=WT.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[t.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:Lf([ky("image-panel-crop-events",[Bi((function(n){g.getOpt(n).each((function(n){var t=n.element.dom,i=DR.create({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,p);i.toggleVisibility(!1),i.on("updateRect",(function(n){var t=n.rect,o=e.get(),i={x:Math.round(t.x/o),y:Math.round(t.y/o),w:Math.round(t.w/o),h:Math.round(t.h/o)};r.set(i)})),o.set(R.some(i))}))}))])])}],containerBehaviours:Lf([wy.config({}),ky("image-panel-events",[Bi((function(t){c(t,n)}))])])}),g=Qx(m),v=function(){var n=i.get();return{width:n.w,height:n.h}};return{memContainer:g,updateSrc:c,zoom:s,showCrop:f,hideCrop:l,getRect:d,getMeasurements:v}},MR=function(n,t,e,o,r){return HI({name:n,icon:R.some(t),disabled:e,tooltip:R.some(n),primary:!1,borderless:!1},o,r)},FR=function(n,t){t?Jk.enable(n):Jk.disable(n)},IR=function(n){var t=function(n,t,r){e.getOpt(n).each((function(n){FR(n,t)})),o.getOpt(n).each((function(n){FR(n,r)}))},e=Qx(MR("Undo","undo",!0,(function(n){li(n,gR.undo(),{direction:1})}),n)),o=Qx(MR("Redo","redo",!0,(function(n){li(n,gR.redo(),{direction:1})}),n)),r=WT.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[e.asSpec(),o.asSpec(),MR("Zoom in","zoom-in",!1,(function(n){li(n,gR.zoom(),{direction:1})}),n),MR("Zoom out","zoom-out",!1,(function(n){li(n,gR.zoom(),{direction:-1})}),n)]});return{container:r,updateButtonUndoStates:t}};function RR(){var n=[],t=-1,e=function(e){var o=n.splice(++t);return n.push(e),{state:e,removed:o}},o=function(){if(i())return n[--t]},r=function(){if(u())return n[++t]},i=function(){return t>0},u=function(){return-1!==t&&t<n.length-1};return{data:n,add:e,undo:o,redo:r,canUndo:i,canRedo:u}}var VR,PR=function(n){var t=Ke(n),e=Ke(R.none()),o=RR();o.add(n);var r=function(){return t.get()},i=function(n){t.set(n)},u=function(){return e.get().fold((function(){return t.get()}),(function(n){return n}))},a=function(n){var t=c(n);return l(),e.set(R.some(t)),t.url},c=function(n){return{blob:n,url:URL.createObjectURL(n)}},s=function(n){URL.revokeObjectURL(n.url)},f=function(n){PM.each(n,s)},l=function(){e.get().each(s),e.set(R.none())},d=function(n){var t=c(n);i(t);var e=o.add(t).removed;return f(e),t.url},m=function(n){var t=c(n);return e.set(R.some(t)),t.url},g=function(n){return e.get().fold(p,(function(t){d(t.blob),n()}))},v=function(){var n=o.undo();return i(n),n.url},h=function(){var n=o.redo();return i(n),n.url},b=function(){var n=o.canUndo(),t=o.canRedo();return{undoEnabled:n,redoEnabled:t}};return{getBlobState:r,setBlobState:i,addBlobState:d,getTempState:u,updateTempState:a,addTempState:m,applyTempState:g,destroyTempState:l,undo:v,redo:h,getHistoryStates:b}},HR=function(n,t){var e=PR(n.currentState),o=function(n,t){var e=t.event.direction;C.zoom(n,e)},r=function(n){var t=e.getHistoryStates();O.updateButtonUndoStates(n,t.undoEnabled,t.redoEnabled),li(n,bR.formActionEvent,{name:bR.saveState(),value:t.undoEnabled})},i=function(n){O.updateButtonUndoStates(n,!1,!1)},u=function(n,t){var o=e.undo();l(n,o).then((function(t){f(n),r(n)}))},a=function(n,t){var o=e.redo();l(n,o).then((function(t){f(n),r(n)}))},c=function(n){return n.toBlob()},s=function(n){li(n,bR.formActionEvent,{name:bR.disable(),value:{}})},f=function(n){_.getApplyButton(n).each((function(n){Jk.enable(n)})),li(n,bR.formActionEvent,{name:bR.enable(),value:{}})},l=function(n,t){return s(n),C.updateSrc(n,t)},d=function(n,t,e,o,i){return s(n),OF(t).then(e).then(c).then(o).then((function(t){return l(n,t).then((function(t){return r(n),i(),f(n),t}))})).catch((function(t){return f(n),t}))},m=function(n,t,o){var r=e.getBlobState().blob,i=function(n){return e.updateTempState(n)};d(n,r,t,i,o)},g=function(n,t){var o=e.getTempState().blob,r=function(n){return e.addTempState(n)};d(n,o,t,r,p)},v=function(n,t,o){var r=e.getBlobState().blob,i=function(t){var o=e.addBlobState(t);return b(n),o};d(n,r,t,i,o)},h=function(n,t){var o=function(){b(n);var e=t.event.swap;e()};e.applyTempState(o)},b=function(n){var t=e.getBlobState().url;return e.destroyTempState(),r(n),t},y=function(n){var t=b(n);l(n,t).then((function(t){f(n)}))},x=function(n,t){y(n);var e=t.event.swap;e(),C.hideCrop()},w=function(n,t){return m(n,t.event.transform,p)},S=function(n,t){return g(n,t.event.transform)},k=function(n,t){return v(n,t.event.transform,t.event.swap)},C=AR(n.currentState.url),O=IR(t),_=yR(C,t),T=function(n,t){i(n);var e=t.event.transform,o=t.event.swap;e.fold((function(){o()}),(function(t){m(n,t,o)}))};return{dom:{tag:"div",attributes:{role:"presentation"}},components:[_.memContainer.asSpec(),C.memContainer.asSpec(),O.container],behaviours:Lf([Kg.config({store:{mode:"manual",getValue:function(){return e.getBlobState()}}}),ky("image-tools-events",[xi(gR.undo(),u),xi(gR.redo(),a),xi(gR.zoom(),o),xi(gR.back(),x),xi(gR.apply(),h),xi(gR.transform(),w),xi(gR.tempTransform(),S),xi(gR.transformApply(),k),xi(gR.swap(),T)]),DM.self()])}},zR=function(n,t){var e={dom:{tag:"label",innerHtml:t.providers.translate(n.label),classes:["tox-label"]}},o=G(n.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:Lf([DM.self(),wy.config({}),GM.domHtml(R.none()),ly.config({mode:"acyclic"})])}},NR=function(n){return!Ln(n,"items")},LR="data-value",jR=function(n,t,e,o){return G(e,(function(e){return NR(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){Kg.setValue(n,e.value),li(n,cE,{name:t}),My.focus(n)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return jR(n,t,e.items,o)}}}))},UR=function(n,t){return mn(n,(function(n){return NR(n)?gv(n.value===t,n):UR(n.items,t)}))},WR=function(n,t){var e=t.shared.providers,o=fn(n.items).filter(NR),r=n.label.map((function(n){return aE(n,e)})),i=JT.parts.field({dom:{},factory:{sketch:function(e){return SI({uid:e.uid,text:o.map((function(n){return n.text})),icon:R.none(),tooltip:n.label,role:R.none(),fetch:function(e,o){var r=jR(e,n.name,n.items,Kg.getValue(e));o(MI(r,cS.CLOSE_ON_EXECUTE,t,!1))},onSetup:y(p),getApi:y({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[nE.config({}),Kg.config({store:{mode:"manual",initialValue:o.map((function(n){return n.value})).getOr(""),getValue:function(n){return Ou(n.element,LR)},setValue:function(t,e){UR(n.items,e).each((function(n){ku(t.element,LR,n.value),li(t,xI,{text:n.text})}))}}})]},"tox-listbox",t.shared)}}}),u={dom:{tag:"div",classes:["tox-listboxfield"]},components:[i]};return JT.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:tn([r.toArray(),[u]]),fieldBehaviours:Lf([Jk.config({disabled:y(n.disabled),onDisabled:function(n){JT.getField(n).each(Jk.disable)},onEnabled:function(n){JT.getField(n).each(Jk.enable)}})])})},GR=function(n,t){return{dom:{tag:"div",classes:n.classes},components:G(n.items,t.shared.interpreter)}},XR=function(n,t){var e=G(n.options,(function(n){return{dom:{tag:"option",value:n.value,innerHtml:n.text}}})),o=n.data.map((function(n){return ft("initialValue",n)})).getOr({});return{uid:n.uid,dom:{tag:"select",classes:n.selectClasses,attributes:n.selectAttributes},components:e,behaviours:Qg(n.selectBehaviours,[My.config({}),Kg.config({store:T({mode:"manual",getValue:function(n){return ic(n.element)},setValue:function(t,e){var o=Z(n.options,(function(n){return n.value===e}));o.isSome()&&uc(t.element,e)}},o)})])}},YR=av({name:"HtmlSelect",configFields:[ye("options"),Jg("selectBehaviours",[My,Kg]),He("selectClasses",[]),He("selectAttributes",{}),Be("data")],factory:XR}),qR=function(n,t){var e=G(n.items,(function(n){return{text:t.translate(n.text),value:n.value}})),o=n.label.map((function(n){return aE(n,t)})),r=JT.parts.field({dom:{},selectAttributes:{size:n.size},options:e,factory:YR,selectBehaviours:Lf([Jk.config({disabled:function(){return n.disabled||t.isDisabled()}}),nE.config({}),ky("selectbox-change",[xi(Fr(),(function(t,e){li(t,cE,{name:n.name})}))])])}),i=n.size>1?R.none():R.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:nw("chevron-down",t.icons)}}),u={dom:{tag:"div",classes:["tox-selectfield"]},components:tn([[r],i.toArray()])};return JT.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:tn([o.toArray(),[u]]),fieldBehaviours:Lf([Jk.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){JT.getField(n).each(Jk.disable)},onEnabled:function(n){JT.getField(n).each(Jk.enable)}}),WC()])})},KR=function(n,t){var e=function(n){return{dom:{tag:"th",innerHtml:t.translate(n)}}},o=function(n){return{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:G(n,e)}]}},r=function(n){return{dom:{tag:"td",innerHtml:t.translate(n)}}},i=function(n){return{dom:{tag:"tr"},components:G(n,r)}},u=function(n){return{dom:{tag:"tbody"},components:G(n,i)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[o(n.header),u(n.cells)],behaviours:Lf([nE.config({}),My.config({})])}},JR=function(n,t){var e=n.label.map((function(n){return aE(n,t)})),o=[Jk.config({disabled:function(){return n.disabled||t.isDisabled()}}),WC(),ly.config({mode:"execution",useEnter:!0!==n.multiline,useControlEnter:!0===n.multiline,execute:function(n){return fi(n,dE),R.some(!0)}}),ky("textfield-change",[xi(Mr(),(function(t,e){li(t,cE,{name:n.name})})),xi(Lr(),(function(t,e){li(t,cE,{name:n.name})}))]),nE.config({})],r=n.validation.map((function(n){return YE.config({getRoot:function(n){return Gi(n.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var e=Kg.getValue(t),o=n.validator(e);return RE.pure(!0===o?hn.value(e):hn.error(o))},validateOnLoad:n.validateOnLoad}})})).toArray(),i=n.placeholder.fold(y({}),(function(n){return{placeholder:t.translate(n)}})),u=n.inputMode.fold(y({}),(function(n){return{inputmode:n}})),a=T(T({},i),u),c=JT.parts.field({tag:!0===n.multiline?"textarea":"input",inputAttributes:a,inputClasses:[n.classname],inputBehaviours:Lf(tn([o,r])),selectOnFocus:!1,factory:kE}),s=n.flex?["tox-form__group--stretched"]:[],f=s.concat(n.maximized?["tox-form-group--maximize"]:[]),l=[Jk.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){JT.getField(n).each(Jk.disable)},onEnabled:function(n){JT.getField(n).each(Jk.enable)}}),WC()];return eE(e,c,f,l)},$R=function(n,t){return JR({name:n.name,multiline:!1,label:n.label,inputMode:n.inputMode,placeholder:n.placeholder,flex:!1,disabled:n.disabled,classname:"tox-textfield",validation:R.none(),maximized:n.maximized},t)},QR=function(n,t){return JR({name:n.name,multiline:!0,label:n.label,inputMode:R.none(),placeholder:n.placeholder,flex:!0,disabled:n.disabled,classname:"tox-textarea",validation:R.none(),maximized:n.maximized},t)},ZR=function(n,t){var e=n.stream.streams,o=e.setup(n,t);return vi([xi(n.event,o),Ai((function(){return t.cancel()}))].concat(n.cancelEvent.map((function(n){return[xi(n,(function(){return t.cancel()}))]})).getOr([])))},nV=Object.freeze({__proto__:null,events:ZR}),tV=function(n){var t=Ke(null),e=function(){return{timer:null!==t.get()?"set":"unset"}},o=function(n){t.set(n)},r=function(){var n=t.get();null!==n&&n.cancel()};return ra({readState:e,setTimer:o,cancel:r})},eV=function(n){return n.stream.streams.state(n)},oV=Object.freeze({__proto__:null,throttle:tV,init:eV}),rV=function(n,t){var e=n.stream,o=sw(n.onStream,e.delay);return t.setTimer(o),function(n,t){o.throttle(n,t),e.stopEvent&&t.stop()}},iV=[xe("stream",ce("mode",{throttle:[ye("delay"),He("stopEvent",!0),js("streams",{setup:rV,state:tV})]})),He("event","input"),Be("cancelEvent"),Ns("onStream")],uV=Uf({fields:iV,name:"streaming",active:nV,state:oV}),aV=function(n,t,e){var o=Kg.getValue(e);Kg.setValue(t,o),sV(t)},cV=function(n,t){var e=n.element,o=ic(e),r=e.dom;"number"!==Ou(e,"type")&&t(r,o)},sV=function(n){cV(n,(function(n,t){return n.setSelectionRange(t.length,t.length)}))},fV=function(n,t){cV(n,(function(n,e){return n.setSelectionRange(t,e.length)}))},lV=function(n,t,e){if(n.selectsOver){var o=Kg.getValue(t),r=n.getDisplayText(o),i=Kg.getValue(e),u=n.getDisplayText(i);return 0===u.indexOf(r)?R.some((function(){aV(n,t,e),fV(t,r.length)})):R.none()}return R.none()},dV=y("alloy.typeahead.itemexecute"),mV=function(n,t,e,o){var r=function(t,e,r){n.previewing.set(!1);var i=ZE.getCoupled(t,"sandbox");if(mg.isOpen(i))yv.getCurrent(i).each((function(n){zv.getHighlighted(n).fold((function(){r(n)}),(function(){pi(i,n.element,"keydown",e)}))}));else{var a=function(n){yv.getCurrent(n).each(r)};uD(n,u(t),t,i,o,a,_E.HighlightFirst).get(p)}},i=yE(n),u=function(n){return function(t){return t.map((function(t){var e=zn(t.menus),o=en(e,(function(n){return K(n.items,(function(n){return"item"===n.type}))})),r=Kg.getState(n);return r.update(G(o,(function(n){return n.data}))),t}))}},a=[My.config({}),Kg.config({onSetValue:n.onSetValue,store:T({mode:"dataset",getDataKey:function(n){return ic(n.element)},getFallbackEntry:function(n){return{value:n,meta:{}}},setValue:function(t,e){uc(t.element,n.model.getDisplayText(e))}},n.initialData.map((function(n){return ft("initialValue",n)})).getOr({}))}),uV.config({stream:{mode:"throttle",delay:n.responseTime,stopEvent:!1},onStream:function(t,e){var r=ZE.getCoupled(t,"sandbox"),i=My.isFocused(t);if(i&&ic(t.element).length>=n.minChars){var a=yv.getCurrent(r).bind((function(n){return zv.getHighlighted(n).map(Kg.getValue)}));n.previewing.set(!0);var c=function(t){yv.getCurrent(r).each((function(t){a.fold((function(){n.model.selectsOver&&zv.highlightFirst(t)}),(function(n){zv.highlightBy(t,(function(t){var e=Kg.getValue(t);return e.value===n.value})),zv.getHighlighted(t).orThunk((function(){return zv.highlightFirst(t),R.none()}))}))}))};uD(n,u(t),t,r,o,c,_E.HighlightFirst).get(p)}},cancelEvent:qr()}),ly.config({mode:"special",onDown:function(n,t){return r(n,t,zv.highlightFirst),R.some(!0)},onEscape:function(n){var t=ZE.getCoupled(n,"sandbox");return mg.isOpen(t)?(mg.close(t),R.some(!0)):R.none()},onUp:function(n,t){return r(n,t,zv.highlightLast),R.some(!0)},onEnter:function(t){var e=ZE.getCoupled(t,"sandbox"),o=mg.isOpen(e);if(o&&!n.previewing.get())return yv.getCurrent(e).bind((function(n){return zv.getHighlighted(n)})).map((function(n){return li(t,dV(),{item:n}),!0}));var r=Kg.getValue(t);return fi(t,qr()),n.onExecute(e,t,r),o&&mg.close(e),R.some(!0)}}),$y.config({toggleClass:n.markers.openClass,aria:{mode:"expanded"}}),ZE.config({others:{sandbox:function(t){return dD(n,t,{onOpen:function(){return $y.on(t)},onClose:function(){return $y.off(t)}})}}}),ky("typeaheadevents",[Fi((function(t){var e=p;cD(n,u(t),t,o,e,_E.HighlightFirst).get(p)})),xi(dV(),(function(t,e){var o=ZE.getCoupled(t,"sandbox");aV(n.model,t,e.event.item),fi(t,qr()),n.onItemExecute(t,o,e.event.item,Kg.getValue(t)),mg.close(o),sV(t)}))].concat(n.dismissOnBlur?[xi(Nr(),(function(n){var t=ZE.getCoupled(n,"sandbox");tl(t.element).isNone()&&mg.close(t)}))]:[]))];return{uid:n.uid,dom:wE(Kn(n,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:T(T({},i),Qg(n.typeaheadBehaviours,a)),eventOrder:n.eventOrder}},gV=y([Be("lazySink"),ye("fetch"),He("minChars",5),He("responseTime",1e3),Hs("onOpen"),He("getHotspot",R.some),He("getAnchorOverrides",y({})),He("layouts",R.none()),He("eventOrder",{}),Ye("model",{},[He("getDisplayText",(function(n){return void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.value})),He("selectsOver",!0),He("populateFromBrowse",!0)]),Hs("onSetValue"),zs("onExecute"),Hs("onItemExecute"),He("inputClasses",[]),He("inputAttributes",{}),He("inputStyles",{}),He("matchWidth",!0),He("useMinWidth",!1),He("dismissOnBlur",!0),Vs(["openClass"]),Be("initialData"),Jg("typeaheadBehaviours",[My,Kg,uV,ly,$y,ZE]),qe("previewing",(function(){return Ke(!0)}))].concat(bE()).concat(gD())),pV=y([Dp({schema:[Rs()],name:"menu",overrides:function(n){return{fakeFocus:!0,onHighlight:function(t,e){n.previewing.get()?t.getSystem().getByUid(n.uid).each((function(o){lV(n.model,o,e).fold((function(){return zv.dehighlight(t,e)}),(function(n){return n()}))})):t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&aV(n.model,t,e)})),n.previewing.set(!1)},onExecute:function(t,e){return t.getSystem().getByUid(n.uid).toOptional().map((function(n){return li(n,dV(),{item:e}),!0}))},onHover:function(t,e){n.previewing.set(!1),t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&aV(n.model,t,e)}))}}}})]),vV=cv({name:"Typeahead",configFields:gV(),partFields:pV(),factory:mV}),hV=function(n){var t=function(){return hV(n.toCached())},e=function(t){return hV(n.bind((function(n){return n.fold((function(n){return RE.pure(hn.error(n))}),(function(n){return t(n)}))})))},o=function(t){return hV(n.map((function(n){return n.bind(t)})))},r=function(t){return hV(n.map((function(n){return n.map(t)})))},i=function(t){return hV(n.map((function(n){return n.mapError(t)})))},u=function(t,e){return n.map((function(n){return n.fold(t,e)}))},a=function(t,e){return hV(RE.nu((function(o){var r=!1,i=setTimeout((function(){r=!0,o(hn.error(e()))}),t);n.get((function(n){r||(clearTimeout(i),o(n))}))})))};return T(T({},n),{toCached:t,bindFuture:e,bindResult:o,mapResult:r,mapError:i,foldResult:u,withTimeout:a})},bV=function(n){return hV(RE.nu(n))},yV=function(n){return hV(RE.pure(hn.value(n)))},xV=function(n){return hV(RE.pure(hn.error(n)))},wV=function(n){return hV(RE.pure(n))},SV=function(n){return hV(n.map(hn.value))},kV=function(n){return bV((function(t){n.then((function(n){t(hn.value(n))}),(function(n){t(hn.error(n))}))}))},CV={nu:bV,wrap:hV,pure:yV,value:yV,error:xV,fromResult:wV,fromFuture:SV,fromPromise:kV},OV={type:"separator"},_V=function(n){return{type:"menuitem",value:n.url,text:n.title,meta:{attach:n.attach},onAction:p}},TV=function(n,t){return{type:"menuitem",value:t,text:n,meta:{attach:void 0},onAction:p}},EV=function(n){return G(n,_V)},DV=function(n,t){return K(t,(function(t){return t.type===n}))},BV=function(n,t){return EV(DV(n,t))},AV=function(n){return BV("header",n.targets)},MV=function(n){return BV("anchor",n.targets)},FV=function(n){return R.from(n.anchorTop).map((function(n){return TV("<top>",n)})).toArray()},IV=function(n){return R.from(n.anchorBottom).map((function(n){return TV("<bottom>",n)})).toArray()},RV=function(n){return G(n,(function(n){return TV(n,n)}))},VV=function(n){return $(n,(function(n,t){var e=0===n.length||0===t.length;return e?n.concat(t):n.concat(OV,t)}),[])},PV=function(n,t){var e=n.toLowerCase();return K(t,(function(n){var t=void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.text;return po(t.toLowerCase(),e)||po(n.value.toLowerCase(),e)}))},HV=function(n,t,e){var o=Kg.getValue(t),r=void 0!==o.meta.text?o.meta.text:o.value,i=e.getLinkInformation();return i.fold((function(){return[]}),(function(t){var o=PV(r,RV(e.getHistory(n)));return"file"===n?VV([o,PV(r,AV(t)),PV(r,tn([FV(t),MV(t),IV(t)]))]):o}))},zV=Pu("aria-invalid"),NV=function(n,t,e){var o,r=t.shared.providers,i=function(t){var o=Kg.getValue(t);e.addToHistory(o.value,n.filetype)},u=JT.parts.field({factory:vV,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":zV,type:"url"},minChars:0,responseTime:0,fetch:function(o){var r=HV(n.filetype,o,e),i=MI(r,cS.BUBBLE_TO_SANDBOX,t,!1);return RE.pure(i)},getHotspot:function(n){return m.getOpt(n)},onSetValue:function(n,t){n.hasConfigured(YE)&&YE.run(n).get(p)},typeaheadBehaviours:Lf(tn([e.getValidationHandler().map((function(t){return YE.config({getRoot:function(n){return Gi(n.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(n,t){s.getOpt(n).each((function(n){ku(n.element,"title",r.translate(t))}))}},validator:{validate:function(e){var o=Kg.getValue(e);return CV.nu((function(e){t({type:n.filetype,url:o.value},(function(n){if("invalid"===n.status){var t=hn.error(n.message);e(t)}else{var o=hn.value(n.message);e(o)}}))}))},validateOnLoad:!1}})})).toArray(),[Jk.config({disabled:function(){return n.disabled||r.isDisabled()}}),nE.config({}),ky("urlinput-events",tn(["file"===n.filetype?[xi(Mr(),(function(t){li(t,cE,{name:n.name})}))]:[],[xi(Fr(),(function(t){li(t,cE,{name:n.name}),i(t)})),xi(Lr(),(function(t){li(t,cE,{name:n.name}),i(t)}))]]))]])),eventOrder:(o={},o[Mr()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(n){return n.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:VS(!1,1,"normal")},onExecute:function(n,t,e){li(t,dE,{})},onItemExecute:function(t,e,o,r){i(t),li(t,cE,{name:n.name})}}),a=n.label.map((function(n){return aE(n,r)})),c=function(n,t,e,o){return void 0===e&&(e=n),void 0===o&&(o=n),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+n],innerHtml:nw(e,r.icons),attributes:T({title:r.translate(o),"aria-live":"polite"},t.fold((function(){return{}}),(function(n){return{id:n}})))}}},s=Qx(c("invalid",R.some(zV),"warning")),f=Qx({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[s.asSpec()]}),l=e.getUrlPicker(n.filetype),d=Pu("browser.url.event"),m=Qx({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,f.asSpec()],behaviours:Lf([Jk.config({disabled:function(){return n.disabled||r.isDisabled()}})])}),g=Qx(NI({name:n.name,icon:R.some("browse"),text:n.label.getOr(""),disabled:n.disabled,primary:!1,borderless:!0},(function(n){return fi(n,d)}),r,[],["tox-browse-url"])),v=function(){return{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:tn([[m.asSpec()],l.map((function(){return g.asSpec()})).toArray()])}},h=function(t){yv.getCurrent(t).each((function(e){var o=Kg.getValue(e),r=T({fieldname:n.name},o);l.each((function(o){o(r).get((function(o){Kg.setValue(e,o),li(t,cE,{name:n.name})}))}))}))};return JT.sketch({dom:iE(),components:a.toArray().concat([v()]),fieldBehaviours:Lf([Jk.config({disabled:function(){return n.disabled||r.isDisabled()},onDisabled:function(n){JT.getField(n).each(Jk.disable),g.getOpt(n).each(Jk.disable)},onEnabled:function(n){JT.getField(n).each(Jk.enable),g.getOpt(n).each(Jk.enable)}}),WC(),ky("url-input-events",[xi(d,h)])])})},LV=function(n,t){return WT.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+n.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[$x.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:nw(n.icon,t.icons),attributes:{title:t.translate(n.iconTooltip)}},action:function(t){li(t,lE,{name:"alert-banner",value:n.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(n.text)}}]})},jV=function(n,t){var e=Kg.config({store:{mode:"manual",getValue:function(n){var t=n.element.dom;return t.checked},setValue:function(n,t){var e=n.element.dom;e.checked=t}}}),o=function(n){return n.element.dom.click(),R.some(!0)},r=JT.parts.field({factory:{sketch:x},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Lf([DM.self(),Jk.config({disabled:function(){return n.disabled||t.isDisabled()}}),nE.config({}),My.config({}),e,ly.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),ky("checkbox-events",[xi(Fr(),(function(t,e){li(t,cE,{name:n.name})}))])])}),i=JT.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:t.translate(n.label)},behaviours:Lf([SD.config({})])}),u=function(n){var e="checked"===n?"selected":"unselected";return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+n],innerHtml:nw(e,t.icons)}}},a=Qx({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[u("checked"),u("unchecked")]});return JT.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,a.asSpec(),i],fieldBehaviours:Lf([Jk.config({disabled:function(){return n.disabled||t.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(n){JT.getField(n).each(Jk.disable)},onEnabled:function(n){JT.getField(n).each(Jk.enable)}}),WC()])})},UV=function(n){return"presentation"===n.presets?WT.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html}}):WT.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html,attributes:{role:"document"}},containerBehaviours:Lf([nE.config({}),My.config({})])})},WV=function(n){return function(t,e,o){return Nn(e,"name").fold((function(){return n(e,o)}),(function(r){return t.field(r,n(e,o))}))}},GV=function(n){return function(t,e,o){var r=Kn(e,{source:"dynamic"});return WV(n)(t,r,o)}},XV={bar:WV((function(n,t){return XT(n,t.shared)})),collection:WV((function(n,t){return hE(n,t.shared.providers)})),alertbanner:WV((function(n,t){return LV(n,t.shared.providers)})),input:WV((function(n,t){return $R(n,t.shared.providers)})),textarea:WV((function(n,t){return QR(n,t.shared.providers)})),label:WV((function(n,t){return zR(n,t.shared)})),iframe:GV((function(n,t){return iF(n,t.shared.providers)})),button:WV((function(n,t){return GI(n,t.shared.providers)})),checkbox:WV((function(n,t){return jV(n,t.shared.providers)})),colorinput:WV((function(n,t){return TD(n,t.shared,t.colorinput)})),colorpicker:WV(FM),dropzone:WV((function(n,t){return qM(n,t.shared.providers)})),grid:WV((function(n,t){return KM(n,t.shared)})),listbox:WV((function(n,t){return WR(n,t)})),selectbox:WV((function(n,t){return qR(n,t.shared.providers)})),sizeinput:WV((function(n,t){return rR(n,t.shared.providers)})),urlinput:WV((function(n,t){return NV(n,t,t.urlinput)})),customeditor:WV(VM),htmlpanel:WV(UV),imagetools:WV((function(n,t){return HR(n,t.shared.providers)})),table:WV((function(n,t){return KR(n,t.shared.providers)})),panel:WV((function(n,t){return GR(n,t)}))},YV={field:function(n,t){return t}},qV=function(n,t,e){var o=Kn(e,{shared:{interpreter:function(t){return KV(n,t,o)}}});return KV(n,t,o)},KV=function(n,t,e){return Nn(XV,t.type).fold((function(){return t}),(function(o){return o(n,t,e)}))},JV=function(n,t){var e=YV;return KV(e,n,t)},$V={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},QV=function(n,t,e){var o=Rl(-12,12,$V),r={maxHeightFunction:Bl()},i=function(){return{anchor:"node",root:eu(n()),node:R.from(n()),bubble:o,layouts:{onRtl:function(){return[Xx]},onLtr:function(){return[Gx]}},overrides:r}},u=function(){return{anchor:"hotspot",hotspot:t(),bubble:o,layouts:{onRtl:function(){return[vf]},onLtr:function(){return[hf]}},overrides:r}};return function(){return e()?i():u()}},ZV=function(n,t,e){var o=function(){return{anchor:"node",root:eu(n()),node:R.from(n()),layouts:{onRtl:function(){return[Yx]},onLtr:function(){return[Yx]}}}},r=function(){return{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[wf]},onLtr:function(){return[wf]}}}};return function(){return e()?o():r()}},nP=function(n,t){return function(){return{anchor:"selection",root:t(),getSelection:function(){var t=n.selection.getRng();return R.some(Ed.range(to.fromDom(t.startContainer),t.startOffset,to.fromDom(t.endContainer),t.endOffset))}}}},tP=function(n){return function(t){return{anchor:"node",root:n(),node:t}}},eP=function(n,t,e){var o=OC(n),r=function(){return to.fromDom(n.getBody())},i=function(){return to.fromDom(n.getContentAreaContainer())},u=function(){return o||!e()};return{inlineDialog:QV(i,t,u),banner:ZV(i,t,u),cursor:nP(n,r),node:tP(r)}},oP=function(n){return function(t,e){var o=B_(n);o(t,e)}},rP=function(n){return function(){return d_(n)}},iP=function(n){return function(){return g_(n)}},uP=function(n){return function(){return S_(n)}},aP=function(n){return{colorPicker:oP(n),hasCustomColors:rP(n),getColors:iP(n),getColorCols:uP(n)}},cP=function(n){return function(){return DC(n)}},sP=function(n){return{isDraggableModal:cP(n)}},fP=function(n){var t=Ke(xC(n)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===t.get()},getDockingMode:t.get,setDockingMode:t.set}},lP=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],dP=function(n){return Ln(n,"items")},mP=function(n){return Ln(n,"block")},gP=function(n){return Ln(n,"inline")},pP=function(n){return Ln(n,"selector")},vP=function(n){return $(n,(function(n,t){if(dP(t)){var e=vP(t.items);return{customFormats:n.customFormats.concat(e.customFormats),formats:n.formats.concat([{title:t.title,items:e.formats}])}}if(gP(t)||mP(t)||pP(t)){var o=i(t.name)?t.name:t.title.toLowerCase(),r="custom-"+o;return{customFormats:n.customFormats.concat([{name:r,format:t}]),formats:n.formats.concat([{title:t.title,format:r,icon:t.icon}])}}return T(T({},n),{formats:n.formats.concat(t)})}),{customFormats:[],formats:[]})},hP=function(n,t){var e=vP(t),o=function(t){X(t,(function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)}))};return n.formatter?o(e.customFormats):n.on("init",(function(){o(e.customFormats)})),e.formats},bP=function(n){return aC(n).map((function(t){var e=hP(n,t);return cC(n)?lP.concat(e):e})).getOr(lP)},yP=function(n,t,e){var o={type:"formatter",isSelected:t(n.format),getStylePreview:e(n.format)};return Kn(n,o)},xP=function(n,t,e,o){var r=function(n){return yP(n,e,o)},u=function(n){var t={type:"submenu"};return Kn(n,t)},a=function(t){var r=i(t.name)?t.name:Pu(t.title),u="custom-"+r,a={type:"formatter",format:u,isSelected:e(u),getStylePreview:o(u)},c=Kn(t,a);return n.formatter.register(r,c),c},c=function(n){return G(n,(function(n){var t=Dn(n);if(jn(n,"items")){var e=c(n.items);return Kn(u(n),{getStyleItems:function(){return e}})}return jn(n,"format")?r(n):1===t.length&&L(t,"title")?Kn(n,{type:"separator"}):a(n)}))};return c(t)},wP=function(n){var t=function(t){return function(){return n.formatter.match(t)}},e=function(t){return function(){var e=n.formatter.get(t);return void 0!==e?R.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):R.none()}},o=function(n){var t=n.items;return void 0!==t&&t.length>0?en(t,o):[n.format]},r=Ke([]),i=Ke([]),u=Ke([]),a=Ke([]),c=Ke(!1);n.on("PreInit",(function(u){var a=bP(n),c=xP(n,a,t,e);r.set(c),i.set(en(c,o))})),n.on("addStyleModifications",(function(r){var i=xP(n,r.items,t,e);u.set(i),c.set(r.replace),a.set(en(i,o))}));var s=function(){var n=c.get()?[]:r.get(),t=u.get();return n.concat(t)},f=function(){var n=c.get()?[]:i.get(),t=a.get();return n.concat(t)};return{getData:s,getFlattenedKeys:f}},SP=function(n){return l(n)&&1===n.nodeType},kP=PM.trim,CP=function(n){return function(t){if(SP(t)){if(t.contentEditable===n)return!0;if(t.getAttribute("data-mce-contenteditable")===n)return!0}return!1}},OP=CP("true"),_P=CP("false"),TP=function(n,t,e,o,r){return{type:n,title:t,url:e,level:o,attach:r}},EP=function(n){while(n=n.parentNode){var t=n.contentEditable;if(t&&"inherit"!==t)return OP(n)}return!1},DP=function(n,t){return G($d(to.fromDom(t),n),(function(n){return n.dom}))},BP=function(n){return n.innerText||n.textContent},AP=function(n){return n.id?n.id:Pu("h")},MP=function(n){return n&&"A"===n.nodeName&&void 0!==(n.id||n.name)},FP=function(n){return MP(n)&&RP(n)},IP=function(n){return n&&/^(H[1-6])$/.test(n.nodeName)},RP=function(n){return EP(n)&&!_P(n)},VP=function(n){return IP(n)&&RP(n)},PP=function(n){return IP(n)?parseInt(n.nodeName.substr(1),10):0},HP=function(n){var t=AP(n),e=function(){n.id=t};return TP("header",BP(n),"#"+t,PP(n),e)},zP=function(n){var t=n.id||n.name,e=BP(n);return TP("anchor",e||"#"+t,"#"+t,0,p)},NP=function(n){return G(K(n,VP),HP)},LP=function(n){return G(K(n,FP),zP)},jP=function(n){var t=DP("h1,h2,h3,h4,h5,h6,a:not([href])",n);return t},UP=function(n){return kP(n.title).length>0},WP=function(n){var t=jP(n);return K(NP(t).concat(LP(t)),UP)},GP={find:WP},XP="tinymce-url-history",YP=5,qP=function(n){return i(n)&&/^https?/.test(n)},KP=function(n){return a(n)&&n.length<=YP&&on(n,qP)},JP=function(n){return u(n)&&Hn(n,(function(n){return!KP(n)})).isNone()},$P=function(){var n,t=o_.getItem(XP);if(null===t)return{};try{n=JSON.parse(t)}catch(e){if(e instanceof SyntaxError)return{};throw e}return JP(n)?n:{}},QP=function(n){if(!JP(n))throw new Error("Bad format for history:\n"+JSON.stringify(n));o_.setItem(XP,JSON.stringify(n))},ZP=function(n){var t=$P();return Object.prototype.hasOwnProperty.call(t,n)?t[n]:[]},nH=function(n,t){if(qP(n)){var e=$P(),o=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],r=K(o,(function(t){return t!==n}));e[t]=[n].concat(r).slice(0,YP),QP(e)}},tH=function(n){return!!n},eH=function(n){return Mn(PM.makeMap(n,/[, ]/),tH)},oH=function(n){return R.from(FC(n)).filter(d)},rH=function(n){var t=R.some(IC(n)).filter(tH),e=R.some(RC(n)).filter(tH),o=t.or(e).map(eH);return oH(n).fold(C,(function(n){return o.fold(O,(function(n){return Dn(n).length>0&&n}))}))},iH=function(n,t){var e=rH(n);return c(e)?e?oH(n):R.none():e[t]?oH(n):R.none()},uH=function(n,t){return iH(n,t).map((function(e){return function(o){return RE.nu((function(r){var a=function(n,t){if(!i(n))throw new Error("Expected value to be string");if(void 0!==t&&!u(t))throw new Error("Expected meta to be a object");var e={value:n,meta:t};r(e)},c=T({filetype:t,fieldname:o.fieldname},R.from(o.meta).getOr({}));e.call(n,a,o.value,c)}))}}))},aH=function(n){return R.from(n).filter(i).getOrUndefined()},cH=function(n){return VC(n)?R.none():R.some({targets:GP.find(n.getBody()),anchorTop:aH(PC(n)),anchorBottom:aH(HC(n))})},sH=function(n){return R.from(zC(n))},fH=function(n){return{getHistory:ZP,addToHistory:nH,getLinkInformation:function(){return cH(n)},getValidationHandler:function(){return sH(n)},getUrlPicker:function(t){return uH(n,t)}}},lH=function(n,t,e){var o=Ke(!1),r=fP(t),i={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:Ak.translate,isDisabled:function(){return t.mode.isReadOnly()||t.ui.isDisabled()},getSetting:t.getParam.bind(t)},interpreter:function(n){return JV(n,i)},anchors:eP(t,e,r.isPositionedAtTop),header:r,getSink:function(){return hn.value(n)}},urlinput:fH(t),styleselect:wP(t),colorinput:aP(t),dialog:sP(t),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(n){return o.set(n)}};return i},dH=y((function(n,t){Vc(n,Math.floor(t))})),mH="contexttoolbar-show",gH="contexttoolbar-hide",pH=y([ye("dom"),He("shell",!0),Jg("toolbarBehaviours",[wy])]),vH=function(){return{behaviours:Lf([wy.config({})])}},hH=y([Bp({name:"groups",overrides:vH})]),bH=function(n,t,e,o){var r=function(n,t){i(n).fold((function(){throw new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){wy.set(n,t)}))},i=function(t){return n.shell?R.some(t):Up(t,n,"groups")},u=n.shell?{behaviours:[wy.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:u.components,behaviours:Qg(n.toolbarBehaviours,u.behaviours),apis:{setGroups:r},domModification:{attributes:{role:"group"}}}},yH=cv({name:"Toolbar",configFields:pH(),partFields:hH(),factory:bH,apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),xH=function(n,t){var e={len:0,list:[]},o=$(n,(function(n,e){var o=t(e,n.len);return o.fold(y(n),(function(t){return{len:t.finish,list:n.list.concat([t])}}))}),e);return o.list},wH=function(n,t,e){return{within:n,extra:t,withinWidth:e}},SH=function(n,t,e){var o=xH(n,(function(n,t){var o=e(n);return R.some({element:n,start:t,finish:t+o,width:o})})),r=K(o,(function(n){return n.finish<=t})),i=J(r,(function(n,t){return n+t.width}),0),u=o.slice(r.length);return{within:r,extra:u,withinWidth:i}},kH=function(n){return G(n,(function(n){return n.element}))},CH=function(n,t,e){var o=kH(n.concat(t));return wH(o,[],e)},OH=function(n,t,e,o){var r=kH(n).concat([e]);return wH(r,kH(t),o)},_H=function(n,t,e){return wH(kH(n),[],e)},TH=function(n,t,e){var o=SH(t,n,e);return 0===o.extra.length?R.some(o):R.none()},EH=function(n,t,e,o){var r=TH(n,t,e).getOrThunk((function(){return SH(t,n-e(o),e)})),i=r.within,u=r.extra,a=r.withinWidth;return 1===u.length&&u[0].width<=e(o)?CH(i,u,a):u.length>=1?OH(i,u,o,a):_H(i,u,a)},DH=function(n,t){var e=G(t,(function(n){return xc(n)}));yH.setGroups(n,e)},BH=function(n){return mn(n,(function(n){return tl(n.element).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}))},AH=function(n,t,e){var o=Wp(n,t,"primary"),r=ZE.getCoupled(n,"overflowGroup");Ka(o.element,"visibility","hidden");var i=t.builtGroups.get().concat([r]),u=BH(i);e([]),DH(o,i);var a=Ic(o.element),c=EH(a,t.builtGroups.get(),(function(n){return Ic(n.element)}),r);0===c.extra.length?(wy.remove(o,r),e([])):(DH(o,c.within),e(c.extra)),oc(o.element,"visibility"),rc(o.element),u.each(My.focus)},MH=y([Jg("splitToolbarBehaviours",[ZE]),qe("builtGroups",(function(){return Ke([])}))]),FH=y([Vs(["overflowToggledClass"]),Ie("getOverflowBounds"),ye("lazySink"),qe("overflowGroups",(function(){return Ke([])}))].concat(MH())),IH=y([Ep({factory:yH,schema:pH(),name:"primary"}),Dp({schema:pH(),name:"overflow"}),Dp({name:"overflow-button"}),Dp({name:"overflow-group"})]),RH=y([Vs(["toggledClass"]),ye("lazySink"),Oe("fetch"),Ie("getBounds"),Ve("fireDismissalEventInstead",[He("event",ei())]),Ul()]),VH=y([Dp({name:"button",overrides:function(n){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Lf([$y.config({toggleClass:n.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Dp({factory:yH,schema:pH(),name:"toolbar",overrides:function(n){return{toolbarBehaviours:Lf([ly.config({mode:"cyclic",onEscape:function(t){return Up(t,n,"button").each(My.focus),R.none()}})])}}})]),PH=function(n,t){var e=ZE.getCoupled(n,"toolbarSandbox");mg.isOpen(e)?mg.close(e):mg.open(e,t.toolbar())},HH=function(n,t,e,o){var r=e.getBounds.map((function(n){return n()})),i=e.lazySink(n).getOrDie();Fm.positionWithinBounds(i,{anchor:"hotspot",hotspot:n,layouts:o,overrides:{maxWidthFunction:dH()}},t,r)},zH=function(n,t,e,o,r){yH.setGroups(t,r),HH(n,t,e,o),$y.on(n)},NH=function(n,t,e){var o=hs(),r=function(r,i){e.fetch().get((function(r){zH(n,i,e,t.layouts,r),o.link(n.element),ly.focusIn(i)}))},i=function(){$y.off(n),My.focus(n),o.unlink(n.element)};return{dom:{tag:"div",attributes:{id:o.id}},behaviours:Lf([ly.config({mode:"special",onEscape:function(n){return mg.close(n),R.some(!0)}}),mg.config({onOpen:r,onClose:i,isPartOf:function(t,e,o){return ys(e,o)||ys(n,o)},getAttachPoint:function(){return e.lazySink(n).getOrDie()}}),Yf.config({channels:T(T({},bg(T({isExtraPart:C},e.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),xg({doReposition:function(){mg.getState(ZE.getCoupled(n,"toolbarSandbox")).each((function(o){HH(n,o,e,t.layouts)}))}}))})])}},LH=function(n,t,e,o){return T(T({},$x.sketch(T(T({},o.button()),{action:function(n){PH(n,o)},buttonBehaviours:Zg.augment({dump:o.button().buttonBehaviours},[ZE.config({others:{toolbarSandbox:function(t){return NH(t,e,n)}}})])}))),{apis:{setGroups:function(t,o){mg.getState(ZE.getCoupled(t,"toolbarSandbox")).each((function(r){zH(t,r,n,e.layouts,o)}))},reposition:function(t){mg.getState(ZE.getCoupled(t,"toolbarSandbox")).each((function(o){HH(t,o,n,e.layouts)}))},toggle:function(n){PH(n,o)},getToolbar:function(n){return mg.getState(ZE.getCoupled(n,"toolbarSandbox"))},isOpen:function(n){return mg.isOpen(ZE.getCoupled(n,"toolbarSandbox"))}}})},jH=cv({name:"FloatingToolbarButton",factory:LH,configFields:RH(),partFields:VH(),apis:{setGroups:function(n,t,e){n.setGroups(t,e)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},getToolbar:function(n,t){return n.getToolbar(t)},isOpen:function(n,t){return n.isOpen(t)}}}),UH=y([ye("items"),Vs(["itemSelector"]),Jg("tgroupBehaviours",[ly])]),WH=y([Ap({name:"items",unit:"item"})]),GH=function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.tgroupBehaviours,[ly.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}},XH=cv({name:"ToolbarGroup",configFields:UH(),partFields:WH(),factory:GH}),YH=function(n){return G(n,(function(n){return xc(n)}))},qH=function(n,t,e){AH(n,e,(function(o){e.overflowGroups.set(o),t.getOpt(n).each((function(n){jH.setGroups(n,YH(o))}))}))},KH=function(n,t,e,o){var r=Qx(jH.sketch({fetch:function(){return RE.nu((function(t){t(YH(n.overflowGroups.get()))}))},layouts:{onLtr:function(){return[hf,vf]},onRtl:function(){return[vf,hf]},onBottomLtr:function(){return[yf,bf]},onBottomRtl:function(){return[bf,yf]}},getBounds:e.getOverflowBounds,lazySink:n.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:n.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.splitToolbarBehaviours,[ZE.config({others:{overflowGroup:function(){return XH.sketch(T(T({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(t,e){n.builtGroups.set(G(e,t.getSystem().build)),qH(t,r,n)},refresh:function(t){return qH(t,r,n)},toggle:function(n){r.getOpt(n).each((function(n){jH.toggle(n)}))},isOpen:function(n){return r.getOpt(n).map(jH.isOpen).getOr(!1)},reposition:function(n){r.getOpt(n).each((function(n){jH.reposition(n)}))},getOverflow:function(n){return r.getOpt(n).bind(jH.getToolbar)}},domModification:{attributes:{role:"group"}}}},JH=cv({name:"SplitFloatingToolbar",configFields:FH(),partFields:IH(),factory:KH,apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},isOpen:function(n,t){return n.isOpen(t)},getOverflow:function(n,t){return n.getOverflow(t)}}}),$H=function(n,t){return t.getAnimationRoot.fold((function(){return n.element}),(function(t){return t(n)}))},QH=function(n){return n.dimension.property},ZH=function(n,t){return n.dimension.getDimension(t)},nz=function(n,t){var e=$H(n,t);ja(e,[t.shrinkingClass,t.growingClass])},tz=function(n,t){za(n.element,t.openClass),Pa(n.element,t.closedClass),Ka(n.element,QH(t),"0px"),rc(n.element)},ez=function(n,t){za(n.element,t.closedClass),Pa(n.element,t.openClass),oc(n.element,QH(t))},oz=function(n,t,e,o){e.setCollapsed(),Ka(n.element,QH(t),ZH(t,n.element)),rc(n.element),nz(n,t),tz(n,t),t.onStartShrink(n),t.onShrunk(n)},rz=function(n,t,e,o){var r=o.getOrThunk((function(){return ZH(t,n.element)}));e.setCollapsed(),Ka(n.element,QH(t),r),rc(n.element);var i=$H(n,t);za(i,t.growingClass),Pa(i,t.shrinkingClass),tz(n,t),t.onStartShrink(n)},iz=function(n,t,e){var o=ZH(t,n.element),r="0px"===o?oz:rz;r(n,t,e,R.some(o))},uz=function(n,t,e){var o=$H(n,t),r=Na(o,t.shrinkingClass),i=ZH(t,n.element);ez(n,t);var u=ZH(t,n.element),a=function(){Ka(n.element,QH(t),i),rc(n.element)},c=function(){tz(n,t)},s=r?a:c;s(),za(o,t.shrinkingClass),Pa(o,t.growingClass),ez(n,t),Ka(n.element,QH(t),u),e.setExpanded(),t.onStartGrow(n)},az=function(n,t,e){if(e.isExpanded()){oc(n.element,QH(t));var o=ZH(t,n.element);Ka(n.element,QH(t),o)}},cz=function(n,t,e){e.isExpanded()||uz(n,t,e)},sz=function(n,t,e){e.isExpanded()&&iz(n,t,e)},fz=function(n,t,e){e.isExpanded()&&oz(n,t,e,R.none())},lz=function(n,t,e){return e.isExpanded()},dz=function(n,t,e){return e.isCollapsed()},mz=function(n,t,e){var o=$H(n,t);return!0===Na(o,t.growingClass)},gz=function(n,t,e){var o=$H(n,t);return!0===Na(o,t.shrinkingClass)},pz=function(n,t,e){return mz(n,t)||gz(n,t)},vz=function(n,t,e){var o=e.isExpanded()?iz:uz;o(n,t,e)},hz=Object.freeze({__proto__:null,refresh:az,grow:cz,shrink:sz,immediateShrink:fz,hasGrown:lz,hasShrunk:dz,isGrowing:mz,isShrinking:gz,isTransitioning:pz,toggleGrow:vz,disableTransitions:nz}),bz=function(n,t,e){var o=t.expanded;return sa(o?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:ft(t.dimension.property,"0px")})},yz=function(n,t){return vi([Di(Rr(),(function(e,o){var r=o.event.raw;if(r.propertyName===n.dimension.property){nz(e,n),t.isExpanded()&&oc(e.element,n.dimension.property);var i=t.isExpanded()?n.onGrown:n.onShrunk;i(e)}}))])},xz=Object.freeze({__proto__:null,exhibit:bz,events:yz}),wz=[ye("closedClass"),ye("openClass"),ye("shrinkingClass"),ye("growingClass"),Be("getAnimationRoot"),Hs("onShrunk"),Hs("onStartShrink"),Hs("onGrown"),Hs("onStartGrow"),He("expanded",!1),xe("dimension",ce("property",{width:[js("property","width"),js("getDimension",(function(n){return Ic(n)+"px"}))],height:[js("property","height"),js("getDimension",(function(n){return kc(n)+"px"}))]}))],Sz=function(n){var t=Ke(n.expanded),e=function(){return"expanded: "+t.get()};return ra({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:w(t.set,!1),setExpanded:w(t.set,!0),readState:e})},kz=Object.freeze({__proto__:null,init:Sz}),Cz=Uf({fields:wz,name:"sliding",active:xz,apis:hz,state:kz}),Oz=y([Vs(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Hs("onOpened"),Hs("onClosed")].concat(MH())),_z=y([Ep({factory:yH,schema:pH(),name:"primary"}),Ep({factory:yH,schema:pH(),name:"overflow",overrides:function(n){return{toolbarBehaviours:Lf([Cz.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){Up(t,n,"overflow-button").each((function(n){$y.off(n),My.focus(n)})),n.onClosed(t)},onGrown:function(t){ly.focusIn(t),n.onOpened(t)},onStartGrow:function(t){Up(t,n,"overflow-button").each($y.on)}}),ly.config({mode:"acyclic",onEscape:function(t){return Up(t,n,"overflow-button").each(My.focus),R.some(!0)}})])}}}),Dp({name:"overflow-button",overrides:function(n){return{buttonBehaviours:Lf([$y.config({toggleClass:n.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Dp({name:"overflow-group"})]),Tz=function(n,t){return Up(n,t,"overflow").map(Cz.hasGrown).getOr(!1)},Ez=function(n,t){Up(n,t,"overflow-button").bind((function(){return Up(n,t,"overflow")})).each((function(e){Dz(n,t),Cz.toggleGrow(e)}))},Dz=function(n,t){Up(n,t,"overflow").each((function(e){AH(n,t,(function(n){var t=G(n,(function(n){return xc(n)}));yH.setGroups(e,t)})),Up(n,t,"overflow-button").each((function(n){Cz.hasGrown(e)&&$y.on(n)})),Cz.refresh(e)}))},Bz=function(n,t,e,o){var r="alloy.toolbar.toggle",i=function(t,e){var o=G(e,t.getSystem().build);n.builtGroups.set(o)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Qg(n.splitToolbarBehaviours,[ZE.config({others:{overflowGroup:function(n){return XH.sketch(T(T({},o["overflow-group"]()),{items:[$x.sketch(T(T({},o["overflow-button"]()),{action:function(t){fi(n,r)}}))]}))}}}),ky("toolbar-toggle-events",[xi(r,(function(t){Ez(t,n)}))])]),apis:{setGroups:function(t,e){i(t,e),Dz(t,n)},refresh:function(t){return Dz(t,n)},toggle:function(t){return Ez(t,n)},isOpen:function(t){return Tz(t,n)}},domModification:{attributes:{role:"group"}}}},Az=cv({name:"SplitSlidingToolbar",configFields:Oz(),partFields:_z(),factory:Bz,apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},toggle:function(n,t){n.toggle(t)},isOpen:function(n,t){return n.isOpen(t)}}}),Mz=y(Pu("toolbar-height-change")),Fz=function(n){var t=n.title.fold((function(){return{}}),(function(n){return{attributes:{title:n}}}));return{dom:T({tag:"div",classes:["tox-toolbar__group"]},t),components:[XH.parts.items({})],items:n.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Lf([nE.config({}),My.config({})])}},Iz=function(n){return XH.sketch(Fz(n))},Rz=function(n,t){var e=Bi((function(t){var e=G(n.initGroups,Iz);yH.setGroups(t,e)}));return Lf([KC.toolbarButton(n.providers.isDisabled),WC(),ly.config({mode:t,onEscape:n.onEscape,selector:".tox-toolbar__group"}),ky("toolbar-events",[e])])},Vz=function(n){var t=n.cyclicKeying?"cyclic":"acyclic";return{uid:n.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":Fz({title:R.none(),items:[]}),"overflow-button":PI({name:"more",icon:R.some("more-drawer"),disabled:!1,tooltip:R.some("More..."),primary:!1,borderless:!1},R.none(),n.providers)},splitToolbarBehaviours:Rz(n,t)}},Pz=function(n){var t=Vz(n),e=4,o=JH.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return JH.sketch(T(T({},t),{lazySink:n.getSink,getOverflowBounds:function(){var t=n.moreDrawerData.lazyHeader().element,o=is(t),r=Ui(t),i=is(r),u=Math.max(r.dom.scrollHeight,i.height);return os(o.x+e,i.y,o.width-2*e,u)},parts:T(T({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n.attributes}}}),components:[o],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},Hz=function(n){var t=Az.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=Az.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=Vz(n);return Az.sketch(T(T({},o),{components:[t,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(n){n.getSystem().broadcastOn([Mz()],{type:"opened"})},onClosed:function(n){n.getSystem().broadcastOn([Mz()],{type:"closed"})}}))},zz=function(n){var t=n.cyclicKeying?"cyclic":"acyclic";return yH.sketch({uid:n.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(n.type===aS.scrolling?["tox-toolbar--scrolling"]:[])},components:[yH.parts.groups({})],toolbarBehaviours:Rz(n,t)})},Nz=zt([Se("type"),xe("items",Lt([$t([Se("name"),De("items",me)]),me]))].concat(Uw)),Lz=function(n){return oe("GroupToolbarButton",Nz,n)},jz=[Fe("text"),Fe("tooltip"),Fe("icon"),Oe("fetch"),We("onSetup",(function(){return p}))],Uz=zt(D([Se("type")],jz)),Wz=function(n){return oe("menubutton",Uz,n)},Gz=zt([Se("type"),Fe("tooltip"),Fe("icon"),Fe("text"),Ie("select"),Oe("fetch"),We("onSetup",(function(){return p})),je("presets","normal",["normal","color","listpreview"]),He("columns",1),Oe("onAction"),Oe("onItemAction")]),Xz=function(n){return oe("SplitButton",Gz,n)},Yz=function(n,t){var e=function(e,o){n.updateState.each((function(n){var r=n(e,o);t.set(r)})),n.renderComponents.each((function(n){var r=n(o,t.get()),i=G(r,e.getSystem().build);Hm(e,i)}))};return vi([xi(jr(),(function(t,o){var r=o;if(!r.universal){var i=n.channel;L(r.channels,i)&&e(t,r.data)}})),Bi((function(t,o){n.initialData.each((function(n){e(t,n)}))}))])},qz=Object.freeze({__proto__:null,events:Yz}),Kz=function(n,t,e){return e},Jz=Object.freeze({__proto__:null,getState:Kz}),$z=[ye("channel"),Be("renderComponents"),Be("updateState"),Be("initialData")],Qz=function(){var n=Ke(R.none()),t=function(t){return n.set(t)},e=function(){return n.set(R.none())},o=function(){return n.get()},r=function(){return n.get().fold((function(){return"none"}),(function(n){return n}))};return{readState:r,get:o,set:t,clear:e}},Zz=Object.freeze({__proto__:null,init:Qz}),nN=Uf({fields:$z,name:"reflecting",active:qz,apis:Jz,state:Zz}),tN=y([ye("toggleClass"),ye("fetch"),Ns("onExecute"),He("getHotspot",R.some),He("getAnchorOverrides",y({})),Ul(),Ns("onItemExecute"),Be("lazySink"),ye("dom"),Hs("onOpen"),Jg("splitDropdownBehaviours",[ZE,ly,My]),He("matchWidth",!1),He("useMinWidth",!1),He("eventOrder",{}),Be("role")].concat(gD())),eN=Ep({factory:$x,schema:[ye("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:Lf([My.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(di)},buttonBehaviours:Lf([$y.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),oN=Ep({factory:$x,schema:[ye("dom")],name:"button",defaults:function(){return{buttonBehaviours:Lf([My.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each((function(e){n.onExecute(e,t)}))}}}}),rN=y([eN,oN,Bp({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[ye("text")],name:"aria-descriptor"}),Dp({schema:[Rs()],name:"menu",defaults:function(n){return{onExecute:function(t,e){t.getSystem().getByUid(n.uid).each((function(o){n.onItemExecute(o,t,e)}))}}}}),tD()]),iN=function(n,t,e,o){var r,i=function(n){yv.getCurrent(n).each((function(n){zv.highlightFirst(n),ly.focusIn(n)}))},u=function(t){var e=i;cD(n,(function(n){return n}),t,o,e,_E.HighlightFirst).get(p)},a=function(n){return u(n),R.some(!0)},c=function(t){var e=Wp(t,n,"button");return di(e),R.some(!0)},s=T(T({},vi([Bi((function(t,e){var o=Up(t,n,"aria-descriptor");o.each((function(n){var e=Pu("aria");ku(n.element,"id",e),ku(t.element,"aria-describedby",e)}))}))])),Zy(R.some(u))),f={repositionMenus:function(n){$y.isOn(n)&&mD(n)}};return{uid:n.uid,dom:n.dom,components:t,apis:f,eventOrder:T(T({},n.eventOrder),(r={},r[Ur()]=["disabling","toggling","alloy.base.behaviour"],r)),events:s,behaviours:Qg(n.splitDropdownBehaviours,[ZE.config({others:{sandbox:function(t){var e=Wp(t,n,"arrow"),o={onOpen:function(){$y.on(e),$y.on(t)},onClose:function(){$y.off(e),$y.off(t)}};return dD(n,t,o)}}}),ly.config({mode:"special",onSpace:c,onEnter:c,onDown:a}),My.config({}),$y.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:n.role.getOr("button"),"aria-haspopup":!0}}}},uN=cv({name:"SplitDropdown",configFields:tN(),partFields:rN(),factory:iN,apis:{repositionMenus:function(n,t){return n.repositionMenus(t)}}}),aN=function(n){return{isDisabled:function(){return Jk.isDisabled(n)},setDisabled:function(t){return Jk.set(n,t)}}},cN=function(n){return{setActive:function(t){$y.set(n,t)},isActive:function(){return $y.isOn(n)},isDisabled:function(){return Jk.isDisabled(n)},setDisabled:function(t){return Jk.set(n,t)}}},sN=function(n,t){return n.map((function(n){return{"aria-label":t.translate(n),title:t.translate(n)}})).getOr({})},fN=Pu("focus-button"),lN=["checklist","ordered-list"],dN=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],mN=function(n,t,e,o,r,i){var u,a=function(n){return Ak.isRtl()&&L(lN,n)?n+"-rtl":n},c=Ak.isRtl()&&n.exists((function(n){return L(dN,n)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:sN(e,i)},components:tO([n.map((function(n){return gI(a(n),i.icons)})),t.map((function(n){return vI(n,"tox-tbtn",i)}))]),eventOrder:(u={},u[kr()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:Lf([KC.toolbarButton(i.isDisabled),WC(),ky("common-button-display-events",[xi(kr(),(function(n,t){t.event.prevent(),fi(n,fN)}))])].concat(o.map((function(e){return nN.config({channel:e,initialData:{icon:n,text:t},renderComponents:function(n,t){return tO([n.icon.map((function(n){return gI(a(n),i.icons)})),n.text.map((function(n){return vI(n,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},gN=function(n,t,e,o){var r=t.shared;return jH.sketch({lazySink:r.getSink,fetch:function(){return RE.nu((function(t){t(G(e(n.items),Iz))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:mN(n.icon,n.text,n.tooltip,R.none(),R.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})},pN=function(n,t,e){var o=Ke(p),r=mN(n.icon,n.text,n.tooltip,R.none(),R.none(),e);return $x.sketch({dom:r.dom,components:r.components,eventOrder:yI,buttonBehaviours:Lf([ky("toolbar-button-events",[bI({onAction:n.onAction,getApi:t.getApi}),$C(t,o),QC(t,o)]),KC.toolbarButton((function(){return n.disabled||e.isDisabled()})),WC()].concat(t.toolbarButtonBehaviours))})},vN=function(n,t){return hN(n,t,[])},hN=function(n,t,e){return pN(n,{toolbarButtonBehaviours:[].concat(e.length>0?[ky("toolbarButtonWith",e)]:[]),getApi:aN,onSetup:n.onSetup},t)},bN=function(n,t){return yN(n,t,[])},yN=function(n,t,e){return Kn(pN(n,{toolbarButtonBehaviours:[wy.config({}),$y.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[ky("toolbarToggleButtonWith",e)]:[]),getApi:cN,onSetup:n.onSetup},t))},xN=function(n,t,e){return function(o){return RE.nu((function(n){return t.fetch(n)})).map((function(r){return R.from(cT(Kn(M_(Pu("menu-value"),r,(function(e){t.onItemAction(n(o),e)}),t.columns,t.presets,cS.CLOSE_ON_EXECUTE,t.select.getOr(C),e),{movement:I_(t.columns,t.presets),menuBehaviours:vk.unnamedEvents("auto"!==t.columns?[]:[Bi((function(n,e){mk(n,4,BS(t.presets)).each((function(t){var e=t.numRows,o=t.numColumns;ly.setGridSize(n,e,o)}))}))])})))}))}},wN=function(n,t){var e,o=Pu("channel-update-split-dropdown-display"),r=function(n){return{isDisabled:function(){return Jk.isDisabled(n)},setDisabled:function(t){return Jk.set(n,t)},setIconFill:function(t,e){gs(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){ku(n,"fill",e)}))},setIconStroke:function(t,e){gs(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){ku(n,"stroke",e)}))},setActive:function(t){n.getSystem().isConnected()&&(ku(n.element,"aria-pressed",t),gs(n.element,"span").each((function(e){n.getSystem().getByDom(e).each((function(n){return $y.set(n,t)}))})))},isActive:function(){return gs(n.element,"span").exists((function(t){return!!n.getSystem().isConnected()&&n.getSystem().getByDom(t).exists($y.isOn)}))}}},i=Ke(p),u={getApi:r,onSetup:n.onSetup};return uN.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:T({"aria-pressed":!1},sN(n.tooltip,t.providers))},onExecute:function(t){n.onAction(r(t))},onItemExecute:function(n,t,e){},splitDropdownBehaviours:Lf([KC.splitButton(t.providers.isDisabled),WC(),ky("split-dropdown-events",[xi(fN,My.focus),$C(u,i),QC(u,i)]),SD.config({})]),eventOrder:(e={},e[ni()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:xN(r,n,t.providers),parts:{menu:VS(!1,n.columns,n.presets)},components:[uN.parts.button(mN(n.icon,n.text,R.none(),R.some(o),R.some([$y.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),uN.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:nw("chevron-down",t.providers.icons)},buttonBehaviours:Lf([KC.splitButton(t.providers.isDisabled),WC()])}),uN.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},SN=function(n){return{hide:function(){return fi(n,Yr())},getValue:function(){return Kg.getValue(n)}}},kN=function(n,t){return xi(hI,(function(e,o){var r=n.get(e),i=SN(r);t.onAction(i,o.event.buttonApi)}))},CN=function(n,t,e){var o=t.original,r=(o.primary,E(o,["primary"])),i=re(Gw(T(T({},r),{type:"button",onAction:p})));return hN(i,e.backstage.shared.providers,[kN(n,t)])},ON=function(n,t,e){var o=t.original,r=(o.primary,E(o,["primary"])),i=re(qw(T(T({},r),{type:"togglebutton",onAction:p})));return yN(i,e.backstage.shared.providers,[kN(n,t)])},_N=function(n,t,e){var o={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===t.type?ON(n,t,o):CN(n,t,o)},TN=function(n,t,e){var o=G(t,(function(t){return Qx(_N(n,t,e))})),r=function(){return G(o,(function(n){return n.asSpec()}))},i=function(n){return mn(t,(function(t,e){return t.primary?R.from(o[e]).bind((function(t){return t.getOpt(n)})).filter(S(Jk.isDisabled)):R.none()}))};return{asSpecs:r,findPrimary:i}},EN=function(n,t){var e=n.label.fold((function(){return{}}),(function(n){return{"aria-label":n}})),o=Qx(kE.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:n.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:Lf([ly.config({mode:"special",onEnter:function(n){return r.findPrimary(n).map((function(n){return di(n),!0}))},onLeft:function(n,t){return t.cut(),R.none()},onRight:function(n,t){return t.cut(),R.none()}})])})),r=TN(o,n.commands,t);return[{title:R.none(),items:[o.asSpec()]},{title:R.none(),items:r.asSpecs()}]},DN=function(n,t,e){return zz({type:n,uid:Pu("context-toolbar"),initGroups:EN(t,e),onEscape:R.none,cyclicKeying:!0,providers:e})},BN={renderContextForm:DN,buildInitGroups:EN},AN=function(n,t){var e=Math.max(t.x,n.x),o=n.right-e,r=t.width-(e-t.x),i=Math.min(o,r);return{x:e,width:i}},MN=function(n,t,e,o){var r=to.fromDom(n.getContainer()),i=gs(r,".tox-editor-header").getOr(r),u=rs(i),a=u.y>=t.bottom,c=o&&!a;if(n.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom};if(n.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)};var s=rs(r);return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}},FN=function(n,t){var e=qc(window),o=rs(to.fromDom(n.getContentAreaContainer())),r=lC(n)||dC(n)||gC(n),i=AN(o,e),u=i.x,a=i.width;if(n.inline&&!r)return os(u,e.y,a,e.height);var c=t.header.isPositionedAtTop(),s=MN(n,o,e,c),f=s.y,l=s.bottom;return os(u,f,a,l-f)},IN=function(n,t){var e=K(t,(function(t){return t.predicate(n.dom)})),o=q(e,(function(n){return"contexttoolbar"===n.type})),r=o.pass,i=o.fail;return{contextToolbars:r,contextForms:i}},RN=function(n){if(n.length<=1)return n;var t=function(t){return j(n,(function(n){return n.position===t}))},e=function(t){return K(n,(function(n){return n.position===t}))},o=t("selection"),r=t("node");if(o||r){if(r&&o){var i=e("node"),u=G(e("selection"),(function(n){return T(T({},n),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")},VN=function(n){if(n.length<=1)return n;var t=function(t){return Z(n,(function(n){return n.position===t}))},e=t("selection").orThunk((function(){return t("node")})).orThunk((function(){return t("line")})).map((function(n){return n.position}));return e.fold((function(){return[]}),(function(t){return K(n,(function(n){return n.position===t}))}))},PN=function(n,t,e){var o=IN(n,t);if(o.contextForms.length>0)return R.some({elem:n,toolbars:[o.contextForms[0]]});var r=IN(n,e);if(r.contextForms.length>0)return R.some({elem:n,toolbars:[r.contextForms[0]]});if(o.contextToolbars.length>0||r.contextToolbars.length>0){var i=RN(o.contextToolbars.concat(r.contextToolbars));return R.some({elem:n,toolbars:i})}return R.none()},HN=function(n,t,e){return n(t)?R.none():fr(t,(function(n){var t=IN(n,e.inNodeScope),o=t.contextToolbars,r=t.contextForms,i=r.length>0?r:VN(o);return i.length>0?R.some({elem:n,toolbars:i}):R.none()}),n)},zN=function(n,t){var e=to.fromDom(t.getBody()),o=function(n){return ir(n,e)},r=function(n){return!o(n)&&!cr(e,n)},i=to.fromDom(t.selection.getNode());return r(i)?R.none():PN(i,n.inNodeScope,n.inEditorScope).orThunk((function(){return HN(o,i,n)}))},NN=function(n,t){var e={},o=[],r=[],i={},u={},a=function(n,a){var c=re(eS(a));e[n]=c,c.launch.map((function(e){i["form:"+n]=T(T({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){t(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[n]=c},c=function(n,t){rS(t).each((function(e){"editor"===t.scope?r.push(e):o.push(e),u[n]=e}))},s=Dn(n);return X(s,(function(t){var e=n[t];"contextform"===e.type?a(t,e):"contexttoolbar"===e.type&&c(t,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},LN=Pu("forward-slide"),jN=Pu("backward-slide"),UN=Pu("change-slide-event"),WN="tox-pop--resizing",GN=function(n){var t=Ke([]);return Px.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(n){t.set([]),Px.getContent(n).each((function(n){oc(n.element,"visibility")})),za(n.element,WN),oc(n.element,"width")},inlineBehaviours:Lf([ky("context-toolbar-events",[Di(Rr(),(function(n,t){za(n.element,WN),oc(n.element,"width")})),xi(UN,(function(n,t){var e=n.element;oc(e,"width");var o=Ic(e);Px.setContent(n,t.event.contents),Pa(e,WN);var r=Ic(e);Ka(e,"width",o+"px"),Px.getContent(n).each((function(n){t.event.focus.bind((function(n){return $f(n),tl(e)})).orThunk((function(){return ly.focusIn(n),nl(tu(e))}))})),Kx.setTimeout((function(){Ka(n.element,"width",r+"px")}),0)})),xi(LN,(function(n,e){Px.getContent(n).each((function(e){t.set(t.get().concat([{bar:e,focus:nl(tu(n.element))}]))})),li(n,UN,{contents:e.event.forwardContents,focus:R.none()})})),xi(jN,(function(n,e){ln(t.get()).each((function(e){t.set(t.get().slice(0,t.get().length-1)),li(n,UN,{contents:xc(e.bar),focus:e.focus})}))}))]),ly.config({mode:"special",onEscape:function(e){return ln(t.get()).fold((function(){return n.onEscape()}),(function(n){return fi(e,jN),R.some(!0)}))}})]),lazySink:function(){return hn.value(n.sink)}})},XN=function(n,t,e){var o=function(n,o,i,u){var a=t.shared.providers.translate(n.title);if("separator"===n.type)return R.some({type:"separator",text:a});if("submenu"===n.type){var c=en(n.getStyleItems(),(function(n){return r(n,o,u)}));return 0===o&&c.length<=0?R.none():R.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return en(n.getStyleItems(),(function(n){return r(n,o,u)}))}})}return R.some(T({type:"togglemenuitem",text:a,icon:n.icon,active:n.isSelected(u),disabled:i,onAction:e.onAction(n)},n.getStylePreview().fold((function(){return{}}),(function(n){return{meta:{style:n}}}))))},r=function(n,t,r){var i="formatter"===n.type&&e.isInvalid(n);return 0===t?i?[]:o(n,t,!1,r).toArray():o(n,t,i,r).toArray()},i=function(n){var t=e.getCurrentValue(),o=e.shouldHide?0:1;return en(n,(function(n){return r(n,o,t)}))},u=function(n,t){return function(e,o){var r=t(),u=i(r),a=MI(u,cS.CLOSE_ON_EXECUTE,n,!1);o(a)}};return{validateItems:i,getFetch:u}},YN=function(n,t,e){var o=e.dataset,r="basic"===o.type?function(){return G(o.data,(function(n){return yP(n,e.isSelectedFor,e.getPreviewFor)}))}:o.getData;return{items:XN(n,t,e),getStyleItems:r}},qN=function(n,t,e){var o=YN(n,t,e),r=o.items,i=o.getStyleItems,u=function(n){return{getComponent:y(n)}},a=function(t){var o=function(){var n=t.getComponent();n.getSystem().isConnected()&&e.updateText(n)};return o(),n.on("NodeChange",o),function(){n.off("NodeChange",o)}};return SI({text:e.icon.isSome()?R.none():R.some(""),icon:e.icon,tooltip:R.from(e.tooltip),role:R.none(),fetch:r.getFetch(t,i),onSetup:a,getApi:u,columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)},KN=function(n){return G(n,(function(n){var t=n,e=n,o=n.split("=");return o.length>1&&(t=o[0],e=o[1]),{title:t,format:e}}))},JN=function(n){return{type:"basic",data:n}};(function(n){n[n["SemiColon"]=0]="SemiColon",n[n["Space"]=1]="Space"})(VR||(VR={}));var $N,QN=function(n,t){return t===VR.SemiColon?n.replace(/;$/,"").split(";"):n.split(" ")},ZN=function(n,t,e,o){var r=n.getParam(t,e,"string"),i=KN(QN(r,o));return{type:"basic",data:i}},nL=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],tL=function(n){var t=function(){return Z(nL,(function(t){return n.formatter.match(t.format)}))},e=function(t){return function(){return n.formatter.match(t)}},o=function(n){return function(){return R.none()}},r=function(n){var e=t(),o=e.fold((function(){return"left"}),(function(n){return n.title.toLowerCase()}));li(n,wI,{icon:"align-"+o})},i=JN(nL),u=function(t){return function(){return Z(nL,(function(n){return n.format===t.format})).each((function(t){return n.execCommand(t.command)}))}};return{tooltip:"Align",icon:R.some("align-left"),isSelectedFor:e,getCurrentValue:R.none,getPreviewFor:o,onAction:u,updateText:r,dataset:i,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},eL=function(n,t){return qN(n,t,tL(n))},oL=function(n,t){var e=YN(n,t,tL(n));n.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},rL="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",iL=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],uL=function(n){var t=n.split(/\s*,\s*/);return G(t,(function(n){return n.replace(/^['"]+|['"]+$/g,"")}))},aL=function(n){var t=function(){var t=uL(n.toLowerCase());return on(iL,(function(n){return t.indexOf(n.toLowerCase())>-1}))};return 0===n.indexOf("-apple-system")&&t()},cL=function(n){var t=function(){var t=function(n){return n?uL(n)[0]:""},e=n.queryCommandValue("FontName"),o=a.data,r=e?e.toLowerCase():"",i=Z(o,(function(n){var e=n.format;return e.toLowerCase()===r||t(e).toLowerCase()===t(r).toLowerCase()})).orThunk((function(){return aL(r)?R.from({title:"System Font",format:r}):R.none()}));return{matchOpt:i,font:e}},e=function(n){return function(t){return t.exists((function(t){return t.format===n}))}},o=function(){var n=t().matchOpt;return n},r=function(n){return function(){return R.some({tag:"div",styles:-1===n.indexOf("dings")?{"font-family":n}:{}})}},i=function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontName",!1,t.format)}))}},u=function(n){var e=t(),o=e.matchOpt,r=e.font,i=o.fold((function(){return r}),(function(n){return n.title}));li(n,xI,{text:i})},a=ZN(n,"font_formats",rL,VR.SemiColon);return{tooltip:"Fonts",icon:R.none(),isSelectedFor:e,getCurrentValue:o,getPreviewFor:r,onAction:i,updateText:u,dataset:a,shouldHide:!1,isInvalid:C}},sL=function(n,t){return qN(n,t,cL(n))},fL=function(n,t){var e=YN(n,t,cL(n));n.ui.registry.addNestedMenuItem("fontformats",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},lL="8pt 10pt 12pt 14pt 18pt 24pt 36pt",dL={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},mL={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},gL=function(n,t){var e=Math.pow(10,t);return Math.round(n*e)/e},pL=function(n,t){return/[0-9.]+px$/.test(n)?gL(72*parseInt(n,10)/96,t||0)+"pt":Nn(mL,n).getOr(n)},vL=function(n){return Nn(dL,n).getOr("")},hL=function(n){var t=function(){var t=R.none(),e=a.data,o=n.queryCommandValue("FontSize");if(o)for(var r=function(n){var r=pL(o,n),i=vL(r);t=Z(e,(function(n){return n.format===o||n.format===r||n.format===i}))},i=3;t.isNone()&&i>=0;i--)r(i);return{matchOpt:t,size:o}},e=function(n){return function(t){return t.exists((function(t){return t.format===n}))}},o=function(){var n=t().matchOpt;return n},r=y(R.none),i=function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontSize",!1,t.format)}))}},u=function(n){var e=t(),o=e.matchOpt,r=e.size,i=o.fold((function(){return r}),(function(n){return n.title}));li(n,xI,{text:i})},a=ZN(n,"fontsize_formats",lL,VR.Space);return{tooltip:"Font sizes",icon:R.none(),isSelectedFor:e,getPreviewFor:r,getCurrentValue:o,onAction:i,updateText:u,dataset:a,shouldHide:!1,isInvalid:C}},bL=function(n,t){return qN(n,t,hL(n))},yL=function(n,t){var e=YN(n,t,hL(n));n.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},xL=function(n,t){var e=t(),o=G(e,(function(n){return n.format}));return R.from(n.formatter.closest(o)).bind((function(n){return Z(e,(function(t){return t.format===n}))})).orThunk((function(){return gv(n.formatter.match("p"),{title:"Paragraph",format:"p"})}))},wL=function(n){var t=Ke(R.none()),e=function(){return t.get().each(n)},o=function(){e(),t.set(R.none())},r=function(){return t.get().isSome()},i=function(n){e(),t.set(R.some(n))};return{clear:o,isSet:r,set:i}},SL=function(){return wL((function(n){return n.destroy()}))},kL=function(){return wL((function(n){return n.unbind()}))},CL=function(){var n=Ke(R.none()),t=function(){return n.set(R.none())},e=function(t){return n.set(R.some(t))},o=function(){return n.get().isSome()},r=function(t){return n.get().each(t)};return{clear:t,set:e,isSet:o,on:r}},OL=function(n,t){return function(e){var o=kL(),r=function(){e.setActive(n.formatter.match(t));var r=n.formatter.formatChanged(t,e.setActive);o.set(r)};return n.initialized?r():n.on("init",r),o.clear}},_L=function(n){return function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)}))}}},TL="Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",EL=function(n){var t=function(t){return function(){return n.formatter.match(t)}},e=function(t){return function(){var e=n.formatter.get(t);return R.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))})}},o=function(t){var e=xL(n,(function(){return r.data})),o=e.fold((function(){return"Paragraph"}),(function(n){return n.title}));li(t,xI,{text:o})},r=ZN(n,"block_formats",TL,VR.SemiColon);return{tooltip:"Blocks",icon:R.none(),isSelectedFor:t,getCurrentValue:R.none,getPreviewFor:e,onAction:_L(n),updateText:o,dataset:r,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},DL=function(n,t){return qN(n,t,EL(n))},BL=function(n,t){var e=YN(n,t,EL(n));n.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},AL=function(n,t){var e=function(t){return function(){return n.formatter.match(t)}},o=function(t){return function(){var e=n.formatter.get(t);return void 0!==e?R.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):R.none()}},r=function(t){var e=function(n){var t=n.items;return void 0!==t&&t.length>0?en(t,e):[{title:n.title,format:n.format}]},o=en(bP(n),e),r=xL(n,(function(){return o})),i=r.fold((function(){return"Paragraph"}),(function(n){return n.title}));li(t,xI,{text:i})};return{tooltip:"Formats",icon:R.none(),isSelectedFor:e,getCurrentValue:R.none,getPreviewFor:o,onAction:_L(n),updateText:r,shouldHide:n.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!n.formatter.canApply(t.format)},dataset:t}},ML=function(n,t){var e=T({type:"advanced"},t.styleselect);return qN(n,t,AL(n,e))},FL=function(n,t){var e=T({type:"advanced"},t.styleselect),o=YN(n,t,AL(n,e));n.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})},IL=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],RL=function(n,t){return function(e,o,r){var i=n(e).mapError((function(n){return ue(n)})).getOrDie();return t(i,o,r)}},VL={button:RL(Gw,(function(n,t){return vN(n,t.backstage.shared.providers)})),togglebutton:RL(qw,(function(n,t){return bN(n,t.backstage.shared.providers)})),menubutton:RL(Wz,(function(n,t){return II(n,"tox-tbtn",t.backstage,R.none())})),splitbutton:RL(Xz,(function(n,t){return wN(n,t.backstage.shared)})),grouptoolbarbutton:RL(Lz,(function(n,t,e){var o,r=e.ui.registry.getAll().buttons,i=function(n){return WL(e,{buttons:r,toolbar:n,allowToolbarGroups:!1},t,R.none())},u=(o={},o[Ll]=t.backstage.shared.header.isPositionedAtTop()?ws.TopToBottom:ws.BottomToTop,o);switch(vC(e)){case aS.floating:return gN(n,t.backstage,i,u);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(n,t){return ML(n,t.backstage)},fontsizeSelectButton:function(n,t){return bL(n,t.backstage)},fontSelectButton:function(n,t){return sL(n,t.backstage)},formatButton:function(n,t){return DL(n,t.backstage)},alignMenuButton:function(n,t){return eL(n,t.backstage)}},PL=function(n,t,e){return Nn(VL,n.type).fold((function(){return R.none()}),(function(o){return R.some(o(n,t,e))}))},HL={styleselect:VL.styleSelectButton,fontsizeselect:VL.fontsizeSelectButton,fontselect:VL.fontSelectButton,formatselect:VL.formatButton,align:VL.alignMenuButton},zL=function(n){var t=G(IL,(function(t){var e=K(t.items,(function(t){return Ln(n,t)||Ln(HL,t)}));return{name:t.name,items:e}}));return K(t,(function(n){return n.items.length>0}))},NL=function(n){var t=n.split("|");return G(t,(function(n){return{items:n.trim().split(" ")}}))},LL=function(n){return g(n,(function(n){return Ln(n,"name")&&Ln(n,"items")}))},jL=function(n){var t=n.toolbar,e=n.buttons;return!1===t?[]:void 0===t||!0===t?zL(e):i(t)?NL(t):LL(t)?t:[]},UL=function(n,t,e,o,r,i){return Nn(t,e.toLowerCase()).orThunk((function(){return i.bind((function(n){return mn(n,(function(n){return Nn(t,n+e.toLowerCase())}))}))})).fold((function(){return Nn(HL,e.toLowerCase()).map((function(t){return t(n,r)})).orThunk((function(){return R.none()}))}),(function(t){return"grouptoolbarbutton"!==t.type||o?PL(t,r,n):R.none()}))},WL=function(n,t,e,o){var r=jL(t),i=G(r,(function(r){var i=en(r.items,(function(r){return 0===r.trim().length?[]:UL(n,t.buttons,r,t.allowToolbarGroups,e,o).toArray()}));return{title:R.from(n.translate(r.name)),items:i}}));return K(i,(function(n){return n.items.length>0}))},GL=12,XL={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},YL={maxHeightFunction:Bl(),maxWidthFunction:dH()},qL={onLtr:function(){return[xf,wf,bf,vf,yf,hf,Yx,qx,Gx,Ux,Xx,Wx]},onRtl:function(){return[xf,wf,yf,hf,bf,vf,Yx,qx,Xx,Wx,Gx,Ux]}},KL={onLtr:function(){return[wf,vf,hf,bf,yf,xf,Yx,qx,Gx,Ux,Xx,Wx]},onRtl:function(){return[wf,hf,vf,yf,bf,xf,Yx,qx,Xx,Wx,Gx,Ux]}},JL=function(n,t){return"line"===n?{bubble:Rl(GL,0,XL),layouts:{onLtr:function(){return[Sf]},onRtl:function(){return[kf]}},overrides:YL}:{bubble:Rl(0,GL,XL),layouts:t?KL:qL,overrides:YL}},$L=function(n,t,e,o){var r=qo().deviceType.isTouch,i=yc(GN({sink:e,onEscape:function(){return n.focus(),R.some(!0)}})),u=function(){return FN(n,o.backstage.shared)},a=function(n,t,e,o){return Math.max(n,e)<=Math.min(t,o)},c=function(){var t=g.get().filter((function(n){return Wa(to.fromDom(n))})).map((function(n){return n.getBoundingClientRect()})).getOrThunk((function(){return n.selection.getRng().getBoundingClientRect()})),e=n.inline?Wc().top:is(to.fromDom(n.getBody())).y;return{y:t.top+e,bottom:t.bottom+e}},s=function(){if(r()&&o.backstage.isContextMenuOpen())return!0;var n=c(),t=u();return!a(n.y,n.bottom,t.y,t.bottom)},f=function(){m.set(R.none()),Px.hide(i)},l=function(){Px.hide(i)},d=function(){m.get().each((function(n){var t=i.element;oc(t,"display"),s()?Ka(t,"display","none"):Fm.positionWithinBounds(e,n,i,R.some(u()))}))},m=Ke(R.none()),g=Ke(R.none()),v=Ke(null),h=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:Lf([ly.config({mode:"acyclic"}),ky("pop-dialog-wrap-events",[Bi((function(t){n.shortcuts.add("ctrl+F9","focus statusbar",(function(){return ly.focusIn(t)}))})),Ai((function(t){n.shortcuts.remove("ctrl+F9")}))])])}},b=$n((function(){return NN(t,(function(n){var t=w([n]);li(i,LN,{forwardContents:h(t)})}))})),y=function(t,e){return WL(n,{buttons:t,toolbar:e.items,allowToolbarGroups:!1},o,R.some(["form:"]))},x=function(n,t){return BN.buildInitGroups(n,t)},w=function(t){var e=n.ui.registry.getAll().buttons,r=b(),i=T(T({},e),r.formNavigators),u=vC(n)===aS.scrolling?aS.scrolling:aS.default,a=tn(G(t,(function(n){return"contexttoolbar"===n.type?y(i,n):x(n,o.backstage.shared.providers)})));return zz({type:u,uid:Pu("context-toolbar"),initGroups:a,onEscape:R.none,cyclicKeying:!0,providers:o.backstage.shared.providers})};n.on(mH,(function(t){var e=b();Nn(e.lookupTable,t.toolbarKey).each((function(e){k([e],t.target===n?R.none():R.some(t)),Px.getContent(i).each(ly.focusIn)}))}));var S=function(n,t){var e="node"===n?o.backstage.shared.anchors.node(t):o.backstage.shared.anchors.cursor();return Kn(e,JL(n,r()))},k=function(n,t){if(O(),!r()||!o.backstage.isContextMenuOpen()){var e=w(n),a=t.map(to.fromDom),c=S(n[0].position,a);m.set(R.some(c)),g.set(t);var f=i.element;oc(f,"display"),Px.showWithinBounds(i,c,h(e),(function(){return R.some(u())})),s()&&Ka(f,"display","none")}},C=function(){if(n.hasFocus()){var t=b();zN(t,n).fold(f,(function(n){k(n.toolbars,R.some(n.elem.dom))}))}},O=function(){var n=v.get();null!==n&&(Kx.clearTimeout(n),v.set(null))},_=function(){O(),v.set(Kx.setEditorTimeout(n,C,0))};n.on("init",(function(){n.on(gH,l),n.on("ScrollContent ScrollWindow longpress",d),n.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){_()})),n.on("focusout",(function(t){Kx.setEditorTimeout(n,(function(){tl(e.element).isNone()&&tl(i.element).isNone()&&f()}),0)})),n.on("SwitchMode",(function(){n.mode.isReadOnly()&&f()})),n.on("AfterProgressState",(function(t){t.state?f():n.hasFocus()&&_()})),n.on("NodeChange",(function(n){tl(i.element).fold(_,p)}))}))},QL=function(n,t,e){var o=function(n,o){X([t,e],(function(t){t.broadcastEvent(n,o)}))},r=function(n,o){X([t,e],(function(t){t.broadcastOn([n],o)}))},i=function(n){return r(gg(),{target:n.target})},u=mT(to.fromDom(document),"touchstart",i),a=mT(to.fromDom(document),"touchmove",(function(n){return o(Jr(),n)})),c=mT(to.fromDom(document),"touchend",(function(n){return o($r(),n)})),s=mT(to.fromDom(document),"mousedown",i),f=mT(to.fromDom(document),"mouseup",(function(n){0===n.raw.button&&r(vg(),{target:n.target})})),l=function(n){return r(gg(),{target:to.fromDom(n.target)})},d=function(n){0===n.button&&r(vg(),{target:to.fromDom(n.target)})},m=function(n){return o(Qr(),pT(n))},g=function(n){r(pg(),{}),o(Zr(),pT(n))},p=function(){return r(pg(),{})},v=function(t){t.state&&r(gg(),{target:to.fromDom(n.getContainer())})};n.on("PostRender",(function(){n.on("click",l),n.on("tap",l),n.on("mouseup",d),n.on("ScrollWindow",m),n.on("ResizeWindow",g),n.on("ResizeEditor",p),n.on("AfterProgressState",v)})),n.on("remove",(function(){n.off("click",l),n.off("tap",l),n.off("mouseup",d),n.off("ScrollWindow",m),n.off("ResizeWindow",g),n.off("ResizeEditor",p),n.off("AfterProgressState",v),s.unbind(),u.unbind(),a.unbind(),c.unbind(),f.unbind()})),n.on("detach",(function(){Ym(t),Ym(e),t.destroy(),e.destroy()}))},ZL=$p,nj=Fp,tj=y([He("shell",!1),ye("makeItem"),He("setupItem",p),Zg.field("listBehaviours",[wy])]),ej=function(){return{behaviours:Lf([wy.config({})])}},oj=Bp({name:"items",overrides:ej}),rj=y([oj]),ij=y("CustomList"),uj=function(n,t,e,o){var r=function(t,e){u(t).fold((function(){throw new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=wy.contents(o),i=e.length,u=i-r.length,a=u>0?U(u,(function(){return n.makeItem()})):[],c=r.slice(i);X(c,(function(n){return wy.remove(o,n)})),X(a,(function(n){return wy.append(o,n)}));var s=wy.contents(o);X(s,(function(o,r){n.setupItem(t,o,e[r],r)}))}))},i=n.shell?{behaviours:[wy.config({})],components:[]}:{behaviours:[],components:t},u=function(t){return n.shell?R.some(t):Up(t,n,"items")};return{uid:n.uid,dom:n.dom,components:i.components,behaviours:Qg(n.listBehaviours,i.behaviours),apis:{setItems:r}}},aj=cv({name:ij(),configFields:tj(),partFields:rj(),factory:uj,apis:{setItems:function(n,t,e){n.setItems(t,e)}}}),cj=p,sj=C,fj=y([]),lj=Object.freeze({__proto__:null,setup:cj,isDocked:sj,getBehaviours:fj}),dj=function(n){var t=nc(n,"position").is("fixed"),e=t?R.none():Yi(n);return e.orThunk((function(){var t=to.fromTag("span");return Gi(n).bind((function(n){lu(n,t);var e=Yi(t);return vu(t),e}))}))},mj=function(n){return dj(n).map(Bc).getOrThunk((function(){return Tc(0,0)}))},gj=Wn.generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),pj=function(n,t){var e=n.element;Pa(e,t.transitionClass),za(e,t.fadeOutClass),Pa(e,t.fadeInClass),t.onShow(n)},vj=function(n,t){var e=n.element;Pa(e,t.transitionClass),za(e,t.fadeInClass),Pa(e,t.fadeOutClass),t.onHide(n)},hj=function(n,t){return n.y<t.bottom&&n.bottom>t.y},bj=function(n,t){return n.y>=t.y},yj=function(n,t){return n.bottom<=t.bottom},xj=function(n,t,e){return on(n,(function(n){switch(n){case"bottom":return yj(t,e);case"top":return bj(t,e)}}))},wj=function(n,t){return t.getInitialPosition().map((function(t){return os(t.bounds.x,t.bounds.y,Ic(n),kc(n))}))},Sj=function(n,t,e){e.setInitialPosition(R.some({style:tc(n),position:Qa(n,"position")||"static",bounds:t}))},kj=function(n,t,e){return e.getInitialPosition().bind((function(o){switch(e.setInitialPosition(R.none()),o.position){case"static":return R.some(gj.static());case"absolute":var r=dj(n).map(rs).getOrThunk((function(){return rs(Ga())}));return R.some(gj.absolute(ol("absolute",Nn(o.style,"left").map((function(n){return t.x-r.x})),Nn(o.style,"top").map((function(n){return t.y-r.y})),Nn(o.style,"right").map((function(n){return r.right-t.right})),Nn(o.style,"bottom").map((function(n){return r.bottom-t.bottom})))));default:return R.none()}}))},Cj=function(n,t,e){return wj(n,e).filter((function(n){return xj(e.getModes(),n,t)})).bind((function(t){return kj(n,t,e)}))},Oj=function(n,t,e){var o=rs(n);if(xj(e.getModes(),o,t))return R.none();Sj(n,o,e);var r=us(),i=o.x-r.x,u=t.y-r.y,a=r.bottom-t.bottom,c=o.y<=t.y;return R.some(gj.fixed(ol("fixed",R.some(i),c?R.some(u):R.none(),R.none(),c?R.none():R.some(a))))},_j=function(n,t,e){var o=n.element,r=nc(o,"position").is("fixed");return r?Cj(o,t,e):Oj(o,t,e)},Tj=function(n,t){var e=n.element;return wj(e,t).bind((function(n){return kj(e,n,t)}))},Ej=function(n,t){X(["left","right","top","bottom","position"],(function(t){return oc(n.element,t)})),t.onUndocked(n)},Dj=function(n,t,e){rl(n.element,e);var o="fixed"===e.position?t.onDocked:t.onUndocked;o(n)},Bj=function(n,t,e,o,r){void 0===r&&(r=!1),t.contextual.each((function(t){t.lazyContext(n).each((function(i){var u=hj(i,o);if(u!==e.isVisible())if(e.setVisible(u),r&&!u)La(n.element,[t.fadeOutClass]),t.onHide(n);else{var a=u?pj:vj;a(n,t)}}))}))},Aj=function(n,t,e){var o=t.lazyViewport(n),r=e.isDocked();r&&Bj(n,t,e,o),_j(n,o,e).each((function(i){e.setDocked(!r),i.fold((function(){return Ej(n,t)}),(function(e){return Dj(n,t,e)}),(function(r){Bj(n,t,e,o,!0),Dj(n,t,r)}))}))},Mj=function(n,t,e){var o=n.element;e.setDocked(!1),Tj(n,e).each((function(e){e.fold((function(){return Ej(n,t)}),(function(e){return Dj(n,t,e)}),p)})),e.setVisible(!0),t.contextual.each((function(t){ja(o,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(n)})),Fj(n,t,e)},Fj=function(n,t,e){n.getSystem().isConnected()&&Aj(n,t,e)},Ij=function(n,t,e){e.isDocked()&&Mj(n,t,e)},Rj=function(n,t,e){return e.isDocked()},Vj=function(n,t,e,o){return e.setModes(o)},Pj=function(n,t,e){return e.getModes()},Hj=Object.freeze({__proto__:null,refresh:Fj,reset:Ij,isDocked:Rj,getModes:Pj,setModes:Vj}),zj=function(n,t){return vi([Di(Rr(),(function(e,o){n.contextual.each((function(n){if(Na(e.element,n.transitionClass)){ja(e.element,[n.transitionClass,n.fadeInClass]);var r=t.isVisible()?n.onShown:n.onHidden;r(e)}o.stop()}))})),xi(Qr(),(function(e,o){Fj(e,n,t)})),xi(Zr(),(function(e,o){Ij(e,n,t)}))])},Nj=Object.freeze({__proto__:null,events:zj}),Lj=[Ve("contextual",[Se("fadeInClass"),Se("fadeOutClass"),Se("transitionClass"),Oe("lazyContext"),Hs("onShow"),Hs("onShown"),Hs("onHide"),Hs("onHidden")]),We("lazyViewport",us),Xe("modes",["top","bottom"],me),Hs("onDocked"),Hs("onUndocked")],jj=function(n){var t=Ke(!1),e=Ke(!0),o=Ke(R.none()),r=Ke(n.modes),i=function(){return"docked:  "+t.get()+", visible: "+e.get()+", modes: "+r.get().join(",")};return ra({isDocked:t.get,setDocked:t.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:i})},Uj=Object.freeze({__proto__:null,init:jj}),Wj=Uf({fields:Lj,name:"docking",active:Nj,apis:Hj,state:Uj}),Gj={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},Xj="tox-tinymce--toolbar-sticky-on",Yj="tox-tinymce--toolbar-sticky-off",qj=function(n,t){var e=Li(t),o=e.dom.defaultView.innerHeight,r=Wc(e),i=to.fromDom(n.elm),u=is(i),a=kc(i),c=u.y,s=c+a,f=Bc(t),l=kc(t),d=f.top,m=d+l,g=Math.abs(d-r.top)<2,p=Math.abs(m-(r.top+o))<2;if(g&&c<m)Gc(r.left,c-l,e);else if(p&&s>d){var v=c-o+a+l;Gc(r.left,v,e)}},Kj=function(n,t){return L(Wj.getModes(n),t)},Jj=function(n){var t=function(n){return Cc(n)+(parseInt(Qa(n,"margin-top"),10)||0)+(parseInt(Qa(n,"margin-bottom"),10)||0)},e=n.element;Gi(e).each((function(o){var r="padding-"+Wj.getModes(n)[0];if(Wj.isDocked(n)){var i=Ic(o);Ka(e,"width",i+"px"),Ka(o,r,t(e)+"px")}else oc(e,"width"),oc(o,r)}))},$j=function(n,t){t?(za(n,Gj.fadeOutClass),La(n,[Gj.transitionClass,Gj.fadeInClass])):(za(n,Gj.fadeInClass),La(n,[Gj.fadeOutClass,Gj.transitionClass]))},Qj=function(n,t){var e=to.fromDom(n.getContainer());t?(Pa(e,Xj),za(e,Yj)):(Pa(e,Yj),za(e,Xj))},Zj=function(n,t){var e=Li(t);nl(e).filter((function(n){return!ir(t,n)})).filter((function(t){return ir(t,to.fromDom(e.dom.body))||cr(n,t)})).each((function(){return $f(t)}))},nU=function(n,t){return tl(n).orThunk((function(){return t().toOptional().bind((function(n){return tl(n.element)}))}))},tU=function(n,t,e){n.inline||(t.header.isPositionedAtTop()||n.on("ResizeEditor",(function(){e().each(Wj.reset)})),n.on("ResizeWindow ResizeEditor",(function(){e().each(Jj)})),n.on("SkinLoaded",(function(){e().each((function(n){Wj.isDocked(n)?Wj.reset(n):Wj.refresh(n)}))})),n.on("FullscreenStateChanged",(function(){e().each(Wj.reset)}))),n.on("AfterScrollIntoView",(function(n){e().each((function(t){Wj.refresh(t);var e=t.element;Fh(e)&&qj(n,e)}))})),n.on("PostRender",(function(){Qj(n,!1)}))},eU=function(n){return n().map(Wj.isDocked).getOr(!1)},oU=function(){var n;return[Yf.config({channels:(n={},n[Mz()]={onReceive:Jj},n)})]},rU=function(n,t){var e=Ke(R.none()),o=t.getSink,r=function(n){o().each((function(t){return n(t.element)}))},i=function(t){n.inline||Jj(t),Qj(n,Wj.isDocked(t)),t.getSystem().broadcastOn([pg()],{}),o().each((function(n){return n.getSystem().broadcastOn([pg()],{})}))},u=n.inline?[]:oU();return D([My.config({}),Wj.config({contextual:T({lazyContext:function(t){var e=Cc(t.element),o=n.inline?n.getContentAreaContainer():n.getContainer(),r=rs(to.fromDom(o)),i=r.height-e,u=r.y+(Kj(t,"top")?0:e);return R.some(os(r.x,u,r.width,i))},onShow:function(){r((function(n){return $j(n,!0)}))},onShown:function(n){r((function(n){return ja(n,[Gj.transitionClass,Gj.fadeInClass])})),e.get().each((function(t){Zj(n.element,t),e.set(R.none())}))},onHide:function(n){e.set(nU(n.element,o)),r((function(n){return $j(n,!1)}))},onHidden:function(){r((function(n){return ja(n,[Gj.transitionClass])}))}},Gj),modes:[t.header.getDockingMode()],onDocked:i,onUndocked:i})],u)},iU=Object.freeze({__proto__:null,setup:tU,isDocked:eU,getBehaviours:rU}),uU=function(n){var t=n.editor,e=n.sticky?rU:fj;return{uid:n.uid,dom:n.dom,components:n.components,behaviours:Lf(e(t,n.sharedBackstage))}},aU=function(n,t){var e=function(n,e){var o=G(e,(function(n){var e={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},o=Wz(e).mapError((function(n){return ue(n)})).getOrDie();return II(o,"tox-mbtn",t.backstage,R.some("menuitem"))}));wy.set(n,o)},o={focus:ly.focusIn,setMenus:e};return{uid:n.uid,dom:n.dom,components:[],behaviours:Lf([wy.config({}),ky("menubar-events",[Bi((function(t){n.onSetup(t)})),xi(Tr(),(function(n,t){gs(n.element,".tox-mbtn--active").each((function(e){ps(t.event.target,".tox-mbtn").each((function(t){ir(e,t)||n.getSystem().getByDom(e).each((function(e){n.getSystem().getByDom(t).each((function(n){bD.expand(n),bD.close(e),My.focus(n)}))}))}))}))})),xi(ri(),(function(n,t){t.event.prevFocus.bind((function(t){return n.getSystem().getByDom(t).toOptional()})).each((function(e){t.event.newFocus.bind((function(t){return n.getSystem().getByDom(t).toOptional()})).each((function(n){bD.isOpen(e)&&(bD.expand(n),bD.close(e))}))}))}))]),ly.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),R.some(!0)}}),nE.config({})]),apis:o,domModification:{attributes:{role:"menubar"}}}},cU=av({factory:aU,name:"silver.Menubar",configFields:[ye("dom"),ye("uid"),ye("onEscape"),ye("backstage"),He("onSetup",p)],apis:{focus:function(n,t){n.focus(t)},setMenus:function(n,t,e){n.setMenus(t,e)}}}),sU="container",fU=[Jg("slotBehaviours",[])],lU=function(n){return"<alloy.field."+n+">"},dU=function(n){var t=function(){var n=[],t=function(t,e){return n.push(t),Hp(sU,lU(t),e)};return{slot:t,record:function(){return n}}}(),e=n(t),o=t.record(),r=G(o,(function(n){return Ep({name:n,pname:lU(n)})}));return tv(sU,fU,r,mU,e)},mU=function(n,t){var e=function(t){return Yp(n)},o=function(t,e){return Up(t,n,e)},r=function(t,e){return function(o,r){return Up(o,n,r).map((function(n){return t(n,r)})).getOr(e)}},i=function(n){return function(t,e){X(e,(function(e){return n(t,e)}))}},u=function(n,t){return"true"!==Ou(n.element,"aria-hidden")},a=function(n,t){if(!u(n)){var e=n.element;oc(e,"display"),Eu(e,"aria-hidden"),li(n,ii(),{name:t,visible:!0})}},c=function(n,t){if(u(n)){var e=n.element;Ka(e,"display","none"),ku(e,"aria-hidden","true"),li(n,ii(),{name:t,visible:!1})}},s=r(u,!1),f=r(c),l=i(f),d=function(n){return l(n,e())},m=r(a),g={getSlotNames:e,getSlot:o,isShowing:s,hideSlot:f,hideAllSlots:d,showSlot:m};return{uid:n.uid,dom:n.dom,components:t,behaviours:$g(n.slotBehaviours),apis:g}},gU=Mn({getSlotNames:function(n,t){return n.getSlotNames(t)},getSlot:function(n,t,e){return n.getSlot(t,e)},isShowing:function(n,t,e){return n.isShowing(t,e)},hideSlot:function(n,t,e){return n.hideSlot(t,e)},hideAllSlots:function(n,t){return n.hideAllSlots(t)},showSlot:function(n,t,e){return n.showSlot(t,e)}},(function(n){return ea(n)})),pU=T(T({},gU),{sketch:dU}),vU=zt([Fe("icon"),Fe("tooltip"),We("onShow",p),We("onHide",p),We("onSetup",(function(){return p}))]),hU=function(n){return oe("sidebar",vU,n)},bU=function(n){var t=n.ui.registry.getAll().sidebars;X(Dn(t),(function(e){var o=t[e],r=function(){return R.from(n.queryCommandValue("ToggleSidebar")).is(e)};n.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(t){n.execCommand("ToggleSidebar",!1,e),t.setActive(r())},onSetup:function(t){var e=function(){return t.setActive(r())};return n.on("ToggleSidebar",e),function(){n.off("ToggleSidebar",e)}}})}))},yU=function(n){return{element:function(){return n.element.dom}}},xU=function(n,t){var e=G(Dn(t),(function(n){var e=t[n],o=re(hU(e));return{name:n,getApi:yU,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return G(e,(function(t){var o=Ke(p);return n.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:vk.unnamedEvents([$C(t,o),QC(t,o),xi(ii(),(function(n,t){var o=t.event,r=Z(e,(function(n){return n.name===o.name}));r.each((function(t){var e=o.visible?t.onShow:t.onHide;e(t.getApi(n))}))}))])})}))},wU=function(n){return pU.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:xU(t,n),slotBehaviours:vk.unnamedEvents([Bi((function(n){return pU.hideAllSlots(n)}))])}}))},SU=function(n,t){var e=yv.getCurrent(n);e.each((function(n){return wy.set(n,[wU(t)])}))},kU=function(n,t){var e=yv.getCurrent(n);e.each((function(n){var e=yv.getCurrent(n);e.each((function(e){Cz.hasGrown(n)?pU.isShowing(e,t)?Cz.shrink(n):(pU.hideAllSlots(e),pU.showSlot(e,t)):(pU.hideAllSlots(e),pU.showSlot(e,t),Cz.grow(n))}))}))},CU=function(n){var t=yv.getCurrent(n);return t.bind((function(n){var t=Cz.isGrowing(n)||Cz.hasGrown(n);if(t){var e=yv.getCurrent(n);return e.bind((function(n){return Z(pU.getSlotNames(n),(function(t){return pU.isShowing(n,t)}))}))}return R.none()}))},OU=Pu("FixSizeEvent"),_U=Pu("AutoSizeEvent"),TU=function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Lf([nE.config({}),My.config({}),Cz.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(n){var t=yv.getCurrent(n);t.each(pU.hideAllSlots),fi(n,_U)},onGrown:function(n){fi(n,_U)},onStartGrow:function(n){li(n,OU,{width:nc(n.element,"width").getOr("")})},onStartShrink:function(n){li(n,OU,{width:Ic(n.element)+"px"})}}),wy.config({}),yv.config({find:function(n){var t=wy.contents(n);return fn(t)}})])}],behaviours:Lf([DM.childAt(0),ky("sidebar-sliding-events",[xi(OU,(function(n,t){Ka(n.element,"width",t.event.width)})),xi(_U,(function(n,t){oc(n.element,"width")}))])])}},EU=function(n){var t=void 0!==n.dom.attributes?n.dom.attributes:[];return $(t,(function(n,t){var e;return"class"===t.name?n:T(T({},n),(e={},e[t.name]=t.value,e))}),{})},DU=function(n){return Array.prototype.slice.call(n.dom.classList,0)},BU=function(n){var t=to.fromHtml(n),e=Ki(t),o=EU(t),r=DU(t),i=0===e.length?{}:{innerHtml:yu(t)};return T({tag:Ii(t),classes:r,attributes:o},i)},AU=function(n){return{dom:{tag:"div",attributes:{"aria-label":n.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:BU('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:Lf([ly.config({mode:"special",onTab:function(){return R.some(!0)},onShiftTab:function(){return R.some(!0)}}),My.config({})])}},MU=function(n,t,e){var o=n.element;!0===t?(wy.set(n,[AU(e)]),oc(o,"display"),Eu(o,"aria-hidden")):(wy.set(n,[]),Ka(o,"display","none"),ku(o,"aria-hidden","true"))},FU=function(n){return{uid:n.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Lf([wy.config({})]),components:[]}},IU=function(n,t,e){var o=Ke(!1),r=Ke(R.none()),i=function(r){r!==o.get()&&(MU(t(),r,e.providers),o.set(r),n.fire("AfterProgressState",{state:r}))};n.on("ProgressState",(function(t){if(r.get().each(Kx.clearTimeout),m(t.time)){var e=Kx.setEditorTimeout(n,(function(){return i(t.state)}),t.time);r.set(R.some(e))}else i(t.state),r.set(R.none())}))},RU=function(n,t,e){var o={getSocket:function(t){return ZL.getPart(t,n,"socket")},setSidebar:function(t,e){ZL.getPart(t,n,"sidebar").each((function(n){return SU(n,e)}))},toggleSidebar:function(t,e){ZL.getPart(t,n,"sidebar").each((function(n){return kU(n,e)}))},whichSidebar:function(t){return ZL.getPart(t,n,"sidebar").bind(CU).getOrNull()},getHeader:function(t){return ZL.getPart(t,n,"header")},getToolbar:function(t){return ZL.getPart(t,n,"toolbar")},setToolbar:function(t,e){ZL.getPart(t,n,"toolbar").each((function(n){n.getApis().setGroups(n,e)}))},setToolbars:function(t,e){ZL.getPart(t,n,"multiple-toolbar").each((function(n){aj.setItems(n,e)}))},refreshToolbar:function(t){var e=ZL.getPart(t,n,"toolbar");e.each((function(n){return n.getApis().refresh(n)}))},toggleToolbarDrawer:function(t){ZL.getPart(t,n,"toolbar").each((function(n){mv(n.getApis().toggle,(function(t){return t(n)}))}))},isToolbarDrawerToggled:function(t){return ZL.getPart(t,n,"toolbar").bind((function(n){return R.from(n.getApis().isOpen).map((function(t){return t(n)}))})).getOr(!1)},getThrobber:function(t){return ZL.getPart(t,n,"throbber")},focusToolbar:function(t){var e=ZL.getPart(t,n,"toolbar").orThunk((function(){return ZL.getPart(t,n,"multiple-toolbar")}));e.each((function(n){ly.focusIn(n)}))},setMenubar:function(t,e){ZL.getPart(t,n,"menubar").each((function(n){cU.setMenus(n,e)}))},focusMenubar:function(t){ZL.getPart(t,n,"menubar").each((function(n){cU.focus(n)}))}};return{uid:n.uid,dom:n.dom,components:t,apis:o,behaviours:n.behaviours}},VU=nj.optional({factory:cU,name:"menubar",schema:[ye("backstage")]}),PU=function(n){return n.type===aS.sliding?Hz:n.type===aS.floating?Pz:zz},HU=nj.optional({factory:{sketch:function(n){return aj.sketch({uid:n.uid,dom:n.dom,listBehaviours:Lf([ly.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return zz({type:n.type,uid:Pu("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:n.providers,onEscape:function(){return n.onEscape(),R.some(!0)}})},setupItem:function(n,t,e,o){yH.setGroups(t,e)},shell:!0})}},name:"multiple-toolbar",schema:[ye("dom"),ye("onEscape")]}),zU=nj.optional({factory:{sketch:function(n){var t=PU(n),e={type:n.type,uid:n.uid,onEscape:function(){return n.onEscape(),R.some(!0)},cyclicKeying:!1,initGroups:[],getSink:n.getSink,providers:n.providers,moreDrawerData:{lazyToolbar:n.lazyToolbar,lazyMoreButton:n.lazyMoreButton,lazyHeader:n.lazyHeader},attributes:n.attributes};return t(e)}},name:"toolbar",schema:[ye("dom"),ye("onEscape"),ye("getSink")]}),NU=nj.optional({factory:{sketch:uU},name:"header",schema:[ye("dom")]}),LU=nj.optional({name:"socket",schema:[ye("dom")]}),jU=nj.optional({factory:{sketch:TU},name:"sidebar",schema:[ye("dom")]}),UU=nj.optional({factory:{sketch:FU},name:"throbber",schema:[ye("dom")]}),WU=cv({name:"OuterContainer",factory:RU,configFields:[ye("dom"),ye("behaviours")],partFields:[NU,VU,zU,HU,LU,jU,UU],apis:{getSocket:function(n,t){return n.getSocket(t)},setSidebar:function(n,t,e){n.setSidebar(t,e)},toggleSidebar:function(n,t,e){n.toggleSidebar(t,e)},whichSidebar:function(n,t){return n.whichSidebar(t)},getHeader:function(n,t){return n.getHeader(t)},getToolbar:function(n,t){return n.getToolbar(t)},setToolbar:function(n,t,e){var o=G(e,(function(n){return Iz(n)}));n.setToolbar(t,o)},setToolbars:function(n,t,e){var o=G(e,(function(n){return G(n,Iz)}));n.setToolbars(t,o)},refreshToolbar:function(n,t){return n.refreshToolbar(t)},toggleToolbarDrawer:function(n,t){n.toggleToolbarDrawer(t)},isToolbarDrawerToggled:function(n,t){return n.isToolbarDrawerToggled(t)},getThrobber:function(n,t){return n.getThrobber(t)},setMenubar:function(n,t,e){n.setMenubar(t,e)},focusMenubar:function(n,t){n.focusMenubar(t)},focusToolbar:function(n,t){n.focusToolbar(t)}}}),GU="file edit view insert format tools table help",XU={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},YU=function(n,t,e){var o=fC(e).split(/[ ,]/);return{text:n.title,getItems:function(){return en(n.items,(function(n){var e=n.toLowerCase();return 0===e.trim().length||j(o,(function(n){return n===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:t.menuItems[e]?[t.menuItems[e]]:[]}))}}},qU=function(n){return"string"===typeof n?n.split(" "):n},KU=function(n,t){var e=T(T({},XU),t.menus),o=Dn(t.menus).length>0,r=void 0===t.menubar||!0===t.menubar?qU(GU):qU(!1===t.menubar?"":t.menubar),i=K(r,(function(n){return o&&t.menus.hasOwnProperty(n)&&t.menus[n].hasOwnProperty("items")||XU.hasOwnProperty(n)})),u=G(i,(function(o){var r=e[o];return YU({title:r.title,items:qU(r.items)},t,n)}));return K(u,(function(n){var t=function(n){return"separator"!==n.type};return n.getItems().length>0&&j(n.getItems(),t)}))},JU=function(n){var t=function(){n._skinLoaded=!0,$O(n)};return function(){n.initialized?t():n.on("init",t)}},$U=function(n,t){return function(){return QO(n,{message:t})}},QU=function(n,t,e){return new Ow((function(o,r){e.load(t,o,r),n.on("remove",(function(){return e.unload(t)}))}))},ZU=function(n,t){var e=t+"/skin.min.css";return QU(n,e,n.ui.styleSheetLoader)},nW=function(n,t){var e=ou(to.fromDom(n.getElement()));if(e){var o=t+"/skin.shadowdom.min.css";return QU(n,o,Bk.DOM.styleSheetLoader)}return Ow.resolve()},tW=function(n,t){var e=Qk(t);e&&t.contentCSS.push(e+(n?"/content.inline":"/content")+".min.css"),!1===nC(t)&&i(e)?Ow.all([ZU(t,e),nW(t,e)]).then(JU(t),$U(t,"Skin could not be loaded")):JU(t)()},eW=w(tW,!1),oW=w(tW,!0),rW=function(n,t,e,o){var r=t.outerContainer,u=e.toolbar,a=e.buttons;if(g(u,i)){var c=u.map((function(t){var r={toolbar:t,buttons:a,allowToolbarGroups:e.allowToolbarGroups};return WL(n,r,{backstage:o},R.none())}));WU.setToolbars(r,c)}else WU.setToolbar(r,WL(n,e,{backstage:o},R.none()))},iW=qo(),uW=iW.os.isiOS()&&iW.os.version.major<=12,aW=function(n,t){var e=n.dom,o=n.getWin(),r=n.getDoc().documentElement,i=Ke(Tc(o.innerWidth,o.innerHeight)),u=Ke(Tc(r.offsetWidth,r.offsetHeight)),a=function(){var t=i.get();t.left===o.innerWidth&&t.top===o.innerHeight||(i.set(Tc(o.innerWidth,o.innerHeight)),n_(n))},c=function(){var t=n.getDoc().documentElement,e=u.get();e.left===t.offsetWidth&&e.top===t.offsetHeight||(u.set(Tc(t.offsetWidth,t.offsetHeight)),n_(n))},s=function(t){return t_(n,t)};e.bind(o,"resize",a),e.bind(o,"scroll",s);var f=gT(to.fromDom(n.getBody()),"load",c),l=t.uiMothership.element;n.on("hide",(function(){Ka(l,"display","none")})),n.on("show",(function(){oc(l,"display")})),n.on("NodeChange",c),n.on("remove",(function(){f.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null}))},cW=function(n,t,e,o,r){var i=Ke(0),u=t.outerContainer;eW(n);var a=to.fromDom(r.targetNode),c=eu(tu(a));Gm(a,t.mothership),Wm(c,t.uiMothership),n.on("PostRender",(function(){rW(n,t,e,o),i.set(n.getWin().innerWidth),WU.setMenubar(u,KU(n,e)),WU.setSidebar(u,e.sidebar),aW(n,t)}));var s=WU.getSocket(u).getOrDie("Could not find expected socket element");if(uW){Ja(s.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var f=cw((function(){n.fire("ScrollContent")}),20),l=mT(s.element,"scroll",f.throttle);n.on("remove",l.unbind)}UC(n,t),n.addCommand("ToggleSidebar",(function(t,e){WU.toggleSidebar(u,e),n.fire("ToggleSidebar")})),n.addQueryValueHandler("ToggleSidebar",(function(){return WU.whichSidebar(u)}));var d=vC(n),m=function(){WU.refreshToolbar(t.outerContainer)};d!==aS.sliding&&d!==aS.floating||n.on("ResizeWindow ResizeEditor ResizeContent",(function(){var t=n.getWin().innerWidth;t!==i.get()&&(m(),i.set(t))}));var g={enable:function(){jC(t,!1)},disable:function(){jC(t,!0)},isDisabled:function(){return Jk.isDisabled(u)}};return{iframeContainer:s.element.dom,editorContainer:u.element.dom,api:g}},sW=Object.freeze({__proto__:null,render:cW}),fW=function(n){var t=/^[0-9\.]+(|px)$/i;return t.test(""+n)?R.some(parseInt(""+n,10)):R.none()},lW=function(n){return m(n)?n+"px":n},dW=function(n,t,e){var o=t.filter((function(t){return n<t})),r=e.filter((function(t){return n>t}));return o.or(r).getOr(n)},mW=function(n){var t=tC(n),e=rC(n),o=uC(n);return fW(t).map((function(n){return dW(n,e,o)}))},gW=function(n){var t=mW(n);return t.getOr(tC(n))},pW=function(n){var t=eC(n),e=oC(n),o=iC(n);return fW(t).map((function(n){return dW(n,e,o)}))},vW=function(n){var t=pW(n);return t.getOr(eC(n))},hW=function(n,t,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=Bk.DOM,c=OC(n),s=EC(n),f=iC(n).or(pW(n)),l=o.shared.header,d=l.isPositionedAtTop,m=vC(n),g=m===aS.sliding||m===aS.floating,p=Ke(!1),v=function(){return p.get()&&!n.removed},h=function(n){return g?n.fold((function(){return 0}),(function(n){return n.components().length>1?kc(n.components()[1].element):0})):0},b=function(e){switch(yC(n)){case pC.auto:var o=WU.getToolbar(u),r=h(o),i=kc(e.element)-r,a=rs(t),c=a.y>i;if(c)return"top";var s=Ui(t),f=Math.max(s.dom.scrollHeight,kc(s)),l=a.bottom<f-i;if(l)return"bottom";var d=us(),m=d.bottom<a.bottom-i;return m?"bottom":"top";case pC.bottom:return"bottom";case pC.top:default:return"top"}},y=function(n){var t=r.get();Wj.setModes(t,[n]),l.setDockingMode(n);var e=d()?ws.TopToBottom:ws.BottomToTop;ku(t.element,Ll,e)},x=function(){var n=f.getOrThunk((function(){var n=fW(Qa(Ga(),"margin-left")).getOr(0);return Ic(Ga())-Bc(t).left+n}));Ka(r.get().element,"max-width",n+"px")},w=function(){var n=WU.getToolbar(u),e=h(n),o=rs(t),i=d()?Math.max(o.y-kc(r.get().element)+e,0):o.bottom;Ja(u.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(o.x)+"px"})},S=function(){i.broadcastOn([pg()],{})},k=function(n){if(void 0===n&&(n=!1),v()){if(c||x(),g&&WU.refreshToolbar(u),c||w(),s){var t=r.get();n?Wj.reset(t):Wj.refresh(t)}S()}},C=function(n){if(void 0===n&&(n=!0),!c&&s&&v()){var t=l.getDockingMode(),e=b(r.get());e!==t&&(y(e),n&&k(!0))}},O=function(){p.set(!0),Ka(u.element,"display","flex"),a.addClass(n.getBody(),"mce-edit-focus"),oc(i.element,"display"),C(!1),k()},_=function(){p.set(!1),e.outerContainer&&(Ka(u.element,"display","none"),a.removeClass(n.getBody(),"mce-edit-focus")),Ka(i.element,"display","none")};return{isVisible:v,isPositionedAtTop:d,show:O,hide:_,update:k,updateMode:C,repositionPopups:S}},bW=function(n,t){var e=rs(n);return{pos:t?e.y:e.bottom,bounds:e}},yW=function(n,t,e,o){var r=Ke(bW(t,e.isPositionedAtTop())),i=function(o){var i=bW(t,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,f=c.bounds,l=a.height!==f.height||a.width!==f.width;r.set({pos:u,bounds:a}),l&&n_(n,o),e.isVisible()&&(s!==u?e.update(!0):l&&(e.updateMode(),e.repositionPopups()))};o||(n.on("activate",e.show),n.on("deactivate",e.hide)),n.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),n.on("NodeChange keydown",(function(n){Kx.requestAnimationFrame((function(){return i(n)}))})),n.on("ScrollWindow",(function(){return e.updateMode()}));var u=kL();u.set(gT(to.fromDom(n.getBody()),"load",i)),n.on("remove",(function(){u.clear()}))},xW=function(n,t,e,o,r){var i=t.mothership,u=t.uiMothership,a=t.outerContainer,c=Ke(null),s=to.fromDom(r.targetNode),f=hW(n,s,t,o,c),l=kC(n);oW(n);var d=function(){if(c.get())f.show();else{c.set(WU.getHeader(a).getOrDie());var r=_C(n);Wm(r,i),Wm(r,u),rW(n,t,e,o),WU.setMenubar(a,KU(n,e)),f.show(),yW(n,s,f,l),n.nodeChanged()}},m=function(){return Kx.setEditorTimeout(n,d,0)};n.on("show",d),n.on("hide",f.hide),l||(n.on("focus",m),n.on("blur",f.hide)),n.on("init",(function(){(n.hasFocus()||l)&&m()})),UC(n,t);var g={show:function(){f.show()},hide:function(){f.hide()},enable:function(){jC(t,!1)},disable:function(){jC(t,!0)},isDisabled:function(){return Jk.isDisabled(a)}};return{editorContainer:a.element.dom,api:g}},wW=Object.freeze({__proto__:null,render:xW}),SW=function(n){var t=[{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}];PM.each(t,(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return n.execCommand(t.cmd)},icon:t.icon,onSetup:OL(n,t.name)})}));var e={name:"alignnone",text:"No alignment",cmd:"JustifyNone",icon:"align-none"};n.ui.registry.addButton(e.name,{tooltip:e.text,onAction:function(){return n.execCommand(e.cmd)},icon:e.icon})},kW=function(n,t){oL(n,t),fL(n,t),FL(n,t),BL(n,t),yL(n,t)},CW=function(n,t){n.setDisabled(!t.queryCommandState("outdent"));var e=function(){n.setDisabled(!t.queryCommandState("outdent"))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}},OW=function(n){n.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return CW(t,n)},onAction:function(){return n.execCommand("outdent")}}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return n.execCommand("indent")}})},_W=function(n){OW(n)},TW={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},EW=function(){var n="[0-9]+",t="[+-]?"+n,e="[eE]"+t,o="\\.",r=function(n){return"(?:"+n+")?"},i=["Infinity",n+o+r(n)+r(e),o+n+r(e),n+r(e)].join("|"),u="[+-]?(?:"+i+")";return new RegExp("^("+u+")(.*)$")}(),DW=function(n,t){return j(t,(function(t){return j(TW[t],(function(t){return n===t}))}))},BW=function(n,t){var e=R.from(EW.exec(n));return e.bind((function(n){var e=Number(n[1]),o=n[2];return DW(o,t)?R.some({value:e,unit:o}):R.none()}))},AW=function(n,t){return BW(n,t).map((function(n){var t=n.value,e=n.unit;return t+e}))},MW=function(n){return AW(n,["fixed","relative","empty"]).getOr(n)},FW=function(n){var t=sC(n),e=new Map,o=SL(),r=function(){var t=MW(n.queryCommandValue("LineHeight"));R.from(e.get(t)).fold((function(){return o.clear()}),(function(n){o.set({destroy:function(){n.setActive(!1)}}),n.setActive(!0)}))};return n.on("nodeChange",r),G(t,(function(i,u){return{type:"togglemenuitem",text:i,onSetup:function(a){return e.set(MW(i),a),u+1===t.length&&r(),function(){0===u&&(n.off("nodeChange",r),o.clear())}},onAction:function(){return n.execCommand("LineHeight",!1,i)}}}))},IW=function(n){n.ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return FW(n)}})},RW=function(n){n.ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(FW(n))}})},VW=function(n){IW(n),RW(n)},PW=function(n,t){return function(){n.execCommand("mceToggleFormat",!1,t)}},HW=function(n){PM.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(t,e){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:OL(n,t.name),onAction:PW(n,t.name)})}));for(var t=1;t<=6;t++){var e="h"+t;n.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+t,onSetup:OL(n,e),onAction:PW(n,e)})}},zW=function(n){PM.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}))},NW=function(n){PM.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)},onSetup:OL(n,t.name)})}))},LW=function(n){HW(n),zW(n),NW(n)},jW=function(n){PM.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:PW(n,"code")})},UW=function(n){LW(n),jW(n)},WW=function(n,t,e){var o=function(){return!!t.undoManager&&t.undoManager[e]()},r=function(){n.setDisabled(t.mode.isReadOnly()||!o())};return n.setDisabled(!o()),t.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return t.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},GW=function(n){n.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return WW(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return WW(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})},XW=function(n){n.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return WW(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return WW(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})},YW=function(n){GW(n),XW(n)},qW=function(n,t){n.setActive(t.hasVisual);var e=function(t){n.setActive(t.hasVisual)};return t.on("VisualAid",e),function(){return t.off("VisualAid",e)}},KW=function(n){n.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return qW(t,n)},onAction:function(){n.execCommand("mceToggleVisualAid")}})},JW=function(n){n.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return n.execCommand("mceToggleVisualAid")}})},$W=function(n){JW(n),KW(n)},QW=function(n,t){SW(n),UW(n),kW(n,t),YW(n),A_(n),$W(n),_W(n),VW(n)},ZW=function(n,t){return{anchor:"makeshift",x:n,y:t}},nG=function(n,t,e){return ZW(n.x+t,n.y+e)},tG=function(n){return"longpress"===n.type||0===n.type.indexOf("touch")},eG=function(n){if(tG(n)){var t=n.touches[0];return ZW(t.pageX,t.pageY)}return ZW(n.pageX,n.pageY)},oG=function(n){if(tG(n)){var t=n.touches[0];return ZW(t.clientX,t.clientY)}return ZW(n.clientX,n.clientY)},rG=function(n,t){var e=Bk.DOM.getPos(n);return nG(t,e.x,e.y)},iG=function(n,t){return"contextmenu"===t.type||"longpress"===t.type?n.inline?eG(t):rG(n.getContentAreaContainer(),oG(t)):uG(n)},uG=function(n){return{anchor:"selection",root:to.fromDom(n.selection.getNode())}},aG=function(n){return{anchor:"node",node:R.some(to.fromDom(n.selection.getNode())),root:to.fromDom(n.getBody())}},cG=function(n,t,e,o,r,i){var u=e(),a=i?aG(n):iG(n,t);MI(u,cS.CLOSE_ON_EXECUTE,o,!1).map((function(n){t.preventDefault(),Px.showMenuAt(r,a,{menu:{markers:FS("normal")},data:n})}))},sG={onLtr:function(){return[wf,vf,hf,bf,yf,xf,Yx,qx,Gx,Ux,Xx,Wx]},onRtl:function(){return[wf,hf,vf,yf,bf,xf,Yx,qx,Xx,Wx,Gx,Ux]}},fG=12,lG={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},dG=function(n,t){var e=n.selection;if(e.isCollapsed()||t.touches.length<1)return!1;var o=t.touches[0],r=e.getRng(),i=rm(n.getWin(),Ed.domRange(r));return i.exists((function(n){return n.left<=o.clientX&&n.right>=o.clientX&&n.top<=o.clientY&&n.bottom>=o.clientY}))},mG=function(n,t){return T({bubble:Rl(0,fG,lG),layouts:sG,overrides:{maxWidthFunction:dH(),maxHeightFunction:Bl()}},iG(n,t))},gG=function(n){var t=n.selection.getRng(),e=function(){Kx.setEditorTimeout(n,(function(){n.selection.setRng(t)}),10),i()};n.once("touchend",e);var o=function(n){n.preventDefault(),n.stopImmediatePropagation()};n.on("mousedown",o,!0);var r=function(){return i()};n.once("longpresscancel",r);var i=function(){n.off("touchend",e),n.off("longpresscancel",r),n.off("mousedown",o)}},pG=function(n,t,e,o,r,i,u){var a=i?aG(n):mG(n,t);MI(e,cS.CLOSE_ON_EXECUTE,o,!0).map((function(e){t.preventDefault(),Px.showMenuWithinBounds(r,a,{menu:{markers:FS("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return R.some(FN(n,o.shared))})),n.fire(gH)}))},vG=function(n,t,e,o,r,i){var u=qo(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){return!(s||a||c&&f)},d=function(){var u=e();pG(n,t,u,o,r,i,l())};if(!c&&!a||i)s&&!i&&n.selection.setCursorLocation(t.target,0),d();else{var m=function(){gG(n),d()};dG(n,t)?m():(n.once("selectionchange",m),n.once("touchend",(function(){return n.off("selectionchange",m)})))}},hG=function(n){return"string"===typeof n?n.split(/[ ,]/):n},bG=function(n){return n.getParam("contextmenu_never_use_native",!1,"boolean")},yG=function(n,t,e){var o=n.ui.registry.getAll().contextMenus;return R.from(n.getParam(t)).map(hG).getOrThunk((function(){return K(hG(e),(function(n){return Ln(o,n)}))}))},xG=function(n){return!1===n.getParam("contextmenu")},wG=function(n){return yG(n,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},SG=function(n){return n.getParam("contextmenu_avoid_overlap","","string")},kG=function(n){return i(n)?"|"===n:"separator"===n.type},CG={type:"separator"},OG=function(n){var t=function(n){return{text:n.text,icon:n.icon,disabled:n.disabled,shortcut:n.shortcut}};if(i(n))return n;switch(n.type){case"separator":return CG;case"submenu":return T(T({type:"nestedmenuitem"},t(n)),{getSubmenuItems:function(){var t=n.getSubmenuItems();return i(t)?t:G(t,OG)}});default:return T(T({type:"menuitem"},t(n)),{onAction:v(n.onAction)})}},_G=function(n,t){if(0===t.length)return n;var e=ln(n).filter((function(n){return!kG(n)})),o=e.fold((function(){return[]}),(function(n){return[CG]}));return n.concat(o).concat(t).concat([CG])},TG=function(n,t,e){var o=$(t,(function(t,o){return Nn(n,o.toLowerCase()).map((function(n){var o=n.update(e);if(i(o))return _G(t,o.split(" "));if(o.length>0){var r=G(o,OG);return _G(t,r)}return t})).getOrThunk((function(){return t.concat([o])}))}),[]);return o.length>0&&kG(o[o.length-1])&&o.pop(),o},EG=function(n,t){return t.ctrlKey&&!bG(n)},DG=function(n,t){return"longpress"!==t.type&&(2!==t.button||t.target===n.getBody()&&""===t.pointerType)},BG=function(n,t){return DG(n,t)?n.selection.getStart(!0):t.target},AG=function(n,t){var e=SG(n);if(DG(n,t))return!0;if(e){var o=BG(n,t);return vT(to.fromDom(o),e)}return!1},MG=function(n,t,e){var o=qo(),r=o.deviceType.isTouch,i=yc(Px.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return n.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:Lf([ky("dismissContextMenu",[xi(ei(),(function(t,e){mg.close(t),n.focus()}))])])})),u=function(n){return Px.hide(i)},a=function(t){if(bG(n)&&t.preventDefault(),!EG(n,t)&&!xG(n)){var o=AG(n,t),u=function(){var e=BG(n,t),o=n.ui.registry.getAll(),r=wG(n);return TG(o.contextMenus,r,e)},a=r()?vG:cG;a(n,t,u,e,i,o)}};n.on("init",(function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");n.on(t,u),n.on("longpress contextmenu",a)}))},FG=Wn.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),IG=function(n){return function(t){return t.translate(-n.left,-n.top)}},RG=function(n){return function(t){return t.translate(n.left,n.top)}},VG=function(n){return function(t,e){return $(n,(function(n,t){return t(n)}),Tc(t,e))}},PG=function(n,t,e){return n.fold(VG([RG(e),IG(t)]),VG([IG(t)]),VG([]))},HG=function(n,t,e){return n.fold(VG([RG(e)]),VG([]),VG([RG(t)]))},zG=function(n,t,e){return n.fold(VG([]),VG([IG(e)]),VG([RG(t),IG(e)]))},NG=function(n,t,e,o,r,i){var u=HG(n,r,i),a=HG(t,r,i);return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=o},LG=function(n,t,e,o,r,i){var u=HG(n,r,i),a=HG(t,r,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top);return Tc(c,s)},jG=function(n,t,e){var o=n.fold((function(n,t){return{position:R.some("absolute"),left:R.some(n+"px"),top:R.some(t+"px")}}),(function(n,t){return{position:R.some("absolute"),left:R.some(n-e.left+"px"),top:R.some(t-e.top+"px")}}),(function(n,t){return{position:R.some("fixed"),left:R.some(n+"px"),top:R.some(t+"px")}}));return T({right:R.none(),bottom:R.none()},o)},UG=function(n,t,e){return n.fold((function(n,o){return GG(n+t,o+e)}),(function(n,o){return XG(n+t,o+e)}),(function(n,o){return YG(n+t,o+e)}))},WG=function(n,t,e,o){var r=function(n,r){return function(i,u){var a=n(t,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return n.fold(r(zG,GG),r(HG,XG),r(PG,YG))},GG=FG.offset,XG=FG.absolute,YG=FG.fixed,qG=function(n,t){var e=Ou(n,t);return s(e)?NaN:parseInt(e,10)},KG=function(n,t){var e=n.element,o=qG(e,t.leftAttr),r=qG(e,t.topAttr);return isNaN(o)||isNaN(r)?R.none():R.some(Tc(o,r))},JG=function(n,t,e){var o=n.element;ku(o,t.leftAttr,e.left+"px"),ku(o,t.topAttr,e.top+"px")},$G=function(n,t){var e=n.element;Eu(e,t.leftAttr),Eu(e,t.topAttr)},QG=function(n,t,e,o){return KG(n,t).fold((function(){return e}),(function(n){return YG(n.left+o.left,n.top+o.top)}))},ZG=function(n,t,e,o,r,i){var u=QG(n,t,e,o),a=t.mustSnap?eX(n,t,u,r,i):oX(n,t,u,r,i),c=PG(u,r,i);return JG(n,t,c),a.fold((function(){return{coord:YG(c.left,c.top),extra:R.none()}}),(function(n){return{coord:n.output,extra:n.extra}}))},nX=function(n,t){$G(n,t)},tX=function(n,t,e,o){return mn(n,(function(n){var r=n.sensor,i=NG(t,r,n.range.left,n.range.top,e,o);return i?R.some({output:WG(n.output,t,e,o),extra:n.extra}):R.none()}))},eX=function(n,t,e,o,r){var i=t.getSnapPoints(n),u=tX(i,e,o,r);return u.orThunk((function(){var n=$(i,(function(n,t){var i=t.sensor,u=LG(e,i,t.range.left,t.range.top,o,r);return n.deltas.fold((function(){return{deltas:R.some(u),snap:R.some(t)}}),(function(e){var o=(u.left+u.top)/2,r=(e.left+e.top)/2;return o<=r?{deltas:R.some(u),snap:R.some(t)}:n}))}),{deltas:R.none(),snap:R.none()});return n.snap.map((function(n){return{output:WG(n.output,e,o,r),extra:n.extra}}))}))},oX=function(n,t,e,o,r){var i=t.getSnapPoints(n);return tX(i,e,o,r)},rX=function(n,t,e){return{coord:WG(n.output,n.output,t,e),extra:n.extra}},iX=function(n,t,e,o){var r=t.getTarget(n.element);if(t.repositionTarget){var i=Li(n.element),u=Wc(i),a=mj(r),c=rX(o,u,a),s=jG(c.coord,u,a);$a(r,s)}},uX=Object.freeze({__proto__:null,snapTo:iX}),aX="data-initial-z-index",cX=function(n){Gi(n.element).filter(Pi).each((function(n){_u(n,aX).fold((function(){return oc(n,"z-index")}),(function(t){return Ka(n,"z-index",t)})),Eu(n,aX)}))},sX=function(n){Gi(n.element).filter(Pi).each((function(t){nc(t,"z-index").each((function(n){ku(t,aX,n)})),Ka(t,"z-index",Qa(n.element,"z-index"))}))},fX=function(n,t){n.getSystem().addToGui(t),sX(t)},lX=function(n){cX(n),n.getSystem().removeFromGui(n)},dX=function(n,t,e){return n.getSystem().build(WT.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:e}))},mX=Ve("snaps",[ye("getSnapPoints"),Hs("onSensor"),ye("leftAttr"),ye("topAttr"),He("lazyViewport",us),He("mustSnap",!1)]),gX=[He("useFixed",C),ye("blockerClass"),He("getTarget",x),He("onDrag",p),He("repositionTarget",!0),He("onDrop",p),We("getBounds",us),mX],pX=function(n){return dv(nc(n,"left"),nc(n,"top"),nc(n,"position"),(function(n,t,e){var o="fixed"===e?YG:GG;return o(parseInt(n,10),parseInt(t,10))})).getOrThunk((function(){var t=Bc(n);return XG(t.left,t.top)}))},vX=function(n,t,e,o,r){var i=r.bounds,u=HG(t,e,o),a=hl(u.left,i.x,i.x+i.width-r.width),c=hl(u.top,i.y,i.y+i.height-r.height),s=XG(a,c);return t.fold((function(){var n=zG(s,e,o);return GG(n.left,n.top)}),(function(){return s}),(function(){var n=PG(s,e,o);return YG(n.left,n.top)}))},hX=function(n,t,e,o,r,i,u){var a=t.fold((function(){var n=UG(e,i.left,i.top),t=PG(n,o,r);return YG(t.left,t.top)}),(function(t){var u=ZG(n,t,e,i,o,r);return u.extra.each((function(e){t.onSensor(n,e)})),u.coord}));return vX(n,a,o,r,u)},bX=function(n,t,e,o){var r=t.getTarget(n.element);if(t.repositionTarget){var i=Li(n.element),u=Wc(i),a=mj(r),c=pX(r),s=hX(n,t.snaps,c,u,a,o,e),f=jG(s,u,a);$a(r,f)}t.onDrag(n,r,o)},yX=function(n,t){return{bounds:n.getBounds(),height:Cc(t.element),width:Rc(t.element)}},xX=function(n,t,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return yX(t,n)}));i.each((function(e){bX(n,t,u,e)}))},wX=function(n,t,e,o){t.each(lX),e.snaps.each((function(t){nX(n,t)}));var r=e.getTarget(n.element);o.reset(),e.onDrop(n,r)},SX=function(n){return function(t,e){var o=function(n){e.setStartData(yX(t,n))};return vi(D([xi(Qr(),(function(n){e.getStartData().each((function(){return o(n)}))}))],n(t,e,o)))}},kX=function(n){return vi([xi(kr(),n.forceDrop),xi(_r(),n.drop),xi(Cr(),(function(t,e){n.move(e.event)})),xi(Or(),n.delayDrop)])},CX=function(n){return R.from(Tc(n.x,n.y))},OX=function(n,t){return Tc(t.left-n.left,t.top-n.top)},_X=Object.freeze({__proto__:null,getData:CX,getDelta:OX}),TX=function(n,t,e){return[xi(kr(),(function(o,r){var i=r.event.raw;if(0===i.button){r.stop();var u=function(){return wX(o,R.some(s),n,t)},a=hT(u,200),c={drop:u,delayDrop:a.schedule,forceDrop:u,move:function(e){a.cancel(),xX(o,n,t,_X,e)}},s=dX(o,n.blockerClass,kX(c)),f=function(){e(o),fX(o,s)};f()}}))]},EX=D(gX,[js("dragger",{handlers:SX(TX)})]),DX=function(n){return vi([xi(yr(),n.forceDrop),xi(wr(),n.drop),xi(Sr(),n.drop),xi(xr(),(function(t,e){n.move(e.event)}))])},BX=function(n){var t=n[0];return R.some(Tc(t.clientX,t.clientY))},AX=function(n){var t=n.raw,e=t.touches;return 1===e.length?BX(e):R.none()},MX=function(n,t){return Tc(t.left-n.left,t.top-n.top)},FX=Object.freeze({__proto__:null,getData:AX,getDelta:MX}),IX=function(n,t,e){var o=Ke(R.none());return[xi(yr(),(function(r,i){i.stop();var u=function(){wX(r,o.get(),n,t),o.set(R.none())},a={drop:u,delayDrop:p,forceDrop:u,move:function(e){xX(r,n,t,FX,e)}},c=dX(r,n.blockerClass,DX(a));o.set(R.some(c));var s=function(){e(r),fX(r,c)};s()})),xi(xr(),(function(e,o){o.stop(),xX(e,n,t,FX,o.event)})),xi(wr(),(function(e,r){r.stop(),wX(e,o.get(),n,t),o.set(R.none())})),xi(Sr(),(function(e){wX(e,o.get(),n,t),o.set(R.none())}))]},RX=D(gX,[js("dragger",{handlers:SX(IX)})]),VX=function(n,t,e){return D(TX(n,t,e),IX(n,t,e))},PX=D(gX,[js("dragger",{handlers:SX(VX)})]),HX=EX,zX=RX,NX=PX,LX=Object.freeze({__proto__:null,mouse:HX,touch:zX,mouseOrTouch:NX}),jX=function(){var n=R.none(),t=R.none(),e=function(){n=R.none(),t=R.none()},o=function(t,e){var o=n.map((function(n){return t.getDelta(n,e)}));return n=R.some(e),o},r=function(n,t){return n.getData(t).bind((function(t){return o(n,t)}))},i=function(n){t=R.some(n)},u=function(){return t},a=y({});return ra({readState:a,reset:e,update:r,getStartData:u,setStartData:i})},UX=Object.freeze({__proto__:null,init:jX}),WX=Gf({branchKey:"mode",branches:LX,name:"dragging",active:{events:function(n,t){var e=n.dragger;return e.handlers(n,t)}},extra:{snap:function(n){return{sensor:n.sensor,range:n.range,output:n.output,extra:R.from(n.extra)}}},state:UX,apis:uX}),GX=40,XX=GX/2,YX=function(n,t,e,o,r,i){return n.fold((function(){return WX.snap({sensor:XG(e-XX,o-XX),range:Tc(r,i),output:XG(R.some(e),R.some(o)),extra:{td:t}})}),(function(n){var r=e-XX,i=o-XX,u=GX,a=GX,c=n.element.dom.getBoundingClientRect();return WX.snap({sensor:XG(r,i),range:Tc(u,a),output:XG(R.some(e-c.width/2),R.some(o-c.height/2)),extra:{td:t}})}))},qX=function(n,t,e){var o=function(n,t){return n.exists((function(n){return ir(n,t)}))};return{getSnapPoints:n,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(n,r){var i=r.td;o(t.get(),i)||(t.set(R.some(i)),e(i))},mustSnap:!0}},KX=function(n){return Qx($x.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Lf([WX.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:n}),SD.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},JX=function(n,t){var e=Ke([]),o=Ke([]),r=Ke(!1),i=Ke(R.none()),u=Ke(R.none()),a=function(n){var e=is(n);return YX(m.getOpt(t),n,e.x,e.y,e.width,e.height)},c=function(){return G(e.get(),(function(n){return a(n)}))},s=function(n){var e=is(n);return YX(g.getOpt(t),n,e.right,e.bottom,e.width,e.height)},f=function(){return G(o.get(),(function(n){return s(n)}))},l=qX(c,i,(function(t){u.get().each((function(e){n.fire("TableSelectorChange",{start:t,finish:e})}))})),d=qX(f,u,(function(t){i.get().each((function(e){n.fire("TableSelectorChange",{start:e,finish:t})}))})),m=KX(l),g=KX(d),p=yc(m.asSpec()),v=yc(g.asSpec()),h=function(t,e,o,r){var i=e.dom.getBoundingClientRect();oc(t.element,"display");var u=Wi(to.fromDom(n.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&Ka(t.element,"display","none")},b=function(n,t,e,o){var r=e(t);WX.snapTo(n,r);var i=function(n){return n[o]<0},u=function(n,t){return n[o]>t};h(n,t,i,u)},y=function(n){return b(p,n,a,"top")},x=function(){return i.get().each(y)},w=function(n){return b(v,n,s,"bottom")},S=function(){return u.get().each(w)};qo().deviceType.isTouch()&&(n.on("TableSelectionChange",(function(n){r.get()||(zm(t,p),zm(t,v),r.set(!0)),i.set(R.some(n.start)),u.set(R.some(n.finish)),n.otherCells.each((function(t){e.set(t.upOrLeftCells),o.set(t.downOrRightCells),y(n.start),w(n.finish)}))})),n.on("ResizeEditor ResizeWindow ScrollContent",(function(){x(),S()})),n.on("TableSelectionClear",(function(){r.get()&&(jm(p),jm(v),r.set(!1)),i.set(R.none()),u.set(R.none())})))},$X=function(n){if(1===n.nodeType){if("BR"===n.nodeName||n.getAttribute("data-mce-bogus"))return!0;if("bookmark"===n.getAttribute("data-mce-type"))return!0}return!1},QX=function(n,t,e){t.delimiter||(t.delimiter="»");var o=function(o){var r=o||[],i=G(r,(function(t,o){return $x.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:t.name},action:function(e){n.focus(),n.selection.select(t.element),n.nodeChanged()},buttonBehaviours:Lf([KC.button(e.isDisabled),WC()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+t.delimiter+" "}};return $(i.slice(1),(function(n,t){var e=n;return e.push(u),e.push(t),e}),[i[0]])},r=function(t){var e=[],o=t.length;while(o-- >0){var r=t[o];if(1===r.nodeType&&!$X(r)){var i=n.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Lf([ly.config({mode:"flow",selector:"div[role=button]"}),Jk.config({disabled:e.isDisabled}),WC(),nE.config({}),wy.config({}),ky("elementPathEvents",[Bi((function(t,e){n.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return ly.focusIn(t)})),n.on("NodeChange",(function(n){var e=r(n.parents);e.length>0?wy.set(t,o(e)):wy.set(t,[])}))}))])]),components:[]}};(function(n){n[n["None"]=0]="None",n[n["Both"]=1]="Both",n[n["Vertical"]=2]="Vertical"})($N||($N={}));var ZX=function(n,t,e,o,r){var i={};return i.height=dW(o+t.top,rC(n),uC(n)),e===$N.Both&&(i.width=dW(r+t.left,oC(n),iC(n))),i},nY=function(n,t,e){var o=to.fromDom(n.getContainer()),r=ZX(n,t,e,kc(o),Ic(o));An(r,(function(n,t){return Ka(o,t,lW(n))})),ZO(n)},tY=function(n){var t=!n.hasPlugin("autoresize"),e=n.getParam("resize",t);return!1===e?$N.None:"both"===e?$N.Both:$N.Vertical},eY=function(n,t,e,o){var r=20,i=Tc(e*r,o*r);return nY(n,i,t),R.some(!0)},oY=function(n,t){var e=tY(n);return e===$N.None?R.none():R.some({dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize")},innerHtml:nw("resize-handle",t.icons)},behaviours:Lf([WX.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,o,r){return nY(n,r,e)},blockerClass:"tox-blocker"}),ly.config({mode:"special",onLeft:function(){return eY(n,e,-1,0)},onRight:function(){return eY(n,e,1,0)},onUp:function(){return eY(n,e,0,-1)},onDown:function(){return eY(n,e,0,1)}}),nE.config({}),My.config({})])})},rY=function(n,t){var e,o=function(n,e,o){return wy.set(n,[vc(t.translate(["{0} "+o,e[o]]))])};return $x.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Lf([KC.button(t.isDisabled),WC(),nE.config({}),wy.config({}),Kg.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),ky("wordcount-events",[Fi((function(n){var t=Kg.getValue(n),e="words"===t.mode?"characters":"words";Kg.setValue(n,{mode:e,count:t.count}),o(n,t.count,e)})),Bi((function(t){n.on("wordCountUpdate",(function(n){var e=Kg.getValue(t).mode;Kg.setValue(t,{mode:e,count:n.wordCount}),o(t,n.wordCount,e)}))}))])]),eventOrder:(e={},e[Ur()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})},iY=function(n,t){var e=function(){var n=Ak.translate(["Powered by {0}","Tiny"]),t='<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+n+'">'+n+"</a>";return{dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:t}}},o=function(){var o=[];return n.getParam("elementpath",!0,"boolean")&&o.push(QX(n,{},t)),n.hasPlugin("wordcount")&&o.push(rY(n,t)),n.getParam("branding",!0,"boolean")&&o.push(e()),o.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:o}]:[]},r=function(){var e=o(),r=oY(n,t);return e.concat(r.toArray())};return{dom:{tag:"div",classes:["tox-statusbar"]},components:r()}},uY=function(n){var t,e=n.inline,o=e?wW:sW,r=EC(n)?iU:lj,i=R.none(),u=qo(),a=u.browser.isIE(),c=a?["tox-platform-ie"]:[],s=u.deviceType.isTouch(),f="tox-platform-touch",l=s?[f]:[],d=xC(n),m=_C(n),g=Ak.isRtl()?{attributes:{dir:"rtl"}}:{},v={attributes:(t={},t[Ll]=d?ws.BottomToTop:ws.TopToBottom,t)},h=function(){return i.bind(WU.getHeader)},b=function(){return r.isDocked(h)},y=function(){Ka(Q.element,"width",document.body.clientWidth+"px")},x=function(){var n=ir(Ga(),m)&&"grid"===Qa(m,"display"),t={dom:T({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(c).concat(l)},g),behaviours:Lf([Fm.config({useFixed:function(){return b()}})])},e={dom:{styles:{width:document.body.clientWidth+"px"}},events:vi([xi(Zr(),y)])};return Kn(t,n?e:{})},w=yc(x()),S=function(){return hn.value(w)},k=Qx({dom:{tag:"div",classes:["tox-anchorbar"]}}),C=function(){return i.bind((function(n){return k.getOpt(n)})).getOrDie("Could not find a anchor bar element")},O=function(){return i.bind((function(n){return WU.getToolbar(n)})).getOrDie("Could not find more toolbar element")},_=function(){return i.bind((function(n){return WU.getThrobber(n)})).getOrDie("Could not find throbber element")},E=lH(w,n,C),D=WU.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:E,onEscape:function(){n.focus()}}),B=vC(n),A=WU.parts.toolbar(T({dom:{tag:"div",classes:["tox-toolbar"]},getSink:S,providers:E.shared.providers,onEscape:function(){n.focus()},type:B,lazyToolbar:O,lazyHeader:function(){return h().getOrDie("Could not find header element")}},v)),M=WU.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:E.shared.providers,onEscape:function(){n.focus()},type:B}),F=WU.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),I=WU.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),V=WU.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:E}),P=n.getParam("statusbar",!0,"boolean"),H=P&&!e?R.some(iY(n,E.shared.providers)):R.none(),z={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[F,I]},N=gC(n),L=dC(n),j=lC(n),U=function(){return N?[M]:L?[A]:[]},W=WU.parts.header({dom:T({tag:"div",classes:["tox-editor-header"]},v),components:tn([j?[D]:[],U(),OC(n)?[]:[k.asSpec()]]),sticky:EC(n),editor:n,sharedBackstage:E.shared}),G=tn([d?[]:[W],e?[]:[z],d?[W]:[]]),X={dom:{tag:"div",classes:["tox-editor-container"]},components:G},Y=tn([[X],e?[]:H.toArray(),[V]]),q=TC(n),K=T(T({role:"application"},Ak.isRtl()?{dir:"rtl"}:{}),q?{"aria-hidden":"true"}:{}),J=yc(WU.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(d?["tox-tinymce--toolbar-bottom"]:[]).concat(l).concat(c),styles:T({visibility:"hidden"},q?{opacity:"0",border:"0"}:{}),attributes:K},components:Y,behaviours:Lf([WC(),Jk.config({disableClass:"tox-tinymce--disabled"}),ly.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}));i=R.some(J),n.shortcuts.add("alt+F9","focus menubar",(function(){WU.focusMenubar(J)})),n.shortcuts.add("alt+F10","focus toolbar",(function(){WU.focusToolbar(J)})),n.addCommand("ToggleToolbarDrawer",(function(){WU.toggleToolbarDrawer(J)})),n.addQueryStateHandler("ToggleToolbarDrawer",(function(){return WU.isToolbarDrawerToggled(J)}));var $=GT(J),Q=GT(w);QL(n,$,Q);var Z=function(){var n={broadcastAll:Q.broadcast,broadcastOn:Q.broadcastOn,register:p};return{channels:n}},nn=function(){var t=lW(gW(n)),e=lW(vW(n));return n.inline||(ec("div","width",e)&&Ka(J.element,"width",e),ec("div","height",t)?Ka(J.element,"height",t):Ka(J.element,"height","200px")),t},en=function(){r.setup(n,E.shared,h),QW(n,E),MG(n,S,E),bU(n),IU(n,_,E.shared),Mn(bC(n),(function(t,e){n.ui.registry.addGroupToolbarButton(e,t)}));var t=n.ui.registry.getAll(),e=t.buttons,i=t.menuItems,u=t.contextToolbars,a=t.sidebars,c=mC(n),s={menuItems:i,menus:BC(n),menubar:AC(n),toolbar:c.getOrThunk((function(){return MC(n)})),allowToolbarGroups:B===aS.floating,buttons:e,sidebar:a};$L(n,u,w,{backstage:E}),JX(n,w);var f=n.getElement(),l=nn(),d={mothership:$,uiMothership:Q,outerContainer:J},m={targetNode:f,height:l};return o.render(n,d,s,E,m)};return{mothership:$,uiMothership:Q,backstage:E,renderUI:en,getUi:Z}},aY=function(n,t){var e=R.from(Ou(n,"id")).fold((function(){var n=Pu("dialog-describe");return ku(t,"id",n),n}),x);ku(n,"aria-describedby",e)},cY=function(n,t){var e=_u(n,"id").fold((function(){var n=Pu("dialog-label");return ku(t,"id",n),n}),x);ku(n,"aria-labelledby",e)},sY=y([ye("lazySink"),Be("dragBlockClass"),We("getBounds",us),He("useTabstopAt",O),He("eventOrder",{}),Jg("modalBehaviours",[ly]),zs("onExecute"),Ls("onEscape")]),fY={sketch:x},lY=y([Bp({name:"draghandle",overrides:function(n,t){return{behaviours:Lf([WX.config({mode:"mouse",getTarget:function(n){return ms(n,'[role="dialog"]').getOr(n)},blockerClass:n.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:n.getDragBounds})])}}}),Ep({schema:[ye("dom")],name:"title"}),Ep({factory:fY,schema:[ye("dom")],name:"close"}),Ep({factory:fY,schema:[ye("dom")],name:"body"}),Bp({factory:fY,schema:[ye("dom")],name:"footer"}),Dp({factory:{sketch:function(n,t){return T(T({},n),{dom:t.dom,components:t.components})}},schema:[He("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),He("components",[])],name:"blocker"})]),dY=function(n,t,e,o){ku(n.element,"aria-busy",!0);var r=t.getRoot(n).getOr(n),i=Lf([ly.config({mode:"special",onTab:function(){return R.some(!0)},onShiftTab:function(){return R.some(!0)}}),My.config({})]),u=o(r,i),a=r.getSystem().build(u);wy.append(r,xc(a)),a.hasConfigured(ly)&&ly.focusIn(a),e.isBlocked()||t.onBlock(n),e.blockWith((function(){return wy.remove(r,a)}))},mY=function(n,t,e){Eu(n.element,"aria-busy"),e.isBlocked()&&t.onUnblock(n),e.clear()},gY=Object.freeze({__proto__:null,block:dY,unblock:mY}),pY=[We("getRoot",R.none),Hs("onBlock"),Hs("onUnblock")],vY=function(){var n=SL(),t=function(t){n.set({destroy:t})};return ra({readState:n.isSet,blockWith:t,clear:n.clear,isBlocked:n.isSet})},hY=Object.freeze({__proto__:null,init:vY}),bY=Uf({fields:pY,name:"blocking",apis:gY,state:hY}),yY=function(n,t,e,o){var r,i=Ke(R.none()),u=function(t){i.set(R.some(t));var e=n.lazySink(t).getOrDie(),r=o.blocker(),u=e.getSystem().build(T(T({},r),{components:r.components.concat([xc(t)]),behaviours:Lf([My.config({}),ky("dialog-blocker-events",[Di(Er(),(function(){ly.focusIn(t)}))])])}));zm(e,u),ly.focusIn(t)},a=function(n){i.set(R.none()),Gi(n.element).each((function(t){n.getSystem().getByDom(t).each((function(n){jm(n)}))}))},c=function(t){return Wp(t,n,"body")},s=function(t){return Wp(t,n,"footer")},f=function(n,t){bY.block(n,t)},l=function(n){bY.unblock(n)},d=Pu("modal-events"),m=T(T({},n.eventOrder),(r={},r[ni()]=[d].concat(n.eventOrder["alloy.system.attached"]||[]),r));return{uid:n.uid,dom:n.dom,components:t,apis:{show:u,hide:a,getBody:c,getFooter:s,setIdle:l,setBusy:f},eventOrder:m,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Qg(n.modalBehaviours,[wy.config({}),ly.config({mode:"cyclic",onEnter:n.onExecute,onEscape:n.onEscape,useTabstopAt:n.useTabstopAt}),bY.config({getRoot:i.get}),ky(d,[Bi((function(t){cY(t.element,Wp(t,n,"title").element),aY(t.element,Wp(t,n,"body").element)}))])])}},xY=cv({name:"ModalDialog",configFields:sY(),partFields:lY(),factory:yY,apis:{show:function(n,t){n.show(t)},hide:function(n,t){n.hide(t)},getBody:function(n,t){return n.getBody(t)},getFooter:function(n,t){return n.getFooter(t)},setBusy:function(n,t,e){n.setBusy(t,e)},setIdle:function(n,t){n.setIdle(t)}}}),wY=zt([Se("type"),Se("name")].concat(ZS)),SY=ge,kY=[Yt("name","name",ot((function(){return Pu("button-name")})),me),Fe("icon"),je("align","end",["start","end"]),Ue("primary",!1),Ue("disabled",!1)],CY=D(kY,[Se("text")]),OY=D([ke("type",["submit","cancel","custom"])],CY),_Y=D([ke("type",["menu"]),Fe("text"),Fe("tooltip"),Fe("icon"),De("items",wY)],kY),TY=ce("type",{submit:OY,cancel:OY,custom:OY,menu:_Y}),EY=[Se("type"),Se("text"),ke("level",["info","warn","error","success"]),Se("icon"),He("url","")],DY=zt(EY),BY=function(n){return[Se("type"),n]},AY=[Se("type"),Se("text"),Ue("disabled",!1),Ue("primary",!1),Yt("name","name",ot((function(){return Pu("button-name")})),me),Fe("icon"),Ue("borderless",!1)],MY=zt(AY),FY=[Se("type"),Se("name"),Se("label"),Ue("disabled",!1)],IY=zt(FY),RY=ge,VY=[Se("type"),Se("name")],PY=VY.concat([Fe("label")]),HY=PY.concat([He("columns","auto")]),zY=zt(HY),NY=$t([Se("value"),Se("text"),Se("icon")]),LY=PY,jY=zt(LY),UY=me,WY=PY,GY=zt(WY),XY=me,YY=VY.concat([Le("tag","textarea"),Se("scriptId"),Se("scriptUrl"),Ge("settings",void 0)]),qY=VY.concat([Le("tag","textarea"),Oe("init")]),KY=ne((function(n){return oe("customeditor.old",Ht(qY),n).orThunk((function(){return oe("customeditor.new",Ht(YY),n)}))})),JY=me,$Y=PY,QY=zt($Y),ZY=Qt(),nq=function(n){return[Se("type"),we("columns"),n]},tq=[Se("type"),Se("html"),je("presets","presentation",["presentation","document"])],eq=zt(tq),oq=PY.concat([Ue("sandboxed",!0)]),rq=zt(oq),iq=me,uq=PY.concat([xe("currentState",zt([ye("blob"),Se("url")]))]),aq=zt(uq),cq=PY.concat([Fe("inputMode"),Fe("placeholder"),Ue("maximized",!1),Ue("disabled",!1)]),sq=zt(cq),fq=me,lq=function(n){return[Se("type"),Se("label"),n]},dq=[Se("text"),Se("value")],mq=[Se("text"),De("items",se("items",(function(){return gq})))],gq=Lt([zt(dq),zt(mq)]),pq=PY.concat([De("items",gq),Ue("disabled",!1)]),vq=zt(pq),hq=me,bq=PY.concat([Ee("items",[Se("text"),Se("value")]),Ne("size",1),Ue("disabled",!1)]),yq=zt(bq),xq=me,wq=PY.concat([Ue("constrain",!0),Ue("disabled",!1)]),Sq=zt(wq),kq=zt([Se("width"),Se("height")]),Cq=[Se("type"),De("header",me),De("cells",Nt(me))],Oq=zt(Cq),_q=PY.concat([Fe("placeholder"),Ue("maximized",!1),Ue("disabled",!1)]),Tq=zt(_q),Eq=me,Dq=PY.concat([je("filetype","file",["image","media","file"]),He("disabled",!1)]),Bq=zt(Dq),Aq=zt([Se("value"),He("meta",{})]),Mq=function(n){return Yt("items","items",tt(),Nt(ne((function(t){return oe("Checking item of "+n,Fq,t).fold((function(n){return hn.error(ue(n))}),(function(n){return hn.value(n)}))}))))},Fq=Zt((function(){return ae("type",{alertbanner:DY,bar:zt(BY(Mq("bar"))),button:MY,checkbox:IY,colorinput:jY,colorpicker:GY,dropzone:QY,grid:zt(nq(Mq("grid"))),iframe:rq,input:sq,listbox:vq,selectbox:yq,sizeinput:Sq,textarea:Tq,urlinput:Bq,customeditor:KY,htmlpanel:eq,imagetools:aq,collection:zY,label:zt(lq(Mq("label"))),table:Oq,panel:Rq})})),Iq=[Se("type"),He("classes",[]),De("items",Fq)],Rq=zt(Iq),Vq=[Yt("name","name",ot((function(){return Pu("tab-name")})),me),Se("title"),De("items",Fq)],Pq=[Se("type"),Ee("tabs",Vq)],Hq=zt(Pq),zq=CY,Nq=TY,Lq=zt([Se("title"),xe("body",ae("type",{panel:Rq,tabpanel:Hq})),Le("size","normal"),De("buttons",Nq),He("initialData",{}),We("onAction",p),We("onChange",p),We("onSubmit",p),We("onClose",p),We("onCancel",p),He("onTabChange",p)]),jq=function(n){return oe("dialog",Lq,n)},Uq=zt(D([ke("type",["cancel","custom"])],zq)),Wq=zt([Se("title"),Se("url"),Me("height"),Me("width"),Re("buttons",Uq),We("onAction",p),We("onCancel",p),We("onClose",p),We("onMessage",p)]),Gq=function(n){return oe("dialog",Wq,n)},Xq=function(n){return u(n)?[n].concat(en(zn(n),Xq)):a(n)?en(n,Xq):[]},Yq=function(n){return i(n.type)&&i(n.name)},qq={checkbox:RY,colorinput:UY,colorpicker:XY,dropzone:ZY,input:fq,iframe:iq,sizeinput:kq,selectbox:xq,listbox:hq,size:kq,textarea:Eq,urlinput:Aq,customeditor:JY,collection:NY,togglemenuitem:SY},Kq=function(n){return R.from(qq[n.type])},Jq=function(n){return K(Xq(n),Yq)},$q=function(n){var t=Jq(n),e=en(t,(function(n){return Kq(n).fold((function(){return[]}),(function(t){return[xe(n.name,t)]}))}));return zt(e)},Qq=function(n){var t=re(jq(n)),e=$q(n),o=n.initialData;return{internalDialog:t,dataValidator:e,initialData:o}},Zq={open:function(n,t){var e=Qq(t);return n(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(n,t){var e=re(Gq(t));return n(e)},redial:function(n){return Qq(n)}},nK=function(n){var t=[],e={};return An(n,(function(n,o){n.fold((function(){t.push(o)}),(function(n){e[o]=n}))})),t.length>0?hn.error(t):hn.value(e)},tK=function(n,t){var e=Qx(bM.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:G(n.items,(function(n){return qV(e,n,t)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[e.asSpec()]}],behaviours:Lf([ly.config({mode:"acyclic",useTabstopAt:S(eF)}),DM.memento(e),GM.memento(e,{postprocess:function(n){return nK(n).fold((function(n){return{}}),(function(n){return n}))}})])}},eK=function(n,t){return{uid:n.uid,dom:n.dom,components:n.components,events:Zy(n.action),behaviours:Qg(n.tabButtonBehaviours,[My.config({}),ly.config({mode:"execution",useSpace:!0,useEnter:!0}),Kg.config({store:{mode:"memory",initialValue:n.value}})]),domModification:n.domModification}},oK=av({name:"TabButton",configFields:[He("uid",void 0),ye("value"),Yt("dom","dom",rt((function(){return{attributes:{role:"tab",id:Pu("aria"),"aria-selected":"false"}}})),fe()),Be("action"),He("domModification",{}),Jg("tabButtonBehaviours",[My,ly,Kg]),ye("view")],factory:eK}),rK=y([ye("tabs"),ye("dom"),He("clickToDismiss",!1),Jg("tabbarBehaviours",[zv,ly]),Vs(["tabClass","selectedClass"])]),iK=Ap({factory:oK,name:"tabs",unit:"tab",overrides:function(n){var t=function(n,t){zv.dehighlight(n,t),li(n,ai(),{tabbar:n,button:t})},e=function(n,t){zv.highlight(n,t),li(n,ui(),{tabbar:n,button:t})};return{action:function(o){var r=o.getSystem().getByUid(n.uid).getOrDie(),i=zv.isHighlighted(r,o),u=function(){return i&&n.clickToDismiss?t:i?p:e}();u(r,o)},domModification:{classes:[n.markers.tabClass]}}}}),uK=y([iK]),aK=function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Qg(n.tabbarBehaviours,[zv.config({highlightClass:n.markers.selectedClass,itemClass:n.markers.tabClass,onHighlight:function(n,t){ku(t.element,"aria-selected","true")},onDehighlight:function(n,t){ku(t.element,"aria-selected","false")}}),ly.config({mode:"flow",getInitial:function(n){return zv.getHighlighted(n).map((function(n){return n.element}))},selector:"."+n.markers.tabClass,executeOnMove:!0})])}},cK=cv({name:"Tabbar",configFields:rK(),partFields:uK(),factory:aK}),sK=function(n,t){return{uid:n.uid,dom:n.dom,behaviours:Qg(n.tabviewBehaviours,[wy.config({})]),domModification:{attributes:{role:"tabpanel"}}}},fK=av({name:"Tabview",configFields:[Jg("tabviewBehaviours",[wy])],factory:sK}),lK=y([He("selectFirst",!0),Hs("onChangeTab"),Hs("onDismissTab"),He("tabs",[]),Jg("tabSectionBehaviours",[])]),dK=Ep({factory:cK,schema:[ye("dom"),Te("markers",[ye("tabClass"),ye("selectedClass")])],name:"tabbar",defaults:function(n){return{tabs:n.tabs}}}),mK=Ep({factory:fK,name:"tabview"}),gK=y([dK,mK]),pK=function(n,t,e,o){var r=function(t){var e=Kg.getValue(t);Up(t,n,"tabview").each((function(o){var r=Z(n.tabs,(function(n){return n.value===e}));r.each((function(e){var r=e.view();_u(t.element,"id").each((function(n){ku(o.element,"aria-labelledby",n)})),wy.set(o,r),n.onChangeTab(o,t,r)}))}))},i=function(t,e){Up(t,n,"tabbar").each((function(n){e(n).each(di)}))};return{uid:n.uid,dom:n.dom,components:t,behaviours:$g(n.tabSectionBehaviours),events:vi(tn([n.selectFirst?[Bi((function(n,t){i(n,zv.getFirst)}))]:[],[xi(ui(),(function(n,t){var e=t.event.button;r(e)})),xi(ai(),(function(t,e){var o=e.event.button;n.onDismissTab(t,o)}))]])),apis:{getViewItems:function(t){return Up(t,n,"tabview").map((function(n){return wy.contents(n)})).getOr([])},showTab:function(n,t){var e=function(n){var e=zv.getCandidates(n),o=Z(e,(function(n){return Kg.getValue(n)===t}));return o.filter((function(t){return!zv.isHighlighted(n,t)}))};i(n,e)}}}},vK=cv({name:"TabSection",configFields:lK(),partFields:gK(),factory:pK,apis:{getViewItems:function(n,t){return n.getViewItems(t)},showTab:function(n,t,e){n.showTab(t,e)}}}),hK=function(n,t,e){return G(n,(function(o,r){wy.set(e,n[r].view());var i=t.dom.getBoundingClientRect();return wy.set(e,[]),i.height}))},bK=function(n){return fn(cn(n,(function(n,t){return n>t?-1:n<t?1:0})))},yK=function(n,t,e){var o,r=Ui(n).dom,i=ms(n,".tox-dialog-wrap").getOr(n),u="fixed"===Qa(i,"position");o=u?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);var a=kc(t),c=t.dom.offsetLeft>=e.dom.offsetLeft+Ic(e),s=c?Math.max(kc(e),a):a,f=parseInt(Qa(n,"margin-top"),10)||0,l=parseInt(Qa(n,"margin-bottom"),10)||0,d=kc(n)+f+l,m=d-s;return o-m},xK=function(n,t){fn(n).each((function(n){return vK.showTab(t,n.value)}))},wK=function(n,t){Ka(n,"height",t+"px"),qo().browser.isIE()?oc(n,"flex-basis"):Ka(n,"flex-basis",t+"px")},SK=function(n,t,e){ms(n,'[role="dialog"]').each((function(n){gs(n,'[role="tablist"]').each((function(o){e.get().map((function(e){return Ka(t,"height","0"),Ka(t,"flex-basis","0"),Math.min(e,yK(n,t,o))})).each((function(n){wK(t,n)}))}))}))},kK=function(n){return gs(n,'[role="tabpanel"]')},CK=function(n){var t=function(){var t=Ke(R.none()),e=[Bi((function(e){var o=e.element;kK(o).each((function(r){Ka(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){var o=hK(n,r,e),i=bK(o);t.set(i)})),SK(o,r,t),oc(r,"visibility"),xK(n,e),Kx.requestAnimationFrame((function(){SK(o,r,t)}))}))})),xi(Zr(),(function(n){var e=n.element;kK(e).each((function(n){SK(e,n,t)}))})),xi(vE,(function(n,e){var o=n.element;kK(o).each((function(n){var e=nl(tu(n));Ka(n,"visibility","hidden");var r=nc(n,"height").map((function(n){return parseInt(n,10)}));oc(n,"height"),oc(n,"flex-basis");var i=n.dom.getBoundingClientRect().height,u=r.forall((function(n){return i>n}));u?(t.set(R.from(i)),SK(o,n,t)):r.each((function(t){wK(n,t)})),oc(n,"visibility"),e.each($f)}))}))],o=!1;return{extraEvents:e,selectFirst:o}}(),e=function(){var n=[],t=!0;return{extraEvents:n,selectFirst:t}}();return{smartTabHeight:t,naiveTabHeight:e}},OK="send-data-to-section",_K="send-data-to-view",TK=function(n,t){var e=Ke({}),o=function(n){var t=Kg.getValue(n),o=nK(t).getOr({}),r=e.get(),i=Kn(r,o);e.set(i)},r=function(n){var t=e.get();Kg.setValue(n,t)},i=Ke(null),u=G(n.tabs,(function(n){return{value:n.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:t.shared.providers.translate(n.title)},view:function(){return[bM.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:G(n.items,(function(n){return qV(e,n,t)})),formBehaviours:Lf([ly.config({mode:"acyclic",useTabstopAt:S(eF)}),ky("TabView.form.events",[Bi(r),Ai(o)]),Yf.config({channels:lt([{key:OK,value:{onReceive:o}},{key:_K,value:{onReceive:r}}])})])}}))]}}})),a=CK(u).smartTabHeight;return vK.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(n,t,e){var o=Kg.getValue(t);li(n,pE,{name:o,oldName:i.get()}),i.set(o)},tabs:u,components:[vK.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[cK.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Lf([nE.config({})])}),vK.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:Lf([ky("tabpanel",a.extraEvents),ly.config({mode:"acyclic"}),yv.config({find:function(n){return fn(vK.getViewItems(n))}}),Kg.config({store:{mode:"manual",getValue:function(n){return n.getSystem().broadcastOn([OK],{}),e.get()},setValue:function(n,t){e.set(t),n.getSystem().broadcastOn([_K],{})}}})])})},EK=Pu("update-dialog"),DK=Pu("update-title"),BK=Pu("update-body"),AK=Pu("update-footer"),MK=Pu("body-send-message"),FK=function(n,t,e,o){var r=function(n){switch(n.body.type){case"tabpanel":return[TK(n.body,e)];default:return[tK(n.body,e)]}},i=function(n,t){return R.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},u={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:T(T({},t.map((function(n){return{id:n}})).getOr({})),o?u:{})},components:[],behaviours:Lf([DM.childAt(0),nN.config({channel:BK,updateState:i,renderComponents:r,initialData:n})])}},IK=function(n,t,e,o){return FK(n,R.some(t),e,o)},RK=function(n,t){var e=FK(n,R.none(),t,!1);return xY.parts.body(e)},VK=function(n){var t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[ZM({dom:{tag:"iframe",attributes:{src:n.url}},behaviours:Lf([nE.config({}),My.config({})])})]}],behaviours:Lf([ly.config({mode:"acyclic",useTabstopAt:S(eF)})])};return xY.parts.body(t)},PK=rO.deviceType.isTouch(),HK=function(n,t){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[n,t]}},zK=function(n,t){return xY.parts.close($x.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:n,buttonBehaviours:Lf([nE.config({})])}))},NK=function(){return xY.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},LK=function(n,t){return xY.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:BU("<p>"+t.translate(n)+"</p>")}]}]})},jK=function(n){return xY.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:n})},UK=function(n,t){return[WT.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:n}),WT.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]},WK=function(n){var t,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return xY.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),R.some(!0)},useTabstopAt:function(n){return!eF(n)},dom:{tag:"div",classes:[e].concat(n.extraClasses),styles:T({position:"relative"},n.extraStyles)},components:D([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:BU('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:PK?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:Lf(D([My.config({}),ky("dialog-events",n.dialogEvents.concat([Di(Er(),(function(n,t){ly.focusIn(n)}))])),ky("scroll-lock",[Bi((function(){Pa(Ga(),i)})),Ai((function(){za(Ga(),i)}))])],n.extraBehaviours)),eventOrder:T((t={},t[Ur()]=["dialog-events"],t[ni()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[ti()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),n.eventOrder)})},GK=function(n){return $x.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close"),title:n.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:nw("close",n.icons)}}],action:function(n){fi(n,fE)}})},XK=function(n,t,e){var o=function(n){return[vc(e.translate(n.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:T({},t.map((function(n){return{id:n}})).getOr({}))},components:o(n),behaviours:Lf([nN.config({channel:DK,renderComponents:o})])}},YK=function(){return{dom:BU('<div class="tox-dialog__draghandle"></div>')}},qK=function(n,t,e){return WT.sketch({dom:BU('<div class="tox-dialog__header"></div>'),components:[XK(n,R.some(t),e),YK(),GK(e)],containerBehaviours:Lf([WX.config({mode:"mouse",blockerClass:"blocker",getTarget:function(n){return ps(n,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])})},KK=function(n,t){var e=xY.parts.title(XK(n,R.none(),t)),o=xY.parts.draghandle(YK()),r=xY.parts.close(GK(t)),i=[e].concat(n.draggable?[o]:[]).concat([r]);return WT.sketch({dom:BU('<div class="tox-dialog__header"></div>'),components:i})},JK=function(n,t){return KK({title:t.shared.providers.translate(n),draggable:t.dialog.isDraggableModal()},t.shared.providers)},$K=function(n,t,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(n)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:BU('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},QK=function(n,t,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){xY.setBusy(n(),(function(n,o){return $K(e.message,o,t)}))},onUnblock:function(){xY.setIdle(n())}}},ZK=function(n,t,e,o){var r,i=function(n,t){return R.some(t)};return yc(WK(T(T({},n),{lazySink:o.shared.getSink,extraBehaviours:D([nN.config({channel:EK,updateState:i,initialData:t}),GM.memory({})],n.extraBehaviours),onEscape:function(n){fi(n,fE)},dialogEvents:e,eventOrder:(r={},r[jr()]=[nN.name(),Yf.name()],r[ni()]=["scroll-lock",nN.name(),"messages","dialog-events","alloy.base.behaviour"],r[ti()]=["alloy.base.behaviour","dialog-events","messages",nN.name(),"scroll-lock"],r)})))},nJ=function(n){var t=function(n){var t=G(n.items,(function(n){var t=Ke(!1);return T(T({},n),{storage:t})}));return T(T({},n),{items:t})};return G(n,(function(n){return"menu"===n.type?t(n):n}))},tJ=function(n){return $(n,(function(n,t){if("menu"===t.type){var e=t;return $(e.items,(function(n,t){return n[t.name]=t.storage,n}),n)}return n}),{})},eJ=function(n,t){return[_i(Er(),tF),n(sE,(function(n,e){t.onClose(),e.onClose()})),n(fE,(function(n,t,e,o){t.onCancel(n),fi(o,sE)})),xi(gE,(function(n,e){return t.onUnblock()})),xi(mE,(function(n,e){return t.onBlock(e.event)}))]},oJ=function(n,t){var e=function(t,e){return xi(t,(function(t,r){o(t,(function(o,i){e(n(),o,r.event,t)}))}))},o=function(n,t){nN.getState(n).get().each((function(e){t(e,n)}))};return D(eJ(e,t),[e(lE,(function(n,t,e){t.onAction(n,{name:e.name})}))])},rJ=function(n,t,e){var o=function(t,e){return xi(t,(function(t,o){r(t,(function(r,i){e(n(),r,o.event,t)}))}))},r=function(n,t){nN.getState(n).get().each((function(e){t(e.internalDialog,n)}))};return D(eJ(o,t),[o(dE,(function(n,t){return t.onSubmit(n)})),o(cE,(function(n,t,e){t.onChange(n,{name:e.name})})),o(lE,(function(n,t,o,r){var i=function(){return ly.focusIn(r)},u=function(n){return Tu(n,"disabled")||_u(n,"aria-disabled").exists((function(n){return"true"===n}))},a=tu(r.element),c=nl(a);t.onAction(n,{name:o.name,value:o.value}),nl(a).fold(i,(function(n){u(n)||c.exists((function(t){return cr(n,t)&&u(t)}))?i():e().toOptional().filter((function(t){return!cr(t.element,n)})).each(i)}))})),o(pE,(function(n,t,e){t.onTabChange(n,{newTabName:e.name,oldTabName:e.oldName})})),Ai((function(t){var e=n();Kg.setValue(t,e.getData())}))])},iJ={initUrlDialog:oJ,initDialog:rJ},uJ=function(n,t){return WI(n,n.type,t)},aJ=function(n,t,e){return Z(t,(function(n){return n.name===e})).bind((function(t){return t.memento.getOpt(n)}))},cJ=function(n,t){var e=t.map((function(n){return n.footerButtons})).getOr([]),o=q(e,(function(n){return"start"===n.align})),r=function(n,t){return WT.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+n]},components:G(t,(function(n){return n.memento.asSpec()}))})},i=r("start",o.pass),u=r("end",o.fail);return[i,u]},sJ=function(n,t){var e=function(n,e){var o=G(e.buttons,(function(n){var e=Qx(uJ(n,t));return{name:n.name,align:n.align,memento:e}})),r=function(n,t){return aJ(n,o,t)};return R.some({lookupByName:r,footerButtons:o})};return{dom:BU('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Lf([nN.config({channel:AK,initialData:n,updateState:e,renderComponents:cJ})])}},fJ=function(n,t){return sJ(n,t)},lJ=function(n,t){return xY.parts.footer(sJ(n,t))},dJ=function(n,t){var e=n.getRoot();if(e.getSystem().isConnected()){var o=yv.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper());return bM.getField(o,t).fold((function(){var e=n.getFooter(),r=nN.getState(e);return r.get().bind((function(n){return n.lookupByName(o,t)}))}),(function(n){return R.some(n)}))}return R.none()},mJ=function(n,t){var e=n.getRoot();return nN.getState(e).get().map((function(n){return re(oe("data",n.dataValidator,t))})).getOr(t)},gJ=function(n,t,e){var o=function(t){var e=n.getRoot();e.getSystem().isConnected()&&t(e)},r=function(){var t=n.getRoot(),o=t.getSystem().isConnected()?n.getFormWrapper():t,r=Kg.getValue(o),i=Mn(e,(function(n){return n.get()}));return T(T({},r),i)},u=function(t){o((function(o){var r=p.getData(),i=T(T({},r),t),u=mJ(n,i),a=n.getFormWrapper();Kg.setValue(a,u),An(e,(function(n,t){Ln(i,t)&&n.set(i[t])}))}))},a=function(t){dJ(n,t).each(Jk.disable)},c=function(t){dJ(n,t).each(Jk.enable)},s=function(t){dJ(n,t).each(My.focus)},f=function(n){if(!i(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(t){li(t,mE,{message:n})}))},l=function(){o((function(n){fi(n,gE)}))},d=function(t){o((function(e){var o=n.getBody(),r=nN.getState(o);r.get().exists((function(n){return n.isTabPanel()}))&&yv.getCurrent(o).each((function(n){vK.showTab(n,t)}))}))},m=function(n){o((function(e){var o=t(n);e.getSystem().broadcastOn([EK],o),e.getSystem().broadcastOn([DK],o.internalDialog),e.getSystem().broadcastOn([BK],o.internalDialog),e.getSystem().broadcastOn([AK],o.internalDialog),p.setData(o.initialData)}))},g=function(){o((function(n){fi(n,sE)}))},p={getData:r,setData:u,disable:a,enable:c,focus:s,block:f,unblock:l,showTab:d,redial:m,close:g};return p},pJ=function(n){switch(n){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}},vJ=function(n,t,e){var o=JK(n.internalDialog.title,e),r=RK({body:n.internalDialog.body},e),i=nJ(n.internalDialog.buttons),u=tJ(i),a=lJ({buttons:i},e),c=iJ.initDialog((function(){return m}),QK((function(){return l}),e.shared.providers,t),e.shared.getSink),s=pJ(n.internalDialog.size),f={header:o,body:r,footer:R.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=ZK(f,n,c,e),d=function(){var n=function(){var n=xY.getBody(l);return yv.getCurrent(n).getOr(n)};return{getRoot:function(){return l},getBody:function(){return xY.getBody(l)},getFooter:function(){return xY.getFooter(l)},getFormWrapper:n}}(),m=gJ(d,t.redial,u);return{dialog:l,instanceApi:m}},hJ=function(n,t,e,o){var r,i,u=Pu("dialog-label"),a=Pu("dialog-content"),c=function(n,t){return R.some(t)},s=Qx(qK({title:n.internalDialog.title,draggable:!0},u,e.shared.providers)),f=Qx(IK({body:n.internalDialog.body},a,e,o)),l=nJ(n.internalDialog.buttons),d=tJ(l),m=Qx(fJ({buttons:l},e)),g=iJ.initDialog((function(){return v}),{onBlock:function(n){bY.block(p,(function(t,o){return $K(n.message,o,e.shared.providers)}))},onUnblock:function(){bY.unblock(p)},onClose:function(){return t.closeWindow()}},e.shared.getSink),p=yc({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=u,r["aria-describedby"]=""+a,r)},eventOrder:(i={},i[jr()]=[nN.name(),Yf.name()],i[Ur()]=["execute-on-form"],i[ni()]=["reflecting","execute-on-form"],i),behaviours:Lf([ly.config({mode:"cyclic",onEscape:function(n){return fi(n,sE),R.some(!0)},useTabstopAt:function(n){return!eF(n)&&("button"!==Ii(n)||"disabled"!==Ou(n,"disabled"))}}),nN.config({channel:EK,updateState:c,initialData:n}),My.config({}),ky("execute-on-form",g.concat([Di(Er(),(function(n,t){ly.focusIn(n)}))])),bY.config({getRoot:function(){return R.some(p)}}),wy.config({}),GM.memory({})]),components:[s.asSpec(),f.asSpec(),m.asSpec()]}),v=gJ({getRoot:function(){return p},getFooter:function(){return m.get(p)},getBody:function(){return f.get(p)},getFormWrapper:function(){var n=f.get(p);return yv.getCurrent(n).getOr(n)}},t.redial,d);return{dialog:p,instanceApi:v}},bJ=tinymce.util.Tools.resolve("tinymce.util.URI"),yJ=function(n){var t=function(t){n.getSystem().isConnected()&&t(n)},e=function(n){if(!i(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t((function(t){li(t,mE,{message:n})}))},o=function(){t((function(n){fi(n,gE)}))},r=function(){t((function(n){fi(n,sE)}))},u=function(n){t((function(t){t.getSystem().broadcastOn([MK],n)}))};return{block:e,unblock:o,close:r,sendMessage:u}},xJ=["insertContent","setContent","execCommand","close","block","unblock"],wJ=function(n){return u(n)&&-1!==xJ.indexOf(n.mceAction)},SJ=function(n){return!wJ(n)&&u(n)&&Ln(n,"mceAction")},kJ=function(n,t,e){switch(e.mceAction){case"insertContent":n.insertContent(e.content);break;case"setContent":n.setContent(e.content);break;case"execCommand":var o=!!c(e.ui)&&e.ui;n.execCommand(e.cmd,o,e.value);break;case"close":t.close();break;case"block":t.block(e.message);break;case"unblock":t.unblock();break}},CJ=function(n,t,e,o){var r,i=JK(n.title,o),u=VK(n),a=n.buttons.bind((function(n){return 0===n.length?R.none():R.some(lJ({buttons:n},o))})),c=iJ.initUrlDialog((function(){return h}),QK((function(){return v}),o.shared.providers,t)),s=T(T({},n.height.fold((function(){return{}}),(function(n){return{height:n+"px","max-height":n+"px"}}))),n.width.fold((function(){return{}}),(function(n){return{width:n+"px","max-width":n+"px"}}))),f=n.width.isNone()&&n.height.isNone()?["tox-dialog--width-lg"]:[],l=new bJ(n.url,{base_uri:new bJ(window.location.href)}),d=l.protocol+"://"+l.host+(l.port?":"+l.port:""),m=Ke(R.none()),g=[ky("messages",[Bi((function(){var t=mT(to.fromDom(window),"message",(function(t){if(l.isSameOrigin(new bJ(t.raw.origin))){var o=t.raw.data;wJ(o)?kJ(e,h,o):SJ(o)&&n.onMessage(h,o)}}));m.set(R.some(t))})),Ai((function(){m.get().each((function(n){return n.unbind()}))}))]),Yf.config({channels:(r={},r[MK]={onReceive:function(n,t){gs(n.element,"iframe").each((function(n){var e=n.dom.contentWindow;e.postMessage(t,d)}))}},r)})],p={header:i,body:u,footer:a,extraClasses:f,extraBehaviours:g,extraStyles:s},v=ZK(p,n,c,o),h=yJ(v);return{dialog:v,instanceApi:h}},OJ=function(n){var t=n.backstage.shared,e=function(e,o){var r=function(){xY.hide(c),o()},i=Qx(WI({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:R.none()},"cancel",n.backstage)),u=NK(),a=zK(r,t.providers),c=yc(WK({lazySink:function(){return t.getSink()},header:HK(u,a),body:LK(e,t.providers),footer:R.some(jK(UK([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[xi(fE,r)],eventOrder:{}}));xY.show(c);var s=i.get(c);My.focus(s)};return{open:e}},_J=function(n){var t=n.backstage.shared,e=function(e,o){var r=function(n){xY.hide(s),o(n)},i=Qx(WI({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:R.none()},"submit",n.backstage)),u=WI({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:R.none()},"cancel",n.backstage),a=NK(),c=zK((function(){return r(!1)}),t.providers),s=yc(WK({lazySink:function(){return t.getSink()},header:HK(a,c),body:LK(e,t.providers),footer:R.some(jK(UK([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[xi(fE,(function(){return r(!1)})),xi(dE,(function(){return r(!0)}))],eventOrder:{}}));xY.show(s);var f=i.get(s);My.focus(f)};return{open:e}},TJ=function(n,t){return re(oe("data",t,n))},EJ=function(n){return vT(n,".tox-alert-dialog")||vT(n,".tox-confirm-dialog")},DJ=function(n,t,e){return t&&e?[]:[Wj.config({contextual:{lazyContext:function(){return R.some(rs(to.fromDom(n.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},BJ=function(n){var t=n.backstage,e=n.editor,o=EC(e),r=OJ(n),i=_J(n),u=function(n,e,o){return void 0!==e&&"toolbar"===e.inline?f(n,t.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?f(n,t.shared.anchors.cursor(),o,e.ariaAttrs):s(n,o)},a=function(n,t){return c(n,t)},c=function(n,o){var r=function(n){var r=CJ(n,{closeWindow:function(){xY.hide(r.dialog),o(r.instanceApi)}},e,t);return xY.show(r.dialog),r.instanceApi};return Zq.openUrl(r,n)},s=function(n,e){var o=function(n,o,r){var i=o,u={dataValidator:r,initialData:i,internalDialog:n},a=vJ(u,{redial:Zq.redial,closeWindow:function(){xY.hide(a.dialog),e(a.instanceApi)}},t);return xY.show(a.dialog),a.instanceApi.setData(i),a.instanceApi};return Zq.open(o,n)},f=function(n,r,i,u){var a=function(n,a,c){var s=TJ(a,c),f=CL(),l=t.shared.header.isPositionedAtTop(),d={dataValidator:c,initialData:s,internalDialog:n},m=function(){return f.on((function(n){Px.reposition(n),Wj.refresh(n)}))},g=hJ(d,{redial:Zq.redial,closeWindow:function(){f.on(Px.hide),e.off("ResizeEditor",m),f.clear(),i(g.instanceApi)}},t,u),p=yc(Px.sketch(T(T({lazySink:t.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},l?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:Lf(D([ky("window-manager-inline-events",[xi(ei(),(function(n,t){fi(g.dialog,fE)}))])],DJ(e,o,l))),isExtraPart:function(n,t){return EJ(t)}})));return f.set(p),Px.showWithin(p,r,xc(g.dialog),R.some(Ga())),o&&l||(Wj.refresh(p),e.on("ResizeEditor",m)),g.instanceApi.setData(s),ly.focusIn(g.dialog),g.instanceApi};return Zq.open(a,n)},l=function(n,t){i.open(n,(function(n){t(n)}))},d=function(n,t){r.open(n,(function(){t()}))},m=function(n){n.close()};return{open:u,openUrl:a,alert:d,close:m,confirm:l}};function AJ(){_.add("silver",(function(n){var t=uY(n),e=t.uiMothership,o=t.backstage,r=t.renderUI,i=t.getUi;lT.register(n,o.shared);var u=BJ({editor:n,backstage:o});return{renderUI:r,getWindowManagerImpl:y(u),getNotificationManagerImpl:function(){return uw(n,{backstage:o},e)},ui:i()}}))}AJ()})()}).call(this,e("c8ba"))},"0342":function(n,t,e){},"0d68":function(n,t,e){e("030f")},"3b2e":function(n,t,e){}}]);